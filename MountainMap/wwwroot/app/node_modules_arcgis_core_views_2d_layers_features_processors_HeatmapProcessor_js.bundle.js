"use strict";
(self["webpackChunkmm"] = self["webpackChunkmm"] || []).push([["node_modules_arcgis_core_views_2d_layers_features_processors_HeatmapProcessor_js"],{

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/Accessor.js */ "./node_modules/@arcgis/core/core/Accessor.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let s=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__["default"]{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.tileStore.tileScheme.spatialReference;return e&&e.toJSON()||null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({readOnly:!0})],s.prototype,"supportsTileUpdates",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"remoteClient",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"service",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],s.prototype,"spatialReference",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"tileInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"tileStore",void 0),s=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.views.2d.layers.features.processors.BaseProcessor")],s);const p=s;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../../core/accessorSupport/diffUtils.js */ "./node_modules/@arcgis/core/core/accessorSupport/diffUtils.js");
/* harmony import */ var _renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../../renderers/support/heatmapUtils.js */ "./node_modules/@arcgis/core/renderers/support/heatmapUtils.js");
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../engine/webgl/definitions.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js");
/* harmony import */ var _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./BaseProcessor.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js");
/* harmony import */ var _support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../support/tileUtils.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class n{constructor(e,t){this.offset=e,this.extent=t}}function d(e){const t=e.key,s=new Map,r=256,o=_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_9__.tileSize,d=e.tileInfoView.tileInfo.isWrappable;return s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,-1,-1,d).id,new n([-o,-o],[o-r,o-r,o,o])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,0,-1,d).id,new n([0,-o],[0,o-r,o,o])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,1,-1,d).id,new n([o,-o],[0,o-r,r,o])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,-1,0,d).id,new n([-o,0],[o-r,0,o,o])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,1,0,d).id,new n([o,0],[0,0,r,o])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,-1,1,d).id,new n([-o,o],[o-r,0,o,r])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,0,1,d).id,new n([0,o],[0,0,o,r])),s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_11__.getPow2NeighborKey)(t,1,1,d).id,new n([o,o],[0,0,r,r])),s}let l=class extends _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_10__["default"]{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.addHandles([this.tileStore.on("update",this.onTileUpdate.bind(this))])}async update(e,t){const r=t.schema.processors[0];if("heatmap"!==r.type)return;(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_7__.diff)(this._schema,r)&&(e.mesh=!0,this._schema=r)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(e){const t={clear:!0};return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t})}async onTileMessage(e,t,s){this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map);const i=this._tileKeyToFeatureSets.get(e.key.id);if(i&&null!=t.addOrUpdate&&t.addOrUpdate.hasFeatures&&i.set(t.addOrUpdate.instance,t),t.end){const t=[],i=d(e);this._tileKeyToFeatureSets.forEach(((s,r)=>{if(r===e.key.id)s.forEach((({addOrUpdate:e})=>{e&&t.push(e)}));else if(i.has(r)){const e=i.get(r),[o,a]=e.offset;s.forEach((({addOrUpdate:e})=>{if(e){const s=e.transform(o,a,1,1);t.push(s)}}))}}));const o=(0,_renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_8__.calculateHeatmapIntensityInfoReaders)(t,this._schema.mesh,512,512),a={tileKey:e.key.id,intensityInfo:o},n=[o.matrix];return this.remoteClient.invoke("tileRenderer.onTileData",a,{...s,transferList:n})}}onTileError(e,t,s){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t},s)}};l=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.views.2d.layers.features.processors.HeatmapProcessor")],l);const p=l;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getPow2NeighborKey: () => (/* binding */ o)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function o(o,l,c,r){const e=o.clone(),n=1<<e.level,t=e.col+l,w=e.row+c;return r&&t<0?(e.col=t+n,e.world-=1):t>=n?(e.col=t-n,e.world+=1):e.col=t,e.row=w,e}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX3ZpZXdzXzJkX2xheWVyc19mZWF0dXJlc19wcm9jZXNzb3JzX0hlYXRtYXBQcm9jZXNzb3JfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDeVosb0JBQW9CLHlEQUFDLENBQUMsY0FBYyxXQUFXLDBCQUEwQixTQUFTLHVCQUF1QixtREFBbUQsNkJBQTZCLHVEQUFDLEVBQUUsc0ZBQUMsRUFBRSxZQUFZLDJDQUEyQyx1REFBQyxFQUFFLHNGQUFDLEVBQUUsaUJBQWlCLHNDQUFzQyx1REFBQyxFQUFFLHNGQUFDLEVBQUUsaUJBQWlCLGlDQUFpQyx1REFBQyxFQUFFLHNGQUFDLHlDQUF5Qyx1REFBQyxFQUFFLHNGQUFDLEVBQUUsaUJBQWlCLGtDQUFrQyx1REFBQyxFQUFFLHNGQUFDLEVBQUUsaUJBQWlCLHFDQUFxQyx1REFBQyxFQUFFLHNGQUFDLCtEQUErRCxVQUErQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSnhnQztBQUNBO0FBQ0E7QUFDQTtBQUM4cUIsUUFBUSxpQkFBaUIsNkJBQTZCLGNBQWMsZ0NBQWdDLGtFQUFDLHVDQUF1QyxhQUFhLDBFQUFDLG1EQUFtRCwwRUFBQywrQ0FBK0MsMEVBQUMsK0NBQStDLDBFQUFDLCtDQUErQywwRUFBQywyQ0FBMkMsMEVBQUMsK0NBQStDLDBFQUFDLDJDQUEyQywwRUFBQyx1Q0FBdUMsb0JBQW9CLDBEQUFDLENBQUMsY0FBYywyRUFBMkUsYUFBYSw0RUFBNEUsa0JBQWtCLCtCQUErQiw2QkFBNkIsd0VBQUMsNkNBQTZDLGdCQUFnQixxRUFBcUUsZUFBZSxTQUFTLFVBQVUsdUdBQXVHLG9CQUFvQixFQUFFLDJCQUEyQiwyRkFBMkYsaURBQWlELDZGQUE2RixrQkFBa0IsNENBQTRDLDZCQUE2QixjQUFjLElBQUksYUFBYSxHQUFHLGtCQUFrQixnQ0FBZ0MsYUFBYSxjQUFjLElBQUksTUFBTSw2QkFBNkIsV0FBVyxJQUFJLEdBQUcsUUFBUSx3R0FBQyxpQ0FBaUMsaUNBQWlDLGNBQWMsNkRBQTZELG9CQUFvQixHQUFHLG1CQUFtQiw0REFBNEQscUJBQXFCLE1BQU0sRUFBRSx1REFBQyxFQUFFLHNGQUFDLGtFQUFrRSxVQUErQjs7Ozs7Ozs7Ozs7Ozs7O0FDSnhuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtREFBbUQsbUZBQW1IIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3ZpZXdzLzJkL2xheWVycy9mZWF0dXJlcy9wcm9jZXNzb3JzL0Jhc2VQcm9jZXNzb3IuanMiLCJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3ZpZXdzLzJkL2xheWVycy9mZWF0dXJlcy9wcm9jZXNzb3JzL0hlYXRtYXBQcm9jZXNzb3IuanMiLCJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL3ZpZXdzLzJkL2xheWVycy9mZWF0dXJlcy9zdXBwb3J0L3RpbGVVdGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4yOC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e18gYXMgZX1mcm9tXCIuLi8uLi8uLi8uLi8uLi9jaHVua3MvdHNsaWIuZXM2LmpzXCI7aW1wb3J0IHIgZnJvbVwiLi4vLi4vLi4vLi4vLi4vY29yZS9BY2Nlc3Nvci5qc1wiO2ltcG9ydHtwcm9wZXJ0eSBhcyB0fWZyb21cIi4uLy4uLy4uLy4uLy4uL2NvcmUvYWNjZXNzb3JTdXBwb3J0L2RlY29yYXRvcnMvcHJvcGVydHkuanNcIjtpbXBvcnRcIi4uLy4uLy4uLy4uLy4uL2NvcmUvYWNjZXNzb3JTdXBwb3J0L2Vuc3VyZVR5cGUuanNcIjtpbXBvcnRcIi4uLy4uLy4uLy4uLy4uL2NvcmUvYXJyYXlVdGlscy5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vLi4vLi4vY29yZS9oYXMuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgb31mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7bGV0IHM9Y2xhc3MgZXh0ZW5kcyBye2luaXRpYWxpemUoKXt9ZGVzdHJveSgpe31nZXQgc3VwcG9ydHNUaWxlVXBkYXRlcygpe3JldHVybiExfWdldCBzcGF0aWFsUmVmZXJlbmNlKCl7Y29uc3QgZT10aGlzLnRpbGVTdG9yZS50aWxlU2NoZW1lLnNwYXRpYWxSZWZlcmVuY2U7cmV0dXJuIGUmJmUudG9KU09OKCl8fG51bGx9fTtlKFt0KHtyZWFkT25seTohMH0pXSxzLnByb3RvdHlwZSxcInN1cHBvcnRzVGlsZVVwZGF0ZXNcIixudWxsKSxlKFt0KHtjb25zdHJ1Y3RPbmx5OiEwfSldLHMucHJvdG90eXBlLFwicmVtb3RlQ2xpZW50XCIsdm9pZCAwKSxlKFt0KHtjb25zdHJ1Y3RPbmx5OiEwfSldLHMucHJvdG90eXBlLFwic2VydmljZVwiLHZvaWQgMCksZShbdCgpXSxzLnByb3RvdHlwZSxcInNwYXRpYWxSZWZlcmVuY2VcIixudWxsKSxlKFt0KHtjb25zdHJ1Y3RPbmx5OiEwfSldLHMucHJvdG90eXBlLFwidGlsZUluZm9cIix2b2lkIDApLGUoW3Qoe2NvbnN0cnVjdE9ubHk6ITB9KV0scy5wcm90b3R5cGUsXCJ0aWxlU3RvcmVcIix2b2lkIDApLHM9ZShbbyhcImVzcmkudmlld3MuMmQubGF5ZXJzLmZlYXR1cmVzLnByb2Nlc3NvcnMuQmFzZVByb2Nlc3NvclwiKV0scyk7Y29uc3QgcD1zO2V4cG9ydHtwIGFzIGRlZmF1bHR9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtfIGFzIGV9ZnJvbVwiLi4vLi4vLi4vLi4vLi4vY2h1bmtzL3RzbGliLmVzNi5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vLi4vLi4vY29yZS9oYXMuanNcIjtpbXBvcnRcIi4uLy4uLy4uLy4uLy4uL2NvcmUvTG9nZ2VyLmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9lbnN1cmVUeXBlLmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnRcIi4uLy4uLy4uLy4uLy4uL2NvcmUvRXJyb3IuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgdH1mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7aW1wb3J0e2RpZmYgYXMgc31mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kaWZmVXRpbHMuanNcIjtpbXBvcnR7Y2FsY3VsYXRlSGVhdG1hcEludGVuc2l0eUluZm9SZWFkZXJzIGFzIHJ9ZnJvbVwiLi4vLi4vLi4vLi4vLi4vcmVuZGVyZXJzL3N1cHBvcnQvaGVhdG1hcFV0aWxzLmpzXCI7aW1wb3J0e3RpbGVTaXplIGFzIGl9ZnJvbVwiLi4vLi4vLi4vZW5naW5lL3dlYmdsL2RlZmluaXRpb25zLmpzXCI7aW1wb3J0IG8gZnJvbVwiLi9CYXNlUHJvY2Vzc29yLmpzXCI7aW1wb3J0e2dldFBvdzJOZWlnaGJvcktleSBhcyBhfWZyb21cIi4uL3N1cHBvcnQvdGlsZVV0aWxzLmpzXCI7Y2xhc3Mgbntjb25zdHJ1Y3RvcihlLHQpe3RoaXMub2Zmc2V0PWUsdGhpcy5leHRlbnQ9dH19ZnVuY3Rpb24gZChlKXtjb25zdCB0PWUua2V5LHM9bmV3IE1hcCxyPTI1NixvPWksZD1lLnRpbGVJbmZvVmlldy50aWxlSW5mby5pc1dyYXBwYWJsZTtyZXR1cm4gcy5zZXQoYSh0LC0xLC0xLGQpLmlkLG5ldyBuKFstbywtb10sW28tcixvLXIsbyxvXSkpLHMuc2V0KGEodCwwLC0xLGQpLmlkLG5ldyBuKFswLC1vXSxbMCxvLXIsbyxvXSkpLHMuc2V0KGEodCwxLC0xLGQpLmlkLG5ldyBuKFtvLC1vXSxbMCxvLXIscixvXSkpLHMuc2V0KGEodCwtMSwwLGQpLmlkLG5ldyBuKFstbywwXSxbby1yLDAsbyxvXSkpLHMuc2V0KGEodCwxLDAsZCkuaWQsbmV3IG4oW28sMF0sWzAsMCxyLG9dKSkscy5zZXQoYSh0LC0xLDEsZCkuaWQsbmV3IG4oWy1vLG9dLFtvLXIsMCxvLHJdKSkscy5zZXQoYSh0LDAsMSxkKS5pZCxuZXcgbihbMCxvXSxbMCwwLG8scl0pKSxzLnNldChhKHQsMSwxLGQpLmlkLG5ldyBuKFtvLG9dLFswLDAscixyXSkpLHN9bGV0IGw9Y2xhc3MgZXh0ZW5kcyBve2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLnR5cGU9XCJoZWF0bWFwXCIsdGhpcy5fdGlsZUtleVRvRmVhdHVyZVNldHM9bmV3IE1hcH1pbml0aWFsaXplKCl7dGhpcy5hZGRIYW5kbGVzKFt0aGlzLnRpbGVTdG9yZS5vbihcInVwZGF0ZVwiLHRoaXMub25UaWxlVXBkYXRlLmJpbmQodGhpcykpXSl9YXN5bmMgdXBkYXRlKGUsdCl7Y29uc3Qgcj10LnNjaGVtYS5wcm9jZXNzb3JzWzBdO2lmKFwiaGVhdG1hcFwiIT09ci50eXBlKXJldHVybjtzKHRoaXMuX3NjaGVtYSxyKSYmKGUubWVzaD0hMCx0aGlzLl9zY2hlbWE9cil9b25UaWxlVXBkYXRlKGUpe2Zvcihjb25zdCB0IG9mIGUucmVtb3ZlZCl0aGlzLl90aWxlS2V5VG9GZWF0dXJlU2V0cy5kZWxldGUodC5rZXkuaWQpfW9uVGlsZUNsZWFyKGUpe2NvbnN0IHQ9e2NsZWFyOiEwfTtyZXR1cm4gdGhpcy5fdGlsZUtleVRvRmVhdHVyZVNldHMuZGVsZXRlKGUua2V5LmlkKSx0aGlzLnJlbW90ZUNsaWVudC5pbnZva2UoXCJ0aWxlUmVuZGVyZXIub25UaWxlRGF0YVwiLHt0aWxlS2V5OmUuaWQsZGF0YTp0fSl9YXN5bmMgb25UaWxlTWVzc2FnZShlLHQscyl7dGhpcy5fdGlsZUtleVRvRmVhdHVyZVNldHMuaGFzKGUua2V5LmlkKXx8dGhpcy5fdGlsZUtleVRvRmVhdHVyZVNldHMuc2V0KGUua2V5LmlkLG5ldyBNYXApO2NvbnN0IGk9dGhpcy5fdGlsZUtleVRvRmVhdHVyZVNldHMuZ2V0KGUua2V5LmlkKTtpZihpJiZudWxsIT10LmFkZE9yVXBkYXRlJiZ0LmFkZE9yVXBkYXRlLmhhc0ZlYXR1cmVzJiZpLnNldCh0LmFkZE9yVXBkYXRlLmluc3RhbmNlLHQpLHQuZW5kKXtjb25zdCB0PVtdLGk9ZChlKTt0aGlzLl90aWxlS2V5VG9GZWF0dXJlU2V0cy5mb3JFYWNoKCgocyxyKT0+e2lmKHI9PT1lLmtleS5pZClzLmZvckVhY2goKCh7YWRkT3JVcGRhdGU6ZX0pPT57ZSYmdC5wdXNoKGUpfSkpO2Vsc2UgaWYoaS5oYXMocikpe2NvbnN0IGU9aS5nZXQociksW28sYV09ZS5vZmZzZXQ7cy5mb3JFYWNoKCgoe2FkZE9yVXBkYXRlOmV9KT0+e2lmKGUpe2NvbnN0IHM9ZS50cmFuc2Zvcm0obyxhLDEsMSk7dC5wdXNoKHMpfX0pKX19KSk7Y29uc3Qgbz1yKHQsdGhpcy5fc2NoZW1hLm1lc2gsNTEyLDUxMiksYT17dGlsZUtleTplLmtleS5pZCxpbnRlbnNpdHlJbmZvOm99LG49W28ubWF0cml4XTtyZXR1cm4gdGhpcy5yZW1vdGVDbGllbnQuaW52b2tlKFwidGlsZVJlbmRlcmVyLm9uVGlsZURhdGFcIixhLHsuLi5zLHRyYW5zZmVyTGlzdDpufSl9fW9uVGlsZUVycm9yKGUsdCxzKXtyZXR1cm4gdGhpcy5yZW1vdGVDbGllbnQuaW52b2tlKFwidGlsZVJlbmRlcmVyLm9uVGlsZUVycm9yXCIse3RpbGVLZXk6ZS5pZCxlcnJvcjp0fSxzKX19O2w9ZShbdChcImVzcmkudmlld3MuMmQubGF5ZXJzLmZlYXR1cmVzLnByb2Nlc3NvcnMuSGVhdG1hcFByb2Nlc3NvclwiKV0sbCk7Y29uc3QgcD1sO2V4cG9ydHtwIGFzIGRlZmF1bHR9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmZ1bmN0aW9uIG8obyxsLGMscil7Y29uc3QgZT1vLmNsb25lKCksbj0xPDxlLmxldmVsLHQ9ZS5jb2wrbCx3PWUucm93K2M7cmV0dXJuIHImJnQ8MD8oZS5jb2w9dCtuLGUud29ybGQtPTEpOnQ+PW4/KGUuY29sPXQtbixlLndvcmxkKz0xKTplLmNvbD10LGUucm93PXcsZX1leHBvcnR7byBhcyBnZXRQb3cyTmVpZ2hib3JLZXl9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9