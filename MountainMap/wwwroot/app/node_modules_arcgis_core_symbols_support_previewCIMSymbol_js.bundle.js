"use strict";
(self["webpackChunkmm"] = self["webpackChunkmm"] || []).push([["node_modules_arcgis_core_symbols_support_previewCIMSymbol_js"],{

/***/ "./node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   previewCIMSymbol: () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/screenUtils.js */ "./node_modules/@arcgis/core/core/screenUtils.js");
/* harmony import */ var _cim_CIMSymbolHelper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../cim/CIMSymbolHelper.js */ "./node_modules/@arcgis/core/symbols/cim/CIMSymbolHelper.js");
/* harmony import */ var _cim_CIMSymbolRasterizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../cim/CIMSymbolRasterizer.js */ "./node_modules/@arcgis/core/symbols/cim/CIMSymbolRasterizer.js");
/* harmony import */ var _cim_utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../cim/utils.js */ "./node_modules/@arcgis/core/symbols/cim/utils.js");
/* harmony import */ var _previewUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./previewUtils.js */ "./node_modules/@arcgis/core/symbols/support/previewUtils.js");
/* harmony import */ var _renderUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./renderUtils.js */ "./node_modules/@arcgis/core/symbols/support/renderUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const s=new _cim_CIMSymbolRasterizer_js__WEBPACK_IMPORTED_MODULE_2__.CIMSymbolRasterizer(null,!0),c=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__.px2pt)(_previewUtils_js__WEBPACK_IMPORTED_MODULE_4__.SymbolSizeDefaults.size),m=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__.px2pt)(_previewUtils_js__WEBPACK_IMPORTED_MODULE_4__.SymbolSizeDefaults.maxSize),u=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__.px2pt)(_previewUtils_js__WEBPACK_IMPORTED_MODULE_4__.SymbolSizeDefaults.lineWidth),f=1;async function h(e,t,i){const l=t?.size;let n=null!=l&&"object"==typeof l&&"width"in l?l.width:l,a=null!=l&&"object"==typeof l&&"height"in l?l.height:l;if(null==n||null==a)if("esriGeometryPolygon"===i)n=c,a=c;else{const l=await y(e,t,i);l&&(n=l.width,a=l.height),"esriGeometryPolyline"===i&&(n=u),n=null!=n&&isFinite(n)?Math.min(n,m):c,a=null!=a&&isFinite(a)?Math.max(Math.min(a,m),f):c}return"legend"===t.style&&"esriGeometryPolyline"===i&&(n=u),{width:n,height:a}}async function y(e,t,n){const{feature:a,fieldMap:r,viewParams:o}=t.cimOptions||t,c=await _cim_CIMSymbolHelper_js__WEBPACK_IMPORTED_MODULE_1__.OverrideHelper.resolveSymbolOverrides(e.data,a,null,r,n,null,o);if(!c)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:c},e.data.primitiveOverrides=void 0;const m=[];return _cim_CIMSymbolHelper_js__WEBPACK_IMPORTED_MODULE_1__.CIMSymbolHelper.fetchResources(c,s.resourceManager,m),_cim_CIMSymbolHelper_js__WEBPACK_IMPORTED_MODULE_1__.CIMSymbolHelper.fetchFonts(c,s.resourceManager,m),m.length>0&&await Promise.all(m),_cim_CIMSymbolHelper_js__WEBPACK_IMPORTED_MODULE_1__.CIMSymbolHelper.getEnvelope(c,null,s.resourceManager)}async function p(e,i={}){const{node:l,opacity:n,symbolConfig:r}=i,c=null!=r&&"object"==typeof r&&"isSquareFill"in r&&r.isSquareFill,m=i.cimOptions||i,u=m.geometryType||(0,_cim_utils_js__WEBPACK_IMPORTED_MODULE_3__.mapCIMSymbolToGeometryType)(e?.data?.symbol),f=await h(e,i,u),{feature:y,fieldMap:p}=m,d=c||"esriGeometryPolygon"!==u?"preview":"legend",g=await s.rasterizeCIMSymbolAsync(e,y,f,d,p,u,null,m.viewParams,m.allowScalingUp);if(!g)return null;const{width:w,height:b}=g,M=document.createElement("canvas");M.width=w,M.height=b;M.getContext("2d").putImageData(g,0,0);const v=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__.pt2px)(f.width),j=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_0__.pt2px)(f.height),S=new Image(v,j);S.src=M.toDataURL(),S.ariaLabel=i.ariaLabel??null,S.alt=i.ariaLabel??"",null!=n&&(S.style.opacity=`${n}`);let C=S;if(null!=i.effectView){const e={shape:{type:"image",x:0,y:0,width:v,height:j,src:S.src},fill:null,stroke:null,offset:[0,0]};C=(0,_renderUtils_js__WEBPACK_IMPORTED_MODULE_5__.renderSymbol)([[e]],[v,j],{effectView:i.effectView,ariaLabel:i.ariaLabel})}return l&&C&&l.appendChild(C),C}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX3N5bWJvbHNfc3VwcG9ydF9wcmV2aWV3Q0lNU3ltYm9sX2pzLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDcVgsWUFBWSw0RUFBQyxZQUFZLDJEQUFDLENBQUMsZ0VBQUMsU0FBUywyREFBQyxDQUFDLGdFQUFDLFlBQVksMkRBQUMsQ0FBQyxnRUFBQyxnQkFBZ0Isd0JBQXdCLGdCQUFnQixnSEFBZ0gseURBQXlELEtBQUssdUJBQXVCLHNKQUFzSiw2REFBNkQsa0JBQWtCLHdCQUF3QixNQUFNLGtDQUFrQyx5QkFBeUIsbUVBQUMsa0RBQWtELGtCQUFrQixvQkFBb0IsbUNBQW1DLGtDQUFrQyxXQUFXLE9BQU8sb0VBQUMsdUNBQXVDLG9FQUFDLG9FQUFvRSxvRUFBQyx1Q0FBdUMsdUJBQXVCLEVBQUUsTUFBTSxnQ0FBZ0MseUdBQXlHLHlFQUFDLG9DQUFvQyxxQkFBcUIsdUlBQXVJLGtCQUFrQixNQUFNLGlCQUFpQixzQ0FBc0MscUJBQXFCLHVDQUF1QyxRQUFRLDJEQUFDLFlBQVksMkRBQUMsNEJBQTRCLHFHQUFxRyxFQUFFLEdBQUcsUUFBUSx1QkFBdUIsU0FBUyxPQUFPLGdEQUFnRCxxQ0FBcUMsRUFBRSw2REFBQyxjQUFjLDhDQUE4QyxFQUFFLGdDQUE4RCIsInNvdXJjZXMiOlsid2VicGFjazovL21tLy4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS9zeW1ib2xzL3N1cHBvcnQvcHJldmlld0NJTVN5bWJvbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cblNlZSBodHRwczovL2pzLmFyY2dpcy5jb20vNC4yOC9lc3JpL2NvcHlyaWdodC50eHQgZm9yIGRldGFpbHMuXG4qL1xuaW1wb3J0e3B4MnB0IGFzIGUscHQycHggYXMgdH1mcm9tXCIuLi8uLi9jb3JlL3NjcmVlblV0aWxzLmpzXCI7aW1wb3J0e092ZXJyaWRlSGVscGVyIGFzIGksQ0lNU3ltYm9sSGVscGVyIGFzIGx9ZnJvbVwiLi4vY2ltL0NJTVN5bWJvbEhlbHBlci5qc1wiO2ltcG9ydHtDSU1TeW1ib2xSYXN0ZXJpemVyIGFzIG59ZnJvbVwiLi4vY2ltL0NJTVN5bWJvbFJhc3Rlcml6ZXIuanNcIjtpbXBvcnR7bWFwQ0lNU3ltYm9sVG9HZW9tZXRyeVR5cGUgYXMgYX1mcm9tXCIuLi9jaW0vdXRpbHMuanNcIjtpbXBvcnR7U3ltYm9sU2l6ZURlZmF1bHRzIGFzIHJ9ZnJvbVwiLi9wcmV2aWV3VXRpbHMuanNcIjtpbXBvcnR7cmVuZGVyU3ltYm9sIGFzIG99ZnJvbVwiLi9yZW5kZXJVdGlscy5qc1wiO2NvbnN0IHM9bmV3IG4obnVsbCwhMCksYz1lKHIuc2l6ZSksbT1lKHIubWF4U2l6ZSksdT1lKHIubGluZVdpZHRoKSxmPTE7YXN5bmMgZnVuY3Rpb24gaChlLHQsaSl7Y29uc3QgbD10Py5zaXplO2xldCBuPW51bGwhPWwmJlwib2JqZWN0XCI9PXR5cGVvZiBsJiZcIndpZHRoXCJpbiBsP2wud2lkdGg6bCxhPW51bGwhPWwmJlwib2JqZWN0XCI9PXR5cGVvZiBsJiZcImhlaWdodFwiaW4gbD9sLmhlaWdodDpsO2lmKG51bGw9PW58fG51bGw9PWEpaWYoXCJlc3JpR2VvbWV0cnlQb2x5Z29uXCI9PT1pKW49YyxhPWM7ZWxzZXtjb25zdCBsPWF3YWl0IHkoZSx0LGkpO2wmJihuPWwud2lkdGgsYT1sLmhlaWdodCksXCJlc3JpR2VvbWV0cnlQb2x5bGluZVwiPT09aSYmKG49dSksbj1udWxsIT1uJiZpc0Zpbml0ZShuKT9NYXRoLm1pbihuLG0pOmMsYT1udWxsIT1hJiZpc0Zpbml0ZShhKT9NYXRoLm1heChNYXRoLm1pbihhLG0pLGYpOmN9cmV0dXJuXCJsZWdlbmRcIj09PXQuc3R5bGUmJlwiZXNyaUdlb21ldHJ5UG9seWxpbmVcIj09PWkmJihuPXUpLHt3aWR0aDpuLGhlaWdodDphfX1hc3luYyBmdW5jdGlvbiB5KGUsdCxuKXtjb25zdHtmZWF0dXJlOmEsZmllbGRNYXA6cix2aWV3UGFyYW1zOm99PXQuY2ltT3B0aW9uc3x8dCxjPWF3YWl0IGkucmVzb2x2ZVN5bWJvbE92ZXJyaWRlcyhlLmRhdGEsYSxudWxsLHIsbixudWxsLG8pO2lmKCFjKXJldHVybiBudWxsOyhlPWUuY2xvbmUoKSkuZGF0YT17dHlwZTpcIkNJTVN5bWJvbFJlZmVyZW5jZVwiLHN5bWJvbDpjfSxlLmRhdGEucHJpbWl0aXZlT3ZlcnJpZGVzPXZvaWQgMDtjb25zdCBtPVtdO3JldHVybiBsLmZldGNoUmVzb3VyY2VzKGMscy5yZXNvdXJjZU1hbmFnZXIsbSksbC5mZXRjaEZvbnRzKGMscy5yZXNvdXJjZU1hbmFnZXIsbSksbS5sZW5ndGg+MCYmYXdhaXQgUHJvbWlzZS5hbGwobSksbC5nZXRFbnZlbG9wZShjLG51bGwscy5yZXNvdXJjZU1hbmFnZXIpfWFzeW5jIGZ1bmN0aW9uIHAoZSxpPXt9KXtjb25zdHtub2RlOmwsb3BhY2l0eTpuLHN5bWJvbENvbmZpZzpyfT1pLGM9bnVsbCE9ciYmXCJvYmplY3RcIj09dHlwZW9mIHImJlwiaXNTcXVhcmVGaWxsXCJpbiByJiZyLmlzU3F1YXJlRmlsbCxtPWkuY2ltT3B0aW9uc3x8aSx1PW0uZ2VvbWV0cnlUeXBlfHxhKGU/LmRhdGE/LnN5bWJvbCksZj1hd2FpdCBoKGUsaSx1KSx7ZmVhdHVyZTp5LGZpZWxkTWFwOnB9PW0sZD1jfHxcImVzcmlHZW9tZXRyeVBvbHlnb25cIiE9PXU/XCJwcmV2aWV3XCI6XCJsZWdlbmRcIixnPWF3YWl0IHMucmFzdGVyaXplQ0lNU3ltYm9sQXN5bmMoZSx5LGYsZCxwLHUsbnVsbCxtLnZpZXdQYXJhbXMsbS5hbGxvd1NjYWxpbmdVcCk7aWYoIWcpcmV0dXJuIG51bGw7Y29uc3R7d2lkdGg6dyxoZWlnaHQ6Yn09ZyxNPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7TS53aWR0aD13LE0uaGVpZ2h0PWI7TS5nZXRDb250ZXh0KFwiMmRcIikucHV0SW1hZ2VEYXRhKGcsMCwwKTtjb25zdCB2PXQoZi53aWR0aCksaj10KGYuaGVpZ2h0KSxTPW5ldyBJbWFnZSh2LGopO1Muc3JjPU0udG9EYXRhVVJMKCksUy5hcmlhTGFiZWw9aS5hcmlhTGFiZWw/P251bGwsUy5hbHQ9aS5hcmlhTGFiZWw/P1wiXCIsbnVsbCE9biYmKFMuc3R5bGUub3BhY2l0eT1gJHtufWApO2xldCBDPVM7aWYobnVsbCE9aS5lZmZlY3RWaWV3KXtjb25zdCBlPXtzaGFwZTp7dHlwZTpcImltYWdlXCIseDowLHk6MCx3aWR0aDp2LGhlaWdodDpqLHNyYzpTLnNyY30sZmlsbDpudWxsLHN0cm9rZTpudWxsLG9mZnNldDpbMCwwXX07Qz1vKFtbZV1dLFt2LGpdLHtlZmZlY3RWaWV3OmkuZWZmZWN0VmlldyxhcmlhTGFiZWw6aS5hcmlhTGFiZWx9KX1yZXR1cm4gbCYmQyYmbC5hcHBlbmRDaGlsZChDKSxDfWV4cG9ydHtwIGFzIHByZXZpZXdDSU1TeW1ib2x9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9