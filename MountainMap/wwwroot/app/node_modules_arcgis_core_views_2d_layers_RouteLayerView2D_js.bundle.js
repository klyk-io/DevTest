"use strict";
(self["webpackChunkmm"] = self["webpackChunkmm"] || []).push([["node_modules_arcgis_core_views_2d_layers_RouteLayerView2D_js"],{

/***/ "./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ I)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Collection.js */ "./node_modules/@arcgis/core/core/Collection.js");
/* harmony import */ var _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/CollectionFlattener.js */ "./node_modules/@arcgis/core/core/CollectionFlattener.js");
/* harmony import */ var _core_handleUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/handleUtils.js */ "./node_modules/@arcgis/core/core/handleUtils.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../rest/support/DirectionLine.js */ "./node_modules/@arcgis/core/rest/support/DirectionLine.js");
/* harmony import */ var _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../rest/support/DirectionPoint.js */ "./node_modules/@arcgis/core/rest/support/DirectionPoint.js");
/* harmony import */ var _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../rest/support/PointBarrier.js */ "./node_modules/@arcgis/core/rest/support/PointBarrier.js");
/* harmony import */ var _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../rest/support/PolygonBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolygonBarrier.js");
/* harmony import */ var _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../rest/support/PolylineBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolylineBarrier.js");
/* harmony import */ var _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../rest/support/RouteInfo.js */ "./node_modules/@arcgis/core/rest/support/RouteInfo.js");
/* harmony import */ var _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../rest/support/Stop.js */ "./node_modules/@arcgis/core/rest/support/Stop.js");
/* harmony import */ var _LayerView2D_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./LayerView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js");
/* harmony import */ var _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./graphics/GraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js");
/* harmony import */ var _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./graphics/GraphicsView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicsView2D.js");
/* harmony import */ var _layers_LayerView_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../layers/LayerView.js */ "./node_modules/@arcgis/core/views/layers/LayerView.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const k=["route-info","direction-line","direction-point","polygon-barrier","polyline-barrier","point-barrier","stop"],M={graphic:null,property:null,oldValue:null,newValue:null};function V(t){return t instanceof _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_10__["default"]||t instanceof _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_11__["default"]||t instanceof _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_12__["default"]||t instanceof _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_13__["default"]||t instanceof _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_14__["default"]||t instanceof _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_15__["default"]||t instanceof _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_16__["default"]}function j(t){return _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"].isCollection(t)&&t.length&&V(t.at(0))}function v(t){return Array.isArray(t)&&t.length>0&&V(t[0])}let G=class extends((0,_LayerView2D_js__WEBPACK_IMPORTED_MODULE_17__.LayerView2DMixin)(_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_20__["default"])){constructor(){super(...arguments),this._graphics=new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"],this._highlightIds=new Map,this._networkFeatureMap=new Map,this._networkGraphicMap=new Map}get _routeItems(){return new _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__["default"]({getCollections:()=>null==this.layer||this.destroyed?[]:[null!=this.layer.routeInfo?new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"]([this.layer.routeInfo]):null,this.layer.directionLines,this.layer.directionPoints,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.pointBarriers,this.layer.stops]})}initialize(){this._updatingHandles.addOnCollectionChange((()=>this._routeItems),(t=>this._routeItemsChanged(t)),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_5__.initial)}destroy(){this._networkFeatureMap.clear(),this._networkGraphicMap.clear(),this._graphics.removeAll(),this._get("_routeItems")?.destroy()}attach(){this._createGraphicsView()}detach(){this._destroyGraphicsView()}async fetchPopupFeatures(t){return this._graphicsView.hitTest(t).filter((t=>!!t.popupTemplate))}highlight(t){let r;r=V(t)?[this._getNetworkFeatureUid(t)]:v(t)?t.map((t=>this._getNetworkFeatureUid(t))):j(t)?t.map((t=>this._getNetworkFeatureUid(t))).toArray():[t.uid];const i=r.filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome);return i.length?(this._addHighlight(i),(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_4__.makeHandle)((()=>this._removeHighlight(i)))):(0,_core_handleUtils_js__WEBPACK_IMPORTED_MODULE_4__.makeHandle)()}async hitTest(t,r){if(this.suspended)return null;const i=this._graphicsView.hitTest(t).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome).map((t=>this._networkGraphicMap.get(t)));if(!i.length)return null;const{layer:s}=this;return i.reverse().map((e=>({type:"route",layer:s,mapPoint:t,networkFeature:e})))}isUpdating(){return this._graphicsView.updating}moveStart(){}moveEnd(){}update(t){this._graphicsView.processUpdate(t)}viewChange(){this._graphicsView.viewChange()}_addHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e);this._highlightIds.set(e,t+1)}else this._highlightIds.set(e,1);this._updateHighlight()}_createGraphic(t){const e=t.toGraphic();return e.layer=this.layer,e.sourceLayer=this.layer,e}_createGraphicsView(){const t=this.view,e=()=>this.requestUpdate(),r=new _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_18__["default"](t.featuresTilingScheme);this._graphicsView=new _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_19__["default"]({container:r,graphics:this._graphics,requestUpdateCallback:e,view:t}),this.container.addChild(r),this._updateHighlight()}_destroyGraphicsView(){this.container.removeChild(this._graphicsView.container),this._graphicsView.destroy()}_getDrawOrder(t){const e=this._networkGraphicMap.get(t);return k.indexOf(e.type)}_getNetworkFeatureUid(t){return this._networkFeatureMap.has(t)?this._networkFeatureMap.get(t).uid:null}_removeHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e)-1;0===t?this._highlightIds.delete(e):this._highlightIds.set(e,t)}this._updateHighlight()}_routeItemsChanged(t){if(t.removed.length){this._graphics.removeMany(t.removed.map((t=>{const e=this._networkFeatureMap.get(t);return this._networkFeatureMap.delete(t),this._networkGraphicMap.delete(e),e})));for(const e of t.removed)this.removeHandles(e)}if(t.added.length){this._graphics.addMany(t.added.map((t=>{const e=this._createGraphic(t);return null==e.symbol?null:(this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),e)})).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome));for(const e of t.added)this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_5__.watch)((()=>e.geometry),((t,r)=>{this._updateGraphic(e,"geometry",t,r)})),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_5__.watch)((()=>e.symbol),((t,r)=>{this._updateGraphic(e,"symbol",t,r)}))],e);this._graphics.sort(((t,e)=>this._getDrawOrder(t)-this._getDrawOrder(e)))}}_updateGraphic(t,e,r,i){if(!this._networkFeatureMap.has(t)){const e=this._createGraphic(t);return this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),void this._graphics.add(e)}const s=this._networkFeatureMap.get(t);s[e]=r,M.graphic=s,M.property=e,M.oldValue=i,M.newValue=r,this._graphicsView.graphicUpdateHandler(M)}_updateHighlight(){const t=Array.from(this._highlightIds.keys());this._graphicsView.setHighlight(t)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],G.prototype,"_graphics",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_6__.property)()],G.prototype,"_routeItems",null),G=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__.subclass)("esri.views.2d.layers.RouteLayerView2D")],G);const I=G;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../engine/webgl/enums.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/enums.js");
/* harmony import */ var _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseGraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/BaseGraphicContainer.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class i extends _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__["default"]{renderChildren(r){this.attributeView.update(),this.children.some((e=>e.hasData))&&(this.attributeView.bindTextures(r.context,!1),super.renderChildren(r),r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.MAP&&this._renderChildren(r),this.hasHighlight&&r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(r),this._boundsRenderer&&this._boundsRenderer.doRender(r))}_renderHighlight(e){const{painter:r}=e,i=r.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX3ZpZXdzXzJkX2xheWVyc19Sb3V0ZUxheWVyVmlldzJEX2pzLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDMmxDLHlIQUF5SCx3REFBd0QsY0FBYyxvQkFBb0IsdUVBQUMsZUFBZSx3RUFBQyxlQUFlLHNFQUFDLGVBQWUsd0VBQUMsZUFBZSx5RUFBQyxlQUFlLG1FQUFDLGVBQWUsOERBQUMsQ0FBQyxjQUFjLE9BQU8sMkRBQUMsdUNBQXVDLGNBQWMsNkNBQTZDLG9CQUFvQixrRUFBQyxDQUFDLDZEQUFDLEdBQUcsY0FBYyx1Q0FBdUMsMkRBQUMsNEZBQTRGLGtCQUFrQixXQUFXLG9FQUFDLEVBQUUsdUZBQXVGLDJEQUFDLHFMQUFxTCxFQUFFLGFBQWEsbUdBQW1HLDJEQUFDLEVBQUUsVUFBVSwrSEFBK0gsU0FBUywyQkFBMkIsU0FBUyw0QkFBNEIsNEJBQTRCLG9FQUFvRSxhQUFhLE1BQU0sdUpBQXVKLGlCQUFpQix1REFBQyxFQUFFLHVDQUF1QyxnRUFBQyxrQ0FBa0MsZ0VBQUMsR0FBRyxtQkFBbUIsOEJBQThCLDZDQUE2Qyx1REFBQywyQ0FBMkMseUJBQXlCLE1BQU0sUUFBUSxNQUFNLDZCQUE2QixpREFBaUQsSUFBSSxhQUFhLG1DQUFtQyxhQUFhLFdBQVcsVUFBVSxvQ0FBb0MsYUFBYSxnQ0FBZ0MsaUJBQWlCLCtDQUErQyxrQ0FBa0MsOEJBQThCLGlDQUFpQyx3QkFBd0Isa0JBQWtCLHNCQUFzQixxREFBcUQsc0JBQXNCLG1EQUFtRCxzRUFBQyx5QkFBeUIsdUJBQXVCLG9FQUFDLEVBQUUsbUVBQW1FLHFEQUFxRCx1QkFBdUIsc0ZBQXNGLGlCQUFpQix1Q0FBdUMseUJBQXlCLHlCQUF5Qiw4RUFBOEUsb0JBQW9CLCtDQUErQyxvQ0FBb0MsK0RBQStELHdCQUF3QixzQkFBc0IscUJBQXFCLDZDQUE2Qyx1Q0FBdUMsNkVBQTZFLElBQUksK0NBQStDLG1CQUFtQix3Q0FBd0MsK0JBQStCLGlHQUFpRyxVQUFVLHVEQUFDLEdBQUcsd0NBQXdDLDZEQUFDLDJCQUEyQixzQ0FBc0MsR0FBRyw2REFBQyx5QkFBeUIsb0NBQW9DLE9BQU8sMkVBQTJFLHdCQUF3QixvQ0FBb0MsK0JBQStCLG9HQUFvRyx1Q0FBdUMscUdBQXFHLG1CQUFtQiw4Q0FBOEMscUNBQXFDLHVEQUFDLEVBQUUsc0ZBQUMsb0NBQW9DLHVEQUFDLEVBQUUsc0ZBQUMsc0NBQXNDLHVEQUFDLEVBQUUsc0ZBQUMsOENBQThDLFVBQStCOzs7Ozs7Ozs7Ozs7Ozs7OztBQ0p2MEs7QUFDQTtBQUNBO0FBQ0E7QUFDb0csZ0JBQWdCLGdFQUFDLENBQUMsa0JBQWtCLHFKQUFxSixnRUFBQywrREFBK0QsZ0VBQUMsNkZBQTZGLG9CQUFvQixNQUFNLFVBQVUseUJBQXlCLGtFQUF1RiIsInNvdXJjZXMiOlsid2VicGFjazovL21tLy4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS92aWV3cy8yZC9sYXllcnMvUm91dGVMYXllclZpZXcyRC5qcyIsIndlYnBhY2s6Ly9tbS8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvMmQvbGF5ZXJzL2dyYXBoaWNzL0dyYXBoaWNDb250YWluZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtfIGFzIHR9ZnJvbVwiLi4vLi4vLi4vY2h1bmtzL3RzbGliLmVzNi5qc1wiO2ltcG9ydHtpc1NvbWUgYXMgZX1mcm9tXCIuLi8uLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnQgciBmcm9tXCIuLi8uLi8uLi9jb3JlL0NvbGxlY3Rpb24uanNcIjtpbXBvcnQgaSBmcm9tXCIuLi8uLi8uLi9jb3JlL0NvbGxlY3Rpb25GbGF0dGVuZXIuanNcIjtpbXBvcnR7bWFrZUhhbmRsZSBhcyBzfWZyb21cIi4uLy4uLy4uL2NvcmUvaGFuZGxlVXRpbHMuanNcIjtpbXBvcnR7aW5pdGlhbCBhcyBvLHdhdGNoIGFzIGF9ZnJvbVwiLi4vLi4vLi4vY29yZS9yZWFjdGl2ZVV0aWxzLmpzXCI7aW1wb3J0e3Byb3BlcnR5IGFzIGh9ZnJvbVwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9wcm9wZXJ0eS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZW5zdXJlVHlwZS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9oYXMuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgbn1mcm9tXCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7aW1wb3J0IHAgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L0RpcmVjdGlvbkxpbmUuanNcIjtpbXBvcnQgbCBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvRGlyZWN0aW9uUG9pbnQuanNcIjtpbXBvcnQgYyBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvUG9pbnRCYXJyaWVyLmpzXCI7aW1wb3J0IGcgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L1BvbHlnb25CYXJyaWVyLmpzXCI7aW1wb3J0IHUgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L1BvbHlsaW5lQmFycmllci5qc1wiO2ltcG9ydCBkIGZyb21cIi4uLy4uLy4uL3Jlc3Qvc3VwcG9ydC9Sb3V0ZUluZm8uanNcIjtpbXBvcnQgXyBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvU3RvcC5qc1wiO2ltcG9ydHtMYXllclZpZXcyRE1peGluIGFzIG19ZnJvbVwiLi9MYXllclZpZXcyRC5qc1wiO2ltcG9ydCB3IGZyb21cIi4vZ3JhcGhpY3MvR3JhcGhpY0NvbnRhaW5lci5qc1wiO2ltcG9ydCBmIGZyb21cIi4vZ3JhcGhpY3MvR3JhcGhpY3NWaWV3MkQuanNcIjtpbXBvcnQgeSBmcm9tXCIuLi8uLi9sYXllcnMvTGF5ZXJWaWV3LmpzXCI7Y29uc3Qgaz1bXCJyb3V0ZS1pbmZvXCIsXCJkaXJlY3Rpb24tbGluZVwiLFwiZGlyZWN0aW9uLXBvaW50XCIsXCJwb2x5Z29uLWJhcnJpZXJcIixcInBvbHlsaW5lLWJhcnJpZXJcIixcInBvaW50LWJhcnJpZXJcIixcInN0b3BcIl0sTT17Z3JhcGhpYzpudWxsLHByb3BlcnR5Om51bGwsb2xkVmFsdWU6bnVsbCxuZXdWYWx1ZTpudWxsfTtmdW5jdGlvbiBWKHQpe3JldHVybiB0IGluc3RhbmNlb2YgcHx8dCBpbnN0YW5jZW9mIGx8fHQgaW5zdGFuY2VvZiBjfHx0IGluc3RhbmNlb2YgZ3x8dCBpbnN0YW5jZW9mIHV8fHQgaW5zdGFuY2VvZiBkfHx0IGluc3RhbmNlb2YgX31mdW5jdGlvbiBqKHQpe3JldHVybiByLmlzQ29sbGVjdGlvbih0KSYmdC5sZW5ndGgmJlYodC5hdCgwKSl9ZnVuY3Rpb24gdih0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KSYmdC5sZW5ndGg+MCYmVih0WzBdKX1sZXQgRz1jbGFzcyBleHRlbmRzKG0oeSkpe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLl9ncmFwaGljcz1uZXcgcix0aGlzLl9oaWdobGlnaHRJZHM9bmV3IE1hcCx0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcD1uZXcgTWFwLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwPW5ldyBNYXB9Z2V0IF9yb3V0ZUl0ZW1zKCl7cmV0dXJuIG5ldyBpKHtnZXRDb2xsZWN0aW9uczooKT0+bnVsbD09dGhpcy5sYXllcnx8dGhpcy5kZXN0cm95ZWQ/W106W251bGwhPXRoaXMubGF5ZXIucm91dGVJbmZvP25ldyByKFt0aGlzLmxheWVyLnJvdXRlSW5mb10pOm51bGwsdGhpcy5sYXllci5kaXJlY3Rpb25MaW5lcyx0aGlzLmxheWVyLmRpcmVjdGlvblBvaW50cyx0aGlzLmxheWVyLnBvbHlnb25CYXJyaWVycyx0aGlzLmxheWVyLnBvbHlsaW5lQmFycmllcnMsdGhpcy5sYXllci5wb2ludEJhcnJpZXJzLHRoaXMubGF5ZXIuc3RvcHNdfSl9aW5pdGlhbGl6ZSgpe3RoaXMuX3VwZGF0aW5nSGFuZGxlcy5hZGRPbkNvbGxlY3Rpb25DaGFuZ2UoKCgpPT50aGlzLl9yb3V0ZUl0ZW1zKSwodD0+dGhpcy5fcm91dGVJdGVtc0NoYW5nZWQodCkpLG8pfWRlc3Ryb3koKXt0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5jbGVhcigpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLmNsZWFyKCksdGhpcy5fZ3JhcGhpY3MucmVtb3ZlQWxsKCksdGhpcy5fZ2V0KFwiX3JvdXRlSXRlbXNcIik/LmRlc3Ryb3koKX1hdHRhY2goKXt0aGlzLl9jcmVhdGVHcmFwaGljc1ZpZXcoKX1kZXRhY2goKXt0aGlzLl9kZXN0cm95R3JhcGhpY3NWaWV3KCl9YXN5bmMgZmV0Y2hQb3B1cEZlYXR1cmVzKHQpe3JldHVybiB0aGlzLl9ncmFwaGljc1ZpZXcuaGl0VGVzdCh0KS5maWx0ZXIoKHQ9PiEhdC5wb3B1cFRlbXBsYXRlKSl9aGlnaGxpZ2h0KHQpe2xldCByO3I9Vih0KT9bdGhpcy5fZ2V0TmV0d29ya0ZlYXR1cmVVaWQodCldOnYodCk/dC5tYXAoKHQ9PnRoaXMuX2dldE5ldHdvcmtGZWF0dXJlVWlkKHQpKSk6aih0KT90Lm1hcCgodD0+dGhpcy5fZ2V0TmV0d29ya0ZlYXR1cmVVaWQodCkpKS50b0FycmF5KCk6W3QudWlkXTtjb25zdCBpPXIuZmlsdGVyKGUpO3JldHVybiBpLmxlbmd0aD8odGhpcy5fYWRkSGlnaGxpZ2h0KGkpLHMoKCgpPT50aGlzLl9yZW1vdmVIaWdobGlnaHQoaSkpKSk6cygpfWFzeW5jIGhpdFRlc3QodCxyKXtpZih0aGlzLnN1c3BlbmRlZClyZXR1cm4gbnVsbDtjb25zdCBpPXRoaXMuX2dyYXBoaWNzVmlldy5oaXRUZXN0KHQpLmZpbHRlcihlKS5tYXAoKHQ9PnRoaXMuX25ldHdvcmtHcmFwaGljTWFwLmdldCh0KSkpO2lmKCFpLmxlbmd0aClyZXR1cm4gbnVsbDtjb25zdHtsYXllcjpzfT10aGlzO3JldHVybiBpLnJldmVyc2UoKS5tYXAoKGU9Pih7dHlwZTpcInJvdXRlXCIsbGF5ZXI6cyxtYXBQb2ludDp0LG5ldHdvcmtGZWF0dXJlOmV9KSkpfWlzVXBkYXRpbmcoKXtyZXR1cm4gdGhpcy5fZ3JhcGhpY3NWaWV3LnVwZGF0aW5nfW1vdmVTdGFydCgpe31tb3ZlRW5kKCl7fXVwZGF0ZSh0KXt0aGlzLl9ncmFwaGljc1ZpZXcucHJvY2Vzc1VwZGF0ZSh0KX12aWV3Q2hhbmdlKCl7dGhpcy5fZ3JhcGhpY3NWaWV3LnZpZXdDaGFuZ2UoKX1fYWRkSGlnaGxpZ2h0KHQpe2Zvcihjb25zdCBlIG9mIHQpaWYodGhpcy5faGlnaGxpZ2h0SWRzLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9oaWdobGlnaHRJZHMuZ2V0KGUpO3RoaXMuX2hpZ2hsaWdodElkcy5zZXQoZSx0KzEpfWVsc2UgdGhpcy5faGlnaGxpZ2h0SWRzLnNldChlLDEpO3RoaXMuX3VwZGF0ZUhpZ2hsaWdodCgpfV9jcmVhdGVHcmFwaGljKHQpe2NvbnN0IGU9dC50b0dyYXBoaWMoKTtyZXR1cm4gZS5sYXllcj10aGlzLmxheWVyLGUuc291cmNlTGF5ZXI9dGhpcy5sYXllcixlfV9jcmVhdGVHcmFwaGljc1ZpZXcoKXtjb25zdCB0PXRoaXMudmlldyxlPSgpPT50aGlzLnJlcXVlc3RVcGRhdGUoKSxyPW5ldyB3KHQuZmVhdHVyZXNUaWxpbmdTY2hlbWUpO3RoaXMuX2dyYXBoaWNzVmlldz1uZXcgZih7Y29udGFpbmVyOnIsZ3JhcGhpY3M6dGhpcy5fZ3JhcGhpY3MscmVxdWVzdFVwZGF0ZUNhbGxiYWNrOmUsdmlldzp0fSksdGhpcy5jb250YWluZXIuYWRkQ2hpbGQociksdGhpcy5fdXBkYXRlSGlnaGxpZ2h0KCl9X2Rlc3Ryb3lHcmFwaGljc1ZpZXcoKXt0aGlzLmNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLl9ncmFwaGljc1ZpZXcuY29udGFpbmVyKSx0aGlzLl9ncmFwaGljc1ZpZXcuZGVzdHJveSgpfV9nZXREcmF3T3JkZXIodCl7Y29uc3QgZT10aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5nZXQodCk7cmV0dXJuIGsuaW5kZXhPZihlLnR5cGUpfV9nZXROZXR3b3JrRmVhdHVyZVVpZCh0KXtyZXR1cm4gdGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuaGFzKHQpP3RoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmdldCh0KS51aWQ6bnVsbH1fcmVtb3ZlSGlnaGxpZ2h0KHQpe2Zvcihjb25zdCBlIG9mIHQpaWYodGhpcy5faGlnaGxpZ2h0SWRzLmhhcyhlKSl7Y29uc3QgdD10aGlzLl9oaWdobGlnaHRJZHMuZ2V0KGUpLTE7MD09PXQ/dGhpcy5faGlnaGxpZ2h0SWRzLmRlbGV0ZShlKTp0aGlzLl9oaWdobGlnaHRJZHMuc2V0KGUsdCl9dGhpcy5fdXBkYXRlSGlnaGxpZ2h0KCl9X3JvdXRlSXRlbXNDaGFuZ2VkKHQpe2lmKHQucmVtb3ZlZC5sZW5ndGgpe3RoaXMuX2dyYXBoaWNzLnJlbW92ZU1hbnkodC5yZW1vdmVkLm1hcCgodD0+e2NvbnN0IGU9dGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuZ2V0KHQpO3JldHVybiB0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5kZWxldGUodCksdGhpcy5fbmV0d29ya0dyYXBoaWNNYXAuZGVsZXRlKGUpLGV9KSkpO2Zvcihjb25zdCBlIG9mIHQucmVtb3ZlZCl0aGlzLnJlbW92ZUhhbmRsZXMoZSl9aWYodC5hZGRlZC5sZW5ndGgpe3RoaXMuX2dyYXBoaWNzLmFkZE1hbnkodC5hZGRlZC5tYXAoKHQ9Pntjb25zdCBlPXRoaXMuX2NyZWF0ZUdyYXBoaWModCk7cmV0dXJuIG51bGw9PWUuc3ltYm9sP251bGw6KHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLnNldCh0LGUpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLnNldChlLHQpLGUpfSkpLmZpbHRlcihlKSk7Zm9yKGNvbnN0IGUgb2YgdC5hZGRlZCl0aGlzLmFkZEhhbmRsZXMoW2EoKCgpPT5lLmdlb21ldHJ5KSwoKHQscik9Pnt0aGlzLl91cGRhdGVHcmFwaGljKGUsXCJnZW9tZXRyeVwiLHQscil9KSksYSgoKCk9PmUuc3ltYm9sKSwoKHQscik9Pnt0aGlzLl91cGRhdGVHcmFwaGljKGUsXCJzeW1ib2xcIix0LHIpfSkpXSxlKTt0aGlzLl9ncmFwaGljcy5zb3J0KCgodCxlKT0+dGhpcy5fZ2V0RHJhd09yZGVyKHQpLXRoaXMuX2dldERyYXdPcmRlcihlKSkpfX1fdXBkYXRlR3JhcGhpYyh0LGUscixpKXtpZighdGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuaGFzKHQpKXtjb25zdCBlPXRoaXMuX2NyZWF0ZUdyYXBoaWModCk7cmV0dXJuIHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLnNldCh0LGUpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLnNldChlLHQpLHZvaWQgdGhpcy5fZ3JhcGhpY3MuYWRkKGUpfWNvbnN0IHM9dGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuZ2V0KHQpO3NbZV09cixNLmdyYXBoaWM9cyxNLnByb3BlcnR5PWUsTS5vbGRWYWx1ZT1pLE0ubmV3VmFsdWU9cix0aGlzLl9ncmFwaGljc1ZpZXcuZ3JhcGhpY1VwZGF0ZUhhbmRsZXIoTSl9X3VwZGF0ZUhpZ2hsaWdodCgpe2NvbnN0IHQ9QXJyYXkuZnJvbSh0aGlzLl9oaWdobGlnaHRJZHMua2V5cygpKTt0aGlzLl9ncmFwaGljc1ZpZXcuc2V0SGlnaGxpZ2h0KHQpfX07dChbaCgpXSxHLnByb3RvdHlwZSxcIl9ncmFwaGljc1wiLHZvaWQgMCksdChbaCgpXSxHLnByb3RvdHlwZSxcIl9yb3V0ZUl0ZW1zXCIsbnVsbCksRz10KFtuKFwiZXNyaS52aWV3cy4yZC5sYXllcnMuUm91dGVMYXllclZpZXcyRFwiKV0sRyk7Y29uc3QgST1HO2V4cG9ydHtJIGFzIGRlZmF1bHR9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjgvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtXR0xEcmF3UGhhc2UgYXMgZX1mcm9tXCIuLi8uLi9lbmdpbmUvd2ViZ2wvZW51bXMuanNcIjtpbXBvcnQgciBmcm9tXCIuL0Jhc2VHcmFwaGljQ29udGFpbmVyLmpzXCI7Y2xhc3MgaSBleHRlbmRzIHJ7cmVuZGVyQ2hpbGRyZW4ocil7dGhpcy5hdHRyaWJ1dGVWaWV3LnVwZGF0ZSgpLHRoaXMuY2hpbGRyZW4uc29tZSgoZT0+ZS5oYXNEYXRhKSkmJih0aGlzLmF0dHJpYnV0ZVZpZXcuYmluZFRleHR1cmVzKHIuY29udGV4dCwhMSksc3VwZXIucmVuZGVyQ2hpbGRyZW4ociksci5kcmF3UGhhc2U9PT1lLk1BUCYmdGhpcy5fcmVuZGVyQ2hpbGRyZW4ociksdGhpcy5oYXNIaWdobGlnaHQmJnIuZHJhd1BoYXNlPT09ZS5ISUdITElHSFQmJnRoaXMuX3JlbmRlckhpZ2hsaWdodChyKSx0aGlzLl9ib3VuZHNSZW5kZXJlciYmdGhpcy5fYm91bmRzUmVuZGVyZXIuZG9SZW5kZXIocikpfV9yZW5kZXJIaWdobGlnaHQoZSl7Y29uc3R7cGFpbnRlcjpyfT1lLGk9ci5lZmZlY3RzLmhpZ2hsaWdodDtpLmJpbmQoZSksdGhpcy5fcmVuZGVyQ2hpbGRyZW4oZSxpLmRlZmluZXMpLGkuZHJhdyhlKSxpLnVuYmluZCgpfX1leHBvcnR7aSBhcyBkZWZhdWx0fTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==