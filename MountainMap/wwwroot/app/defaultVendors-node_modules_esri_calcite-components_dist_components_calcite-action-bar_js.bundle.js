"use strict";
(self["webpackChunkmm"] = self["webpackChunkmm"] || []).push([["defaultVendors-node_modules_esri_calcite-components_dist_components_calcite-action-bar_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/components/ExpandToggle.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/ExpandToggle.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   E: () => (/* binding */ ExpandToggle),
/* harmony export */   a: () => (/* binding */ overflowActions),
/* harmony export */   b: () => (/* binding */ getOverflowCount),
/* harmony export */   g: () => (/* binding */ geActionDimensions),
/* harmony export */   o: () => (/* binding */ overflowActionsDebounceInMs),
/* harmony export */   q: () => (/* binding */ queryActions),
/* harmony export */   t: () => (/* binding */ toggleChildActionText)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _action_group_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./action-group.js */ "./node_modules/@esri/calcite-components/dist/components/action-group.js");
/* harmony import */ var _action_menu_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./action-menu.js */ "./node_modules/@esri/calcite-components/dist/components/action-menu.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */





const overflowActionsDebounceInMs = 150;
const groupBufferPx = 2;
const getAverage = (arr) => arr.reduce((p, c) => p + c, 0) / arr.length;
const geActionDimensions = (actions) => {
  const actionsNotSlotted = actions.filter((action) => action.slot !== _action_group_js__WEBPACK_IMPORTED_MODULE_1__.S.menuActions);
  const actionLen = actionsNotSlotted?.length;
  return {
    actionWidth: actionLen ? getAverage(actionsNotSlotted.map((action) => action.clientWidth || 0)) : 0,
    actionHeight: actionLen ? getAverage(actionsNotSlotted.map((action) => action.clientHeight || 0)) : 0,
  };
};
const getMaxActionCount = ({ width, actionWidth, layout, height, actionHeight, groupCount, }) => {
  const maxContainerPx = layout === "horizontal" ? width : height;
  const avgItemPx = layout === "horizontal" ? actionWidth : actionHeight;
  return Math.floor((maxContainerPx - groupCount * groupBufferPx) / avgItemPx);
};
const getOverflowCount = ({ layout, actionCount, actionWidth, width, actionHeight, height, groupCount, }) => {
  return Math.max(actionCount - getMaxActionCount({ width, actionWidth, layout, height, actionHeight, groupCount }), 0);
};
const queryActions = (el) => {
  return Array.from(el.querySelectorAll("calcite-action")).filter((action) => action.closest("calcite-action-menu") ? action.slot === _action_menu_js__WEBPACK_IMPORTED_MODULE_2__.S.trigger : true);
};
const overflowActions = ({ actionGroups, expanded, overflowCount, }) => {
  let needToSlotCount = overflowCount;
  actionGroups.reverse().forEach((group) => {
    let slottedWithinGroupCount = 0;
    const groupActions = queryActions(group).reverse();
    groupActions.forEach((groupAction) => {
      if (groupAction.slot === _action_group_js__WEBPACK_IMPORTED_MODULE_1__.S.menuActions) {
        groupAction.removeAttribute("slot");
        groupAction.textEnabled = expanded;
      }
    });
    if (needToSlotCount > 0) {
      groupActions.some((groupAction) => {
        const unslottedActions = groupActions.filter((action) => !action.slot);
        if (unslottedActions.length > 1 && groupActions.length > 2 && !groupAction.closest("calcite-action-menu")) {
          groupAction.textEnabled = true;
          groupAction.setAttribute("slot", _action_group_js__WEBPACK_IMPORTED_MODULE_1__.S.menuActions);
          slottedWithinGroupCount++;
          if (slottedWithinGroupCount > 1) {
            needToSlotCount--;
          }
        }
        return needToSlotCount < 1;
      });
    }
    (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.forceUpdate)(group);
  });
};

const ICONS = {
  chevronsLeft: "chevrons-left",
  chevronsRight: "chevrons-right",
};
function getCalcitePosition(position, el) {
  return position || el.closest("calcite-shell-panel")?.position || "start";
}
function toggleChildActionText({ el, expanded, }) {
  queryActions(el)
    .filter((el) => el.slot !== _action_group_js__WEBPACK_IMPORTED_MODULE_1__.S.menuActions)
    .forEach((action) => (action.textEnabled = expanded));
  el.querySelectorAll("calcite-action-group, calcite-action-menu").forEach((el) => (el.expanded = expanded));
}
const setTooltipReference = ({ tooltip, referenceElement, expanded, ref, }) => {
  if (tooltip) {
    tooltip.referenceElement = !expanded && referenceElement ? referenceElement : null;
  }
  if (ref) {
    ref(referenceElement);
  }
  return referenceElement;
};
const ExpandToggle = ({ expanded, expandText, collapseText, toggle, el, position, tooltip, ref, scale, }) => {
  const rtl = (0,_dom_js__WEBPACK_IMPORTED_MODULE_0__.b)(el) === "rtl";
  const text = expanded ? collapseText : expandText;
  const icons = [ICONS.chevronsLeft, ICONS.chevronsRight];
  if (rtl) {
    icons.reverse();
  }
  const end = getCalcitePosition(position, el) === "end";
  const expandIcon = end ? icons[1] : icons[0];
  const collapseIcon = end ? icons[0] : icons[1];
  const actionNode = ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_3__.h)("calcite-action", { icon: expanded ? expandIcon : collapseIcon, onClick: toggle, scale: scale, text: text, textEnabled: expanded, title: !expanded && !tooltip ? text : null, 
    // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
    ref: (referenceElement) => setTooltipReference({ tooltip, referenceElement, expanded, ref }) }));
  return actionNode;
};




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/action-group.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/action-group.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ ActionGroup),
/* harmony export */   S: () => (/* binding */ SLOTS),
/* harmony export */   d: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./conditionalSlot.js */ "./node_modules/@esri/calcite-components/dist/components/conditionalSlot.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _action_menu_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./action-menu.js */ "./node_modules/@esri/calcite-components/dist/components/action-menu.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _action_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./action.js */ "./node_modules/@esri/calcite-components/dist/components/action.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./icon.js */ "./node_modules/@esri/calcite-components/dist/components/icon.js");
/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./loader.js */ "./node_modules/@esri/calcite-components/dist/components/loader.js");
/* harmony import */ var _popover_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./popover.js */ "./node_modules/@esri/calcite-components/dist/components/popover.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */












const SLOTS = {
  menuActions: "menu-actions",
  menuTooltip: "menu-tooltip",
};
const ICONS = {
  menu: "ellipsis",
};
const CSS = {
  container: "container",
};

const actionGroupCss = ":host{box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{display:flex;flex-direction:column;padding:0px;--calcite-action-group-columns:3;--calcite-action-group-gap:1px;--calcite-action-group-padding:1px}.container{display:flex;flex-grow:1;flex-direction:column}:host([columns=\"1\"]){--calcite-action-group-columns:1}:host([columns=\"2\"]){--calcite-action-group-columns:2}:host([columns=\"3\"]){--calcite-action-group-columns:3}:host([columns=\"4\"]){--calcite-action-group-columns:4}:host([columns=\"5\"]){--calcite-action-group-columns:5}:host([columns=\"6\"]){--calcite-action-group-columns:6}:host(:first-child){padding-block-start:0px}:host([layout=horizontal]),:host([layout=horizontal]) .container{flex-direction:row}:host([layout=grid]){display:grid}:host([layout=grid]) .container{display:grid;place-content:stretch;background-color:var(--calcite-ui-background);gap:var(--calcite-action-group-gap);padding:var(--calcite-action-group-gap);grid-template-columns:repeat(var(--calcite-action-group-columns), auto)}:host([hidden]){display:none}[hidden]{display:none}";

const ActionGroup = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    // --------------------------------------------------------------------------
    //
    //  Private Methods
    //
    // --------------------------------------------------------------------------
    this.setMenuOpen = (event) => {
      this.menuOpen = !!event.target.open;
    };
    this.handleMenuActionsSlotChange = (event) => {
      this.hasMenuActions = (0,_dom_js__WEBPACK_IMPORTED_MODULE_5__.e)(event);
    };
    this.expanded = false;
    this.label = undefined;
    this.layout = "vertical";
    this.columns = undefined;
    this.menuOpen = false;
    this.overlayPositioning = "absolute";
    this.scale = undefined;
    this.messages = undefined;
    this.messageOverrides = undefined;
    this.effectiveLocale = "";
    this.defaultMessages = undefined;
    this.hasMenuActions = false;
  }
  expandedHandler() {
    this.menuOpen = false;
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, this.effectiveLocale);
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component's first focusable element. */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.c)(this);
    this.el.focus();
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    (0,_conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__.c)(this);
  }
  disconnectedCallback() {
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
    (0,_conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__.d)(this);
  }
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.a)(this);
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_3__.s)(this);
  }
  componentDidLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_1__.s)(this);
  }
  // --------------------------------------------------------------------------
  //
  //  Component Methods
  //
  // --------------------------------------------------------------------------
  renderMenu() {
    const { expanded, menuOpen, scale, layout, messages, overlayPositioning, hasMenuActions } = this;
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("calcite-action-menu", { expanded: expanded, flipPlacements: ["left", "right"], hidden: !hasMenuActions, label: messages.more, onCalciteActionMenuOpen: this.setMenuOpen, open: menuOpen, overlayPositioning: overlayPositioning, placement: layout === "horizontal" ? "bottom-start" : "leading-start", scale: scale }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("calcite-action", { icon: ICONS.menu, scale: scale, slot: _action_menu_js__WEBPACK_IMPORTED_MODULE_4__.S.trigger, text: messages.more, textEnabled: expanded }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("slot", { name: SLOTS.menuActions, onSlotchange: this.handleMenuActionsSlotChange }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("slot", { name: SLOTS.menuTooltip, slot: _action_menu_js__WEBPACK_IMPORTED_MODULE_4__.S.tooltip })));
  }
  render() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("div", { "aria-label": this.label, class: CSS.container, role: "group" }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_10__.h)("slot", null), this.renderMenu()));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "expanded": ["expandedHandler"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange"]
  }; }
  static get style() { return actionGroupCss; }
}, [17, "calcite-action-group", {
    "expanded": [516],
    "label": [1],
    "layout": [513],
    "columns": [514],
    "menuOpen": [1540, "menu-open"],
    "overlayPositioning": [513, "overlay-positioning"],
    "scale": [513],
    "messages": [1040],
    "messageOverrides": [1040],
    "effectiveLocale": [32],
    "defaultMessages": [32],
    "hasMenuActions": [32],
    "setFocus": [64]
  }]);
function defineCustomElement() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-action-group", "calcite-action", "calcite-action-menu", "calcite-icon", "calcite-loader", "calcite-popover"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-action-group":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, ActionGroup);
      }
      break;
    case "calcite-action":
      if (!customElements.get(tagName)) {
        (0,_action_js__WEBPACK_IMPORTED_MODULE_6__.d)();
      }
      break;
    case "calcite-action-menu":
      if (!customElements.get(tagName)) {
        (0,_action_menu_js__WEBPACK_IMPORTED_MODULE_4__.d)();
      }
      break;
    case "calcite-icon":
      if (!customElements.get(tagName)) {
        (0,_icon_js__WEBPACK_IMPORTED_MODULE_7__.d)();
      }
      break;
    case "calcite-loader":
      if (!customElements.get(tagName)) {
        (0,_loader_js__WEBPACK_IMPORTED_MODULE_8__.d)();
      }
      break;
    case "calcite-popover":
      if (!customElements.get(tagName)) {
        (0,_popover_js__WEBPACK_IMPORTED_MODULE_9__.d)();
      }
      break;
  } });
}
defineCustomElement();




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/calcite-action-bar.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/calcite-action-bar.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CalciteActionBar: () => (/* binding */ CalciteActionBar),
/* harmony export */   defineCustomElement: () => (/* binding */ defineCustomElement)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./conditionalSlot.js */ "./node_modules/@esri/calcite-components/dist/components/conditionalSlot.js");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom.js */ "./node_modules/@esri/calcite-components/dist/components/dom.js");
/* harmony import */ var _loadable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loadable.js */ "./node_modules/@esri/calcite-components/dist/components/loadable.js");
/* harmony import */ var _locale_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locale.js */ "./node_modules/@esri/calcite-components/dist/components/locale.js");
/* harmony import */ var _observers_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./observers.js */ "./node_modules/@esri/calcite-components/dist/components/observers.js");
/* harmony import */ var _t9n_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./t9n.js */ "./node_modules/@esri/calcite-components/dist/components/t9n.js");
/* harmony import */ var _ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ExpandToggle.js */ "./node_modules/@esri/calcite-components/dist/components/ExpandToggle.js");
/* harmony import */ var _action_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./action.js */ "./node_modules/@esri/calcite-components/dist/components/action.js");
/* harmony import */ var _action_group_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./action-group.js */ "./node_modules/@esri/calcite-components/dist/components/action-group.js");
/* harmony import */ var _action_menu_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./action-menu.js */ "./node_modules/@esri/calcite-components/dist/components/action-menu.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./icon.js */ "./node_modules/@esri/calcite-components/dist/components/icon.js");
/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./loader.js */ "./node_modules/@esri/calcite-components/dist/components/loader.js");
/* harmony import */ var _popover_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./popover.js */ "./node_modules/@esri/calcite-components/dist/components/popover.js");
/* harmony import */ var _debounce_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./debounce.js */ "./node_modules/@esri/calcite-components/dist/components/debounce.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */
















const CSS = {
  actionGroupEnd: "action-group--end",
};
const SLOTS = {
  actionsEnd: "actions-end",
  bottomActions: "bottom-actions",
  expandTooltip: "expand-tooltip",
};

const actionBarCss = ":host{box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{pointer-events:auto;display:inline-flex;align-self:stretch;--calcite-action-bar-expanded-max-width:auto}:host([layout=vertical]){flex-direction:column}:host([layout=vertical]) .action-group--end{margin-block-start:auto}:host([layout=horizontal]){flex-direction:row}:host([layout=horizontal]) .action-group--end{margin-inline-start:auto}:host([layout=vertical][overflow-actions-disabled]){overflow-y:auto}:host([layout=horizontal][overflow-actions-disabled]){overflow-x:auto}:host([layout=vertical][expanded]){max-inline-size:var(--calcite-action-bar-expanded-max-width)}::slotted(calcite-action-group){border-block-end:1px solid var(--calcite-ui-border-3)}:host([layout=horizontal]) ::slotted(calcite-action-group){border-block-end:0;border-inline-end:1px solid var(--calcite-ui-border-3)}:host([layout=horizontal][expand-disabled]) ::slotted(calcite-action-group:last-of-type){border-inline-end:0}::slotted(calcite-action-group:last-child){border-block-end:0;border-inline-end:0}.action-group--end{justify-content:flex-end}:host([hidden]){display:none}[hidden]{display:none}";

const ActionBar = /*@__PURE__*/ (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.proxyCustomElement)(class extends _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.HTMLElement {
  constructor() {
    super();
    this.__registerHost();
    this.__attachShadow();
    this.calciteActionBarToggle = (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.createEvent)(this, "calciteActionBarToggle", 6);
    this.mutationObserver = (0,_observers_js__WEBPACK_IMPORTED_MODULE_4__.c)("mutation", () => {
      const { el, expanded } = this;
      (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.t)({ el, expanded });
      this.overflowActions();
    });
    this.resizeObserver = (0,_observers_js__WEBPACK_IMPORTED_MODULE_4__.c)("resize", (entries) => this.resizeHandlerEntries(entries));
    // --------------------------------------------------------------------------
    //
    //  Private Methods
    //
    // --------------------------------------------------------------------------
    this.actionMenuOpenHandler = (event) => {
      if (event.target.menuOpen) {
        const composedPath = event.composedPath();
        Array.from(this.el.querySelectorAll("calcite-action-group")).forEach((group) => {
          if (!composedPath.includes(group)) {
            group.menuOpen = false;
          }
        });
      }
    };
    this.resizeHandlerEntries = (entries) => {
      entries.forEach(this.resizeHandler);
    };
    this.resizeHandler = (entry) => {
      const { width, height } = entry.contentRect;
      this.resize({ width, height });
    };
    this.resize = (0,_debounce_js__WEBPACK_IMPORTED_MODULE_13__.d)(({ width, height }) => {
      const { el, expanded, expandDisabled, layout, overflowActionsDisabled } = this;
      if (overflowActionsDisabled ||
        (layout === "vertical" && !height) ||
        (layout === "horizontal" && !width)) {
        return;
      }
      const actions = (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.q)(el);
      const actionCount = expandDisabled ? actions.length : actions.length + 1;
      const actionGroups = Array.from(el.querySelectorAll("calcite-action-group"));
      this.setGroupLayout(actionGroups);
      const groupCount = this.hasActionsEnd || this.hasBottomActions || !expandDisabled
        ? actionGroups.length + 1
        : actionGroups.length;
      const { actionHeight, actionWidth } = (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.g)(actions);
      const overflowCount = (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.b)({
        layout,
        actionCount,
        actionHeight,
        actionWidth,
        height,
        width,
        groupCount,
      });
      (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.a)({
        actionGroups,
        expanded,
        overflowCount,
      });
    }, _ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.o);
    this.toggleExpand = () => {
      this.expanded = !this.expanded;
      this.calciteActionBarToggle.emit();
    };
    this.setExpandToggleRef = (el) => {
      this.expandToggleEl = el;
    };
    this.handleDefaultSlotChange = (event) => {
      const groups = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.s)(event).filter((el) => el.matches("calcite-action-group"));
      this.setGroupLayout(groups);
    };
    this.handleActionsEndSlotChange = (event) => {
      this.hasActionsEnd = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.e)(event);
    };
    this.handleBottomActionsSlotChange = (event) => {
      this.hasBottomActions = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.e)(event);
    };
    this.handleTooltipSlotChange = (event) => {
      const tooltips = (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.s)(event).filter((el) => el?.matches("calcite-tooltip"));
      this.expandTooltip = tooltips[0];
    };
    this.actionsEndGroupLabel = undefined;
    this.expandDisabled = false;
    this.expanded = false;
    this.layout = "vertical";
    this.overflowActionsDisabled = false;
    this.position = undefined;
    this.scale = undefined;
    this.messages = undefined;
    this.messageOverrides = undefined;
    this.effectiveLocale = undefined;
    this.hasActionsEnd = false;
    this.hasBottomActions = false;
    this.expandTooltip = undefined;
    this.defaultMessages = undefined;
  }
  expandHandler() {
    this.overflowActions();
  }
  expandedHandler() {
    const { el, expanded } = this;
    (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.t)({ el, expanded });
    this.overflowActions();
  }
  layoutHandler() {
    this.updateGroups();
  }
  overflowDisabledHandler(overflowActionsDisabled) {
    if (overflowActionsDisabled) {
      this.resizeObserver?.disconnect();
      return;
    }
    this.resizeObserver?.observe(this.el);
    this.overflowActions();
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  effectiveLocaleChange() {
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_5__.u)(this, this.effectiveLocale);
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  componentDidLoad() {
    const { el, expanded } = this;
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_2__.s)(this);
    (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.t)({ el, expanded });
    this.overflowActions();
  }
  connectedCallback() {
    const { el, expanded } = this;
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_5__.c)(this);
    (0,_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.t)({ el, expanded });
    this.mutationObserver?.observe(el, { childList: true, subtree: true });
    if (!this.overflowActionsDisabled) {
      this.resizeObserver?.observe(el);
    }
    this.overflowActions();
    (0,_conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__.c)(this);
  }
  async componentWillLoad() {
    (0,_loadable_js__WEBPACK_IMPORTED_MODULE_2__.a)(this);
    await (0,_t9n_js__WEBPACK_IMPORTED_MODULE_5__.s)(this);
  }
  disconnectedCallback() {
    this.mutationObserver?.disconnect();
    this.resizeObserver?.disconnect();
    (0,_conditionalSlot_js__WEBPACK_IMPORTED_MODULE_0__.d)(this);
    (0,_locale_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
    (0,_t9n_js__WEBPACK_IMPORTED_MODULE_5__.d)(this);
  }
  // --------------------------------------------------------------------------
  //
  //  Methods
  //
  // --------------------------------------------------------------------------
  /**
   * Overflows actions that won't fit into menus.
   *
   * @internal
   */
  async overflowActions() {
    this.resize({ width: this.el.clientWidth, height: this.el.clientHeight });
  }
  /**
   * Sets focus on the component's first focusable element.
   */
  async setFocus() {
    await (0,_loadable_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_dom_js__WEBPACK_IMPORTED_MODULE_1__.f)(this.el);
  }
  updateGroups() {
    this.setGroupLayout(Array.from(this.el.querySelectorAll("calcite-action-group")));
  }
  setGroupLayout(groups) {
    groups.forEach((group) => (group.layout = this.layout));
  }
  // --------------------------------------------------------------------------
  //
  //  Render Methods
  //
  // --------------------------------------------------------------------------
  renderBottomActionGroup() {
    const { expanded, expandDisabled, el, position, toggleExpand, scale, layout, messages, actionsEndGroupLabel, } = this;
    const expandToggleNode = !expandDisabled ? ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)(_ExpandToggle_js__WEBPACK_IMPORTED_MODULE_6__.E, { collapseText: messages.collapse, el: el, expandText: messages.expand, expanded: expanded, position: position, scale: scale, toggle: toggleExpand, tooltip: this.expandTooltip,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: this.setExpandToggleRef })) : null;
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)("calcite-action-group", { class: CSS.actionGroupEnd, hidden: this.expandDisabled && !(this.hasActionsEnd || this.hasBottomActions), label: actionsEndGroupLabel, layout: layout, scale: scale }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)("slot", { name: SLOTS.actionsEnd, onSlotchange: this.handleActionsEndSlotChange }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)("slot", { name: SLOTS.bottomActions, onSlotchange: this.handleBottomActionsSlotChange }), (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)("slot", { name: SLOTS.expandTooltip, onSlotchange: this.handleTooltipSlotChange }), expandToggleNode));
  }
  render() {
    return ((0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)(_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.Host, { onCalciteActionMenuOpen: this.actionMenuOpenHandler }, (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_14__.h)("slot", { onSlotchange: this.handleDefaultSlotChange }), this.renderBottomActionGroup()));
  }
  static get assetsDirs() { return ["assets"]; }
  get el() { return this; }
  static get watchers() { return {
    "expandDisabled": ["expandHandler"],
    "expanded": ["expandedHandler"],
    "layout": ["layoutHandler"],
    "overflowActionsDisabled": ["overflowDisabledHandler"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange"]
  }; }
  static get style() { return actionBarCss; }
}, [1, "calcite-action-bar", {
    "actionsEndGroupLabel": [1, "actions-end-group-label"],
    "expandDisabled": [516, "expand-disabled"],
    "expanded": [1540],
    "layout": [513],
    "overflowActionsDisabled": [516, "overflow-actions-disabled"],
    "position": [513],
    "scale": [513],
    "messages": [1040],
    "messageOverrides": [1040],
    "effectiveLocale": [32],
    "hasActionsEnd": [32],
    "hasBottomActions": [32],
    "expandTooltip": [32],
    "defaultMessages": [32],
    "overflowActions": [64],
    "setFocus": [64]
  }]);
function defineCustomElement$1() {
  if (typeof customElements === "undefined") {
    return;
  }
  const components = ["calcite-action-bar", "calcite-action", "calcite-action-group", "calcite-action-menu", "calcite-icon", "calcite-loader", "calcite-popover"];
  components.forEach(tagName => { switch (tagName) {
    case "calcite-action-bar":
      if (!customElements.get(tagName)) {
        customElements.define(tagName, ActionBar);
      }
      break;
    case "calcite-action":
      if (!customElements.get(tagName)) {
        (0,_action_js__WEBPACK_IMPORTED_MODULE_7__.d)();
      }
      break;
    case "calcite-action-group":
      if (!customElements.get(tagName)) {
        (0,_action_group_js__WEBPACK_IMPORTED_MODULE_8__.d)();
      }
      break;
    case "calcite-action-menu":
      if (!customElements.get(tagName)) {
        (0,_action_menu_js__WEBPACK_IMPORTED_MODULE_9__.d)();
      }
      break;
    case "calcite-icon":
      if (!customElements.get(tagName)) {
        (0,_icon_js__WEBPACK_IMPORTED_MODULE_10__.d)();
      }
      break;
    case "calcite-loader":
      if (!customElements.get(tagName)) {
        (0,_loader_js__WEBPACK_IMPORTED_MODULE_11__.d)();
      }
      break;
    case "calcite-popover":
      if (!customElements.get(tagName)) {
        (0,_popover_js__WEBPACK_IMPORTED_MODULE_12__.d)();
      }
      break;
  } });
}
defineCustomElement$1();

const CalciteActionBar = ActionBar;
const defineCustomElement = defineCustomElement$1;




/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/components/conditionalSlot.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/components/conditionalSlot.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectConditionalSlotComponent),
/* harmony export */   d: () => (/* binding */ disconnectConditionalSlotComponent)
/* harmony export */ });
/* harmony import */ var _stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @stencil/core/internal/client/index.js */ "./node_modules/@stencil/core/internal/client/index.js");
/* harmony import */ var _observers_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observers.js */ "./node_modules/@esri/calcite-components/dist/components/observers.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */



const observed = new Set();
let mutationObserver;
const observerOptions = { childList: true };
/**
 * Helper to set up a conditional slot component on connectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function connectConditionalSlotComponent(component) {
  if (!mutationObserver) {
    mutationObserver = (0,_observers_js__WEBPACK_IMPORTED_MODULE_0__.c)("mutation", processMutations);
  }
  mutationObserver.observe(component.el, observerOptions);
}
/**
 * Helper to tear down a conditional slot component on disconnectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function disconnectConditionalSlotComponent(component) {
  observed.delete(component.el);
  // we explicitly process queued mutations and disconnect and reconnect
  // the observer until MutationObserver gets an `unobserve` method
  // see https://github.com/whatwg/dom/issues/126
  processMutations(mutationObserver.takeRecords());
  mutationObserver.disconnect();
  for (const [element] of observed.entries()) {
    mutationObserver.observe(element, observerOptions);
  }
}
function processMutations(mutations) {
  mutations.forEach(({ target }) => {
    (0,_stencil_core_internal_client_index_js__WEBPACK_IMPORTED_MODULE_1__.forceUpdate)(target);
  });
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmYXVsdFZlbmRvcnMtbm9kZV9tb2R1bGVzX2VzcmlfY2FsY2l0ZS1jb21wb25lbnRzX2Rpc3RfY29tcG9uZW50c19jYWxjaXRlLWFjdGlvbi1iYXJfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN3RTtBQUMxQjtBQUNHO0FBQ0g7O0FBRTlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLCtDQUFPO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwrREFBK0Q7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEVBQTRFO0FBQ3hHLG9EQUFvRCw4REFBOEQ7QUFDbEg7QUFDQTtBQUNBLHNJQUFzSSw4Q0FBSztBQUMzSTtBQUNBLDJCQUEyQix3Q0FBd0M7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwrQ0FBTztBQUN0QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQywrQ0FBTztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxJQUFJLG1GQUFXO0FBQ2YsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGVBQWU7QUFDaEQ7QUFDQSxnQ0FBZ0MsK0NBQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDJDQUEyQztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdGQUFnRjtBQUN4RyxjQUFjLDBDQUFhO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseUVBQUMscUJBQXFCO0FBQzVDO0FBQ0EscURBQXFELDBDQUEwQyxHQUFHO0FBQ2xHO0FBQ0E7O0FBRW9MOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbkdwTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQzRGO0FBQ3lCO0FBQ1A7QUFDaEM7QUFDb0M7QUFDdEM7QUFDZjtBQUNKO0FBQ0Y7QUFDRTtBQUNDOztBQUUxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw4QkFBOEIsc0JBQXNCLGdEQUFnRCwrQkFBK0Isc0NBQXNDLFFBQVEsc0JBQXNCLE1BQU0sYUFBYSxzQkFBc0IsWUFBWSxpQ0FBaUMsK0JBQStCLG1DQUFtQyxXQUFXLGFBQWEsWUFBWSxzQkFBc0IsdUJBQXVCLGlDQUFpQyx1QkFBdUIsaUNBQWlDLHVCQUF1QixpQ0FBaUMsdUJBQXVCLGlDQUFpQyx1QkFBdUIsaUNBQWlDLHVCQUF1QixpQ0FBaUMsb0JBQW9CLHdCQUF3QixpRUFBaUUsbUJBQW1CLHFCQUFxQixhQUFhLGdDQUFnQyxhQUFhLHNCQUFzQiw4Q0FBOEMsb0NBQW9DLHdDQUF3Qyx3RUFBd0UsZ0JBQWdCLGFBQWEsU0FBUyxhQUFhOztBQUVuc0Msa0NBQWtDLDJGQUFrQixlQUFlLGdGQUFXO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBDQUE0QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLDBDQUFjO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLCtDQUFrQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSw2Q0FBZ0I7QUFDcEIsSUFBSSwwQ0FBZTtBQUNuQixJQUFJLHNEQUErQjtBQUNuQztBQUNBO0FBQ0EsSUFBSSw2Q0FBbUI7QUFDdkIsSUFBSSwwQ0FBa0I7QUFDdEIsSUFBSSxzREFBa0M7QUFDdEM7QUFDQTtBQUNBLElBQUksK0NBQXNCO0FBQzFCLFVBQVUsMENBQWE7QUFDdkI7QUFDQTtBQUNBLElBQUksK0NBQWtCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxrRkFBa0Y7QUFDOUYsWUFBWSwwRUFBQywwQkFBMEIsOFJBQThSLEVBQUUsMEVBQUMscUJBQXFCLHNDQUFzQyw4Q0FBTyxzREFBc0QsR0FBRywwRUFBQyxXQUFXLHlFQUF5RSxHQUFHLDBFQUFDLFdBQVcsK0JBQStCLDhDQUFPLFVBQVU7QUFDdmxCO0FBQ0E7QUFDQSxZQUFZLDBFQUFDLFVBQVUsK0RBQStELEVBQUUsMEVBQUM7QUFDekY7QUFDQSxnQ0FBZ0M7QUFDaEMsNEJBQTRCO0FBQzVCLGFBQWE7QUFDYiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDZDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsa0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwyQ0FBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDZDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOENBQXFCO0FBQzdCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFa0U7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoTGxFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDK0c7QUFDTTtBQUNLO0FBQ1o7QUFDaEM7QUFDekI7QUFDNkQ7QUFDMkY7QUFDcEo7QUFDTTtBQUNEO0FBQ1A7QUFDRTtBQUNDO0FBQ1o7O0FBRTlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNEJBQTRCLHNCQUFzQixnREFBZ0QsK0JBQStCLHNDQUFzQyxRQUFRLHNCQUFzQixNQUFNLG9CQUFvQixvQkFBb0IsbUJBQW1CLDZDQUE2Qyx5QkFBeUIsc0JBQXNCLDRDQUE0Qyx3QkFBd0IsMkJBQTJCLG1CQUFtQiw4Q0FBOEMseUJBQXlCLG9EQUFvRCxnQkFBZ0Isc0RBQXNELGdCQUFnQixtQ0FBbUMsNkRBQTZELGdDQUFnQyxzREFBc0QsMkRBQTJELG1CQUFtQix1REFBdUQseUZBQXlGLG9CQUFvQiwyQ0FBMkMsbUJBQW1CLG9CQUFvQixtQkFBbUIseUJBQXlCLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFOXZDLGdDQUFnQywyRkFBa0IsZUFBZSxnRkFBVztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxvRkFBVztBQUM3Qyw0QkFBNEIsZ0RBQWM7QUFDMUMsY0FBYyxlQUFlO0FBQzdCLE1BQU0sbURBQXFCLEdBQUcsY0FBYztBQUM1QztBQUNBLEtBQUs7QUFDTCwwQkFBMEIsZ0RBQWM7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsZ0JBQWdCO0FBQzlCLG9CQUFvQixlQUFlO0FBQ25DO0FBQ0Esa0JBQWtCLGdEQUFRLElBQUksZUFBZTtBQUM3QyxjQUFjLGdFQUFnRTtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLG1EQUFZO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNEJBQTRCLEVBQUUsbURBQWtCO0FBQzlELDRCQUE0QixtREFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTSxtREFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSyxFQUFFLCtDQUEyQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDBDQUE2QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMENBQTRCO0FBQ3ZEO0FBQ0E7QUFDQSw4QkFBOEIsMENBQTRCO0FBQzFEO0FBQ0E7QUFDQSx1QkFBdUIsMENBQTZCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksZUFBZTtBQUMzQixJQUFJLG1EQUFxQixHQUFHLGNBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksMENBQWM7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGVBQWU7QUFDM0IsSUFBSSwrQ0FBa0I7QUFDdEIsSUFBSSxtREFBcUIsR0FBRyxjQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFlBQVksZUFBZTtBQUMzQixJQUFJLDZDQUFnQjtBQUNwQixJQUFJLDBDQUFlO0FBQ25CLElBQUksbURBQXFCLEdBQUcsY0FBYztBQUMxQyx5Q0FBeUMsZ0NBQWdDO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxzREFBK0I7QUFDbkM7QUFDQTtBQUNBLElBQUksK0NBQXNCO0FBQzFCLFVBQVUsMENBQWE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHNEQUFrQztBQUN0QyxJQUFJLDZDQUFtQjtBQUN2QixJQUFJLDBDQUFrQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMERBQTBEO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLCtDQUFrQjtBQUM1QixJQUFJLDBDQUFrQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksdUdBQXVHO0FBQ25ILGdEQUFnRCwwRUFBQyxDQUFDLCtDQUFZLElBQUk7QUFDbEU7QUFDQSxvQ0FBb0M7QUFDcEMsWUFBWSwwRUFBQywyQkFBMkIscUtBQXFLLEVBQUUsMEVBQUMsV0FBVyx1RUFBdUUsR0FBRywwRUFBQyxXQUFXLDZFQUE2RSxHQUFHLDBFQUFDLFdBQVcsdUVBQXVFO0FBQ3BkO0FBQ0E7QUFDQSxZQUFZLDBFQUFDLENBQUMseUVBQUksSUFBSSxxREFBcUQsRUFBRSwwRUFBQyxXQUFXLDRDQUE0QztBQUNySTtBQUNBLDRCQUE0QjtBQUM1QixhQUFhO0FBQ2IsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw2Q0FBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLG1EQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsa0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSw0Q0FBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDhDQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0NBQXFCO0FBQzdCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVpRDs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDclRqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3FFO0FBQ2hCOztBQUVyRDtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdFQUF3RTtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixnREFBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3RUFBd0U7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixRQUFRO0FBQy9CLElBQUksbUZBQVc7QUFDZixHQUFHO0FBQ0g7O0FBRXlGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9FeHBhbmRUb2dnbGUuanMiLCJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9hY3Rpb24tZ3JvdXAuanMiLCJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9jYWxjaXRlLWFjdGlvbi1iYXIuanMiLCJ3ZWJwYWNrOi8vbW0vLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvY29tcG9uZW50cy9jb25kaXRpb25hbFNsb3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjExLjBcbiAqL1xuaW1wb3J0IHsgZm9yY2VVcGRhdGUsIGggfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBiIGFzIGdldEVsZW1lbnREaXIgfSBmcm9tICcuL2RvbS5qcyc7XG5pbXBvcnQgeyBTIGFzIFNMT1RTJDEgfSBmcm9tICcuL2FjdGlvbi1ncm91cC5qcyc7XG5pbXBvcnQgeyBTIGFzIFNMT1RTIH0gZnJvbSAnLi9hY3Rpb24tbWVudS5qcyc7XG5cbmNvbnN0IG92ZXJmbG93QWN0aW9uc0RlYm91bmNlSW5NcyA9IDE1MDtcbmNvbnN0IGdyb3VwQnVmZmVyUHggPSAyO1xuY29uc3QgZ2V0QXZlcmFnZSA9IChhcnIpID0+IGFyci5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjLCAwKSAvIGFyci5sZW5ndGg7XG5jb25zdCBnZUFjdGlvbkRpbWVuc2lvbnMgPSAoYWN0aW9ucykgPT4ge1xuICBjb25zdCBhY3Rpb25zTm90U2xvdHRlZCA9IGFjdGlvbnMuZmlsdGVyKChhY3Rpb24pID0+IGFjdGlvbi5zbG90ICE9PSBTTE9UUyQxLm1lbnVBY3Rpb25zKTtcbiAgY29uc3QgYWN0aW9uTGVuID0gYWN0aW9uc05vdFNsb3R0ZWQ/Lmxlbmd0aDtcbiAgcmV0dXJuIHtcbiAgICBhY3Rpb25XaWR0aDogYWN0aW9uTGVuID8gZ2V0QXZlcmFnZShhY3Rpb25zTm90U2xvdHRlZC5tYXAoKGFjdGlvbikgPT4gYWN0aW9uLmNsaWVudFdpZHRoIHx8IDApKSA6IDAsXG4gICAgYWN0aW9uSGVpZ2h0OiBhY3Rpb25MZW4gPyBnZXRBdmVyYWdlKGFjdGlvbnNOb3RTbG90dGVkLm1hcCgoYWN0aW9uKSA9PiBhY3Rpb24uY2xpZW50SGVpZ2h0IHx8IDApKSA6IDAsXG4gIH07XG59O1xuY29uc3QgZ2V0TWF4QWN0aW9uQ291bnQgPSAoeyB3aWR0aCwgYWN0aW9uV2lkdGgsIGxheW91dCwgaGVpZ2h0LCBhY3Rpb25IZWlnaHQsIGdyb3VwQ291bnQsIH0pID0+IHtcbiAgY29uc3QgbWF4Q29udGFpbmVyUHggPSBsYXlvdXQgPT09IFwiaG9yaXpvbnRhbFwiID8gd2lkdGggOiBoZWlnaHQ7XG4gIGNvbnN0IGF2Z0l0ZW1QeCA9IGxheW91dCA9PT0gXCJob3Jpem9udGFsXCIgPyBhY3Rpb25XaWR0aCA6IGFjdGlvbkhlaWdodDtcbiAgcmV0dXJuIE1hdGguZmxvb3IoKG1heENvbnRhaW5lclB4IC0gZ3JvdXBDb3VudCAqIGdyb3VwQnVmZmVyUHgpIC8gYXZnSXRlbVB4KTtcbn07XG5jb25zdCBnZXRPdmVyZmxvd0NvdW50ID0gKHsgbGF5b3V0LCBhY3Rpb25Db3VudCwgYWN0aW9uV2lkdGgsIHdpZHRoLCBhY3Rpb25IZWlnaHQsIGhlaWdodCwgZ3JvdXBDb3VudCwgfSkgPT4ge1xuICByZXR1cm4gTWF0aC5tYXgoYWN0aW9uQ291bnQgLSBnZXRNYXhBY3Rpb25Db3VudCh7IHdpZHRoLCBhY3Rpb25XaWR0aCwgbGF5b3V0LCBoZWlnaHQsIGFjdGlvbkhlaWdodCwgZ3JvdXBDb3VudCB9KSwgMCk7XG59O1xuY29uc3QgcXVlcnlBY3Rpb25zID0gKGVsKSA9PiB7XG4gIHJldHVybiBBcnJheS5mcm9tKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLWFjdGlvblwiKSkuZmlsdGVyKChhY3Rpb24pID0+IGFjdGlvbi5jbG9zZXN0KFwiY2FsY2l0ZS1hY3Rpb24tbWVudVwiKSA/IGFjdGlvbi5zbG90ID09PSBTTE9UUy50cmlnZ2VyIDogdHJ1ZSk7XG59O1xuY29uc3Qgb3ZlcmZsb3dBY3Rpb25zID0gKHsgYWN0aW9uR3JvdXBzLCBleHBhbmRlZCwgb3ZlcmZsb3dDb3VudCwgfSkgPT4ge1xuICBsZXQgbmVlZFRvU2xvdENvdW50ID0gb3ZlcmZsb3dDb3VudDtcbiAgYWN0aW9uR3JvdXBzLnJldmVyc2UoKS5mb3JFYWNoKChncm91cCkgPT4ge1xuICAgIGxldCBzbG90dGVkV2l0aGluR3JvdXBDb3VudCA9IDA7XG4gICAgY29uc3QgZ3JvdXBBY3Rpb25zID0gcXVlcnlBY3Rpb25zKGdyb3VwKS5yZXZlcnNlKCk7XG4gICAgZ3JvdXBBY3Rpb25zLmZvckVhY2goKGdyb3VwQWN0aW9uKSA9PiB7XG4gICAgICBpZiAoZ3JvdXBBY3Rpb24uc2xvdCA9PT0gU0xPVFMkMS5tZW51QWN0aW9ucykge1xuICAgICAgICBncm91cEFjdGlvbi5yZW1vdmVBdHRyaWJ1dGUoXCJzbG90XCIpO1xuICAgICAgICBncm91cEFjdGlvbi50ZXh0RW5hYmxlZCA9IGV4cGFuZGVkO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChuZWVkVG9TbG90Q291bnQgPiAwKSB7XG4gICAgICBncm91cEFjdGlvbnMuc29tZSgoZ3JvdXBBY3Rpb24pID0+IHtcbiAgICAgICAgY29uc3QgdW5zbG90dGVkQWN0aW9ucyA9IGdyb3VwQWN0aW9ucy5maWx0ZXIoKGFjdGlvbikgPT4gIWFjdGlvbi5zbG90KTtcbiAgICAgICAgaWYgKHVuc2xvdHRlZEFjdGlvbnMubGVuZ3RoID4gMSAmJiBncm91cEFjdGlvbnMubGVuZ3RoID4gMiAmJiAhZ3JvdXBBY3Rpb24uY2xvc2VzdChcImNhbGNpdGUtYWN0aW9uLW1lbnVcIikpIHtcbiAgICAgICAgICBncm91cEFjdGlvbi50ZXh0RW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgZ3JvdXBBY3Rpb24uc2V0QXR0cmlidXRlKFwic2xvdFwiLCBTTE9UUyQxLm1lbnVBY3Rpb25zKTtcbiAgICAgICAgICBzbG90dGVkV2l0aGluR3JvdXBDb3VudCsrO1xuICAgICAgICAgIGlmIChzbG90dGVkV2l0aGluR3JvdXBDb3VudCA+IDEpIHtcbiAgICAgICAgICAgIG5lZWRUb1Nsb3RDb3VudC0tO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmVlZFRvU2xvdENvdW50IDwgMTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmb3JjZVVwZGF0ZShncm91cCk7XG4gIH0pO1xufTtcblxuY29uc3QgSUNPTlMgPSB7XG4gIGNoZXZyb25zTGVmdDogXCJjaGV2cm9ucy1sZWZ0XCIsXG4gIGNoZXZyb25zUmlnaHQ6IFwiY2hldnJvbnMtcmlnaHRcIixcbn07XG5mdW5jdGlvbiBnZXRDYWxjaXRlUG9zaXRpb24ocG9zaXRpb24sIGVsKSB7XG4gIHJldHVybiBwb3NpdGlvbiB8fCBlbC5jbG9zZXN0KFwiY2FsY2l0ZS1zaGVsbC1wYW5lbFwiKT8ucG9zaXRpb24gfHwgXCJzdGFydFwiO1xufVxuZnVuY3Rpb24gdG9nZ2xlQ2hpbGRBY3Rpb25UZXh0KHsgZWwsIGV4cGFuZGVkLCB9KSB7XG4gIHF1ZXJ5QWN0aW9ucyhlbClcbiAgICAuZmlsdGVyKChlbCkgPT4gZWwuc2xvdCAhPT0gU0xPVFMkMS5tZW51QWN0aW9ucylcbiAgICAuZm9yRWFjaCgoYWN0aW9uKSA9PiAoYWN0aW9uLnRleHRFbmFibGVkID0gZXhwYW5kZWQpKTtcbiAgZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtYWN0aW9uLWdyb3VwLCBjYWxjaXRlLWFjdGlvbi1tZW51XCIpLmZvckVhY2goKGVsKSA9PiAoZWwuZXhwYW5kZWQgPSBleHBhbmRlZCkpO1xufVxuY29uc3Qgc2V0VG9vbHRpcFJlZmVyZW5jZSA9ICh7IHRvb2x0aXAsIHJlZmVyZW5jZUVsZW1lbnQsIGV4cGFuZGVkLCByZWYsIH0pID0+IHtcbiAgaWYgKHRvb2x0aXApIHtcbiAgICB0b29sdGlwLnJlZmVyZW5jZUVsZW1lbnQgPSAhZXhwYW5kZWQgJiYgcmVmZXJlbmNlRWxlbWVudCA/IHJlZmVyZW5jZUVsZW1lbnQgOiBudWxsO1xuICB9XG4gIGlmIChyZWYpIHtcbiAgICByZWYocmVmZXJlbmNlRWxlbWVudCk7XG4gIH1cbiAgcmV0dXJuIHJlZmVyZW5jZUVsZW1lbnQ7XG59O1xuY29uc3QgRXhwYW5kVG9nZ2xlID0gKHsgZXhwYW5kZWQsIGV4cGFuZFRleHQsIGNvbGxhcHNlVGV4dCwgdG9nZ2xlLCBlbCwgcG9zaXRpb24sIHRvb2x0aXAsIHJlZiwgc2NhbGUsIH0pID0+IHtcbiAgY29uc3QgcnRsID0gZ2V0RWxlbWVudERpcihlbCkgPT09IFwicnRsXCI7XG4gIGNvbnN0IHRleHQgPSBleHBhbmRlZCA/IGNvbGxhcHNlVGV4dCA6IGV4cGFuZFRleHQ7XG4gIGNvbnN0IGljb25zID0gW0lDT05TLmNoZXZyb25zTGVmdCwgSUNPTlMuY2hldnJvbnNSaWdodF07XG4gIGlmIChydGwpIHtcbiAgICBpY29ucy5yZXZlcnNlKCk7XG4gIH1cbiAgY29uc3QgZW5kID0gZ2V0Q2FsY2l0ZVBvc2l0aW9uKHBvc2l0aW9uLCBlbCkgPT09IFwiZW5kXCI7XG4gIGNvbnN0IGV4cGFuZEljb24gPSBlbmQgPyBpY29uc1sxXSA6IGljb25zWzBdO1xuICBjb25zdCBjb2xsYXBzZUljb24gPSBlbmQgPyBpY29uc1swXSA6IGljb25zWzFdO1xuICBjb25zdCBhY3Rpb25Ob2RlID0gKGgoXCJjYWxjaXRlLWFjdGlvblwiLCB7IGljb246IGV4cGFuZGVkID8gZXhwYW5kSWNvbiA6IGNvbGxhcHNlSWNvbiwgb25DbGljazogdG9nZ2xlLCBzY2FsZTogc2NhbGUsIHRleHQ6IHRleHQsIHRleHRFbmFibGVkOiBleHBhbmRlZCwgdGl0bGU6ICFleHBhbmRlZCAmJiAhdG9vbHRpcCA/IHRleHQgOiBudWxsLCBcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QvanN4LXNvcnQtcHJvcHMgLS0gcmVmIHNob3VsZCBiZSBsYXN0IHNvIG5vZGUgYXR0cnMvcHJvcHMgYXJlIGluIHN5bmMgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vcHVsbC82NTMwKVxuICAgIHJlZjogKHJlZmVyZW5jZUVsZW1lbnQpID0+IHNldFRvb2x0aXBSZWZlcmVuY2UoeyB0b29sdGlwLCByZWZlcmVuY2VFbGVtZW50LCBleHBhbmRlZCwgcmVmIH0pIH0pKTtcbiAgcmV0dXJuIGFjdGlvbk5vZGU7XG59O1xuXG5leHBvcnQgeyBFeHBhbmRUb2dnbGUgYXMgRSwgb3ZlcmZsb3dBY3Rpb25zIGFzIGEsIGdldE92ZXJmbG93Q291bnQgYXMgYiwgZ2VBY3Rpb25EaW1lbnNpb25zIGFzIGcsIG92ZXJmbG93QWN0aW9uc0RlYm91bmNlSW5NcyBhcyBvLCBxdWVyeUFjdGlvbnMgYXMgcSwgdG9nZ2xlQ2hpbGRBY3Rpb25UZXh0IGFzIHQgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4xMS4wXG4gKi9cbmltcG9ydCB7IHByb3h5Q3VzdG9tRWxlbWVudCwgSFRNTEVsZW1lbnQsIGggfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQsIGQgYXMgZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCB9IGZyb20gJy4vY29uZGl0aW9uYWxTbG90LmpzJztcbmltcG9ydCB7IGMgYXMgY29tcG9uZW50Rm9jdXNhYmxlLCBhIGFzIHNldFVwTG9hZGFibGVDb21wb25lbnQsIHMgYXMgc2V0Q29tcG9uZW50TG9hZGVkIH0gZnJvbSAnLi9sb2FkYWJsZS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RMb2NhbGl6ZWQsIGQgYXMgZGlzY29ubmVjdExvY2FsaXplZCB9IGZyb20gJy4vbG9jYWxlLmpzJztcbmltcG9ydCB7IHUgYXMgdXBkYXRlTWVzc2FnZXMsIGMgYXMgY29ubmVjdE1lc3NhZ2VzLCBkIGFzIGRpc2Nvbm5lY3RNZXNzYWdlcywgcyBhcyBzZXRVcE1lc3NhZ2VzIH0gZnJvbSAnLi90OW4uanMnO1xuaW1wb3J0IHsgUyBhcyBTTE9UUyQxLCBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkNCB9IGZyb20gJy4vYWN0aW9uLW1lbnUuanMnO1xuaW1wb3J0IHsgZSBhcyBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50IH0gZnJvbSAnLi9kb20uanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDUgfSBmcm9tICcuL2FjdGlvbi5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkMyB9IGZyb20gJy4vaWNvbi5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkMiB9IGZyb20gJy4vbG9hZGVyLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQxIH0gZnJvbSAnLi9wb3BvdmVyLmpzJztcblxuY29uc3QgU0xPVFMgPSB7XG4gIG1lbnVBY3Rpb25zOiBcIm1lbnUtYWN0aW9uc1wiLFxuICBtZW51VG9vbHRpcDogXCJtZW51LXRvb2x0aXBcIixcbn07XG5jb25zdCBJQ09OUyA9IHtcbiAgbWVudTogXCJlbGxpcHNpc1wiLFxufTtcbmNvbnN0IENTUyA9IHtcbiAgY29udGFpbmVyOiBcImNvbnRhaW5lclwiLFxufTtcblxuY29uc3QgYWN0aW9uR3JvdXBDc3MgPSBcIjpob3N0e2JveC1zaXppbmc6Ym9yZGVyLWJveDtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKTtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMik7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0xKX06aG9zdCAqe2JveC1zaXppbmc6Ym9yZGVyLWJveH06aG9zdHtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO3BhZGRpbmc6MHB4Oy0tY2FsY2l0ZS1hY3Rpb24tZ3JvdXAtY29sdW1uczozOy0tY2FsY2l0ZS1hY3Rpb24tZ3JvdXAtZ2FwOjFweDstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLXBhZGRpbmc6MXB4fS5jb250YWluZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZ3JvdzoxO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn06aG9zdChbY29sdW1ucz1cXFwiMVxcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6MX06aG9zdChbY29sdW1ucz1cXFwiMlxcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6Mn06aG9zdChbY29sdW1ucz1cXFwiM1xcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6M306aG9zdChbY29sdW1ucz1cXFwiNFxcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6NH06aG9zdChbY29sdW1ucz1cXFwiNVxcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6NX06aG9zdChbY29sdW1ucz1cXFwiNlxcXCJdKXstLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnM6Nn06aG9zdCg6Zmlyc3QtY2hpbGQpe3BhZGRpbmctYmxvY2stc3RhcnQ6MHB4fTpob3N0KFtsYXlvdXQ9aG9yaXpvbnRhbF0pLDpob3N0KFtsYXlvdXQ9aG9yaXpvbnRhbF0pIC5jb250YWluZXJ7ZmxleC1kaXJlY3Rpb246cm93fTpob3N0KFtsYXlvdXQ9Z3JpZF0pe2Rpc3BsYXk6Z3JpZH06aG9zdChbbGF5b3V0PWdyaWRdKSAuY29udGFpbmVye2Rpc3BsYXk6Z3JpZDtwbGFjZS1jb250ZW50OnN0cmV0Y2g7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJhY2tncm91bmQpO2dhcDp2YXIoLS1jYWxjaXRlLWFjdGlvbi1ncm91cC1nYXApO3BhZGRpbmc6dmFyKC0tY2FsY2l0ZS1hY3Rpb24tZ3JvdXAtZ2FwKTtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KHZhcigtLWNhbGNpdGUtYWN0aW9uLWdyb3VwLWNvbHVtbnMpLCBhdXRvKX06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfVtoaWRkZW5de2Rpc3BsYXk6bm9uZX1cIjtcblxuY29uc3QgQWN0aW9uR3JvdXAgPSAvKkBfX1BVUkVfXyovIHByb3h5Q3VzdG9tRWxlbWVudChjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9fcmVnaXN0ZXJIb3N0KCk7XG4gICAgdGhpcy5fX2F0dGFjaFNoYWRvdygpO1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMuc2V0TWVudU9wZW4gPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMubWVudU9wZW4gPSAhIWV2ZW50LnRhcmdldC5vcGVuO1xuICAgIH07XG4gICAgdGhpcy5oYW5kbGVNZW51QWN0aW9uc1Nsb3RDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuaGFzTWVudUFjdGlvbnMgPSBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50KGV2ZW50KTtcbiAgICB9O1xuICAgIHRoaXMuZXhwYW5kZWQgPSBmYWxzZTtcbiAgICB0aGlzLmxhYmVsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubGF5b3V0ID0gXCJ2ZXJ0aWNhbFwiO1xuICAgIHRoaXMuY29sdW1ucyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lbnVPcGVuID0gZmFsc2U7XG4gICAgdGhpcy5vdmVybGF5UG9zaXRpb25pbmcgPSBcImFic29sdXRlXCI7XG4gICAgdGhpcy5zY2FsZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWVzc2FnZU92ZXJyaWRlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmVmZmVjdGl2ZUxvY2FsZSA9IFwiXCI7XG4gICAgdGhpcy5kZWZhdWx0TWVzc2FnZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oYXNNZW51QWN0aW9ucyA9IGZhbHNlO1xuICB9XG4gIGV4cGFuZGVkSGFuZGxlcigpIHtcbiAgICB0aGlzLm1lbnVPcGVuID0gZmFsc2U7XG4gIH1cbiAgb25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgICAvKiB3aXJlZCB1cCBieSB0OW4gdXRpbCAqL1xuICB9XG4gIGVmZmVjdGl2ZUxvY2FsZUNoYW5nZSgpIHtcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHVibGljIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKiogU2V0cyBmb2N1cyBvbiB0aGUgY29tcG9uZW50J3MgZmlyc3QgZm9jdXNhYmxlIGVsZW1lbnQuICovXG4gIGFzeW5jIHNldEZvY3VzKCkge1xuICAgIGF3YWl0IGNvbXBvbmVudEZvY3VzYWJsZSh0aGlzKTtcbiAgICB0aGlzLmVsLmZvY3VzKCk7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGNvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgICBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KHRoaXMpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRpc2Nvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgZGlzY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQodGhpcyk7XG4gIH1cbiAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgc2V0VXBMb2FkYWJsZUNvbXBvbmVudCh0aGlzKTtcbiAgICBhd2FpdCBzZXRVcE1lc3NhZ2VzKHRoaXMpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgc2V0Q29tcG9uZW50TG9hZGVkKHRoaXMpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBDb21wb25lbnQgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICByZW5kZXJNZW51KCkge1xuICAgIGNvbnN0IHsgZXhwYW5kZWQsIG1lbnVPcGVuLCBzY2FsZSwgbGF5b3V0LCBtZXNzYWdlcywgb3ZlcmxheVBvc2l0aW9uaW5nLCBoYXNNZW51QWN0aW9ucyB9ID0gdGhpcztcbiAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWFjdGlvbi1tZW51XCIsIHsgZXhwYW5kZWQ6IGV4cGFuZGVkLCBmbGlwUGxhY2VtZW50czogW1wibGVmdFwiLCBcInJpZ2h0XCJdLCBoaWRkZW46ICFoYXNNZW51QWN0aW9ucywgbGFiZWw6IG1lc3NhZ2VzLm1vcmUsIG9uQ2FsY2l0ZUFjdGlvbk1lbnVPcGVuOiB0aGlzLnNldE1lbnVPcGVuLCBvcGVuOiBtZW51T3Blbiwgb3ZlcmxheVBvc2l0aW9uaW5nOiBvdmVybGF5UG9zaXRpb25pbmcsIHBsYWNlbWVudDogbGF5b3V0ID09PSBcImhvcml6b250YWxcIiA/IFwiYm90dG9tLXN0YXJ0XCIgOiBcImxlYWRpbmctc3RhcnRcIiwgc2NhbGU6IHNjYWxlIH0sIGgoXCJjYWxjaXRlLWFjdGlvblwiLCB7IGljb246IElDT05TLm1lbnUsIHNjYWxlOiBzY2FsZSwgc2xvdDogU0xPVFMkMS50cmlnZ2VyLCB0ZXh0OiBtZXNzYWdlcy5tb3JlLCB0ZXh0RW5hYmxlZDogZXhwYW5kZWQgfSksIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMubWVudUFjdGlvbnMsIG9uU2xvdGNoYW5nZTogdGhpcy5oYW5kbGVNZW51QWN0aW9uc1Nsb3RDaGFuZ2UgfSksIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMubWVudVRvb2x0aXAsIHNsb3Q6IFNMT1RTJDEudG9vbHRpcCB9KSkpO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBcImFyaWEtbGFiZWxcIjogdGhpcy5sYWJlbCwgY2xhc3M6IENTUy5jb250YWluZXIsIHJvbGU6IFwiZ3JvdXBcIiB9LCBoKFwic2xvdFwiLCBudWxsKSwgdGhpcy5yZW5kZXJNZW51KCkpKTtcbiAgfVxuICBzdGF0aWMgZ2V0IGRlbGVnYXRlc0ZvY3VzKCkgeyByZXR1cm4gdHJ1ZTsgfVxuICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJhc3NldHNcIl07IH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwiZXhwYW5kZWRcIjogW1wiZXhwYW5kZWRIYW5kbGVyXCJdLFxuICAgIFwibWVzc2FnZU92ZXJyaWRlc1wiOiBbXCJvbk1lc3NhZ2VzQ2hhbmdlXCJdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFtcImVmZmVjdGl2ZUxvY2FsZUNoYW5nZVwiXVxuICB9OyB9XG4gIHN0YXRpYyBnZXQgc3R5bGUoKSB7IHJldHVybiBhY3Rpb25Hcm91cENzczsgfVxufSwgWzE3LCBcImNhbGNpdGUtYWN0aW9uLWdyb3VwXCIsIHtcbiAgICBcImV4cGFuZGVkXCI6IFs1MTZdLFxuICAgIFwibGFiZWxcIjogWzFdLFxuICAgIFwibGF5b3V0XCI6IFs1MTNdLFxuICAgIFwiY29sdW1uc1wiOiBbNTE0XSxcbiAgICBcIm1lbnVPcGVuXCI6IFsxNTQwLCBcIm1lbnUtb3BlblwiXSxcbiAgICBcIm92ZXJsYXlQb3NpdGlvbmluZ1wiOiBbNTEzLCBcIm92ZXJsYXktcG9zaXRpb25pbmdcIl0sXG4gICAgXCJzY2FsZVwiOiBbNTEzXSxcbiAgICBcIm1lc3NhZ2VzXCI6IFsxMDQwXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogWzEwNDBdLFxuICAgIFwiZWZmZWN0aXZlTG9jYWxlXCI6IFszMl0sXG4gICAgXCJkZWZhdWx0TWVzc2FnZXNcIjogWzMyXSxcbiAgICBcImhhc01lbnVBY3Rpb25zXCI6IFszMl0sXG4gICAgXCJzZXRGb2N1c1wiOiBbNjRdXG4gIH1dKTtcbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnQoKSB7XG4gIGlmICh0eXBlb2YgY3VzdG9tRWxlbWVudHMgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgY29tcG9uZW50cyA9IFtcImNhbGNpdGUtYWN0aW9uLWdyb3VwXCIsIFwiY2FsY2l0ZS1hY3Rpb25cIiwgXCJjYWxjaXRlLWFjdGlvbi1tZW51XCIsIFwiY2FsY2l0ZS1pY29uXCIsIFwiY2FsY2l0ZS1sb2FkZXJcIiwgXCJjYWxjaXRlLXBvcG92ZXJcIl07XG4gIGNvbXBvbmVudHMuZm9yRWFjaCh0YWdOYW1lID0+IHsgc3dpdGNoICh0YWdOYW1lKSB7XG4gICAgY2FzZSBcImNhbGNpdGUtYWN0aW9uLWdyb3VwXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgQWN0aW9uR3JvdXApO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtYWN0aW9uXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDUoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWFjdGlvbi1tZW51XCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDQoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWljb25cIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtbG9hZGVyXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBkZWZpbmVDdXN0b21FbGVtZW50JDIoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLXBvcG92ZXJcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMSgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH0gfSk7XG59XG5kZWZpbmVDdXN0b21FbGVtZW50KCk7XG5cbmV4cG9ydCB7IEFjdGlvbkdyb3VwIGFzIEEsIFNMT1RTIGFzIFMsIGRlZmluZUN1c3RvbUVsZW1lbnQgYXMgZCB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjExLjBcbiAqL1xuaW1wb3J0IHsgcHJveHlDdXN0b21FbGVtZW50LCBIVE1MRWxlbWVudCwgY3JlYXRlRXZlbnQsIGgsIEhvc3QgfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQsIGQgYXMgZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCB9IGZyb20gJy4vY29uZGl0aW9uYWxTbG90LmpzJztcbmltcG9ydCB7IHMgYXMgc2xvdENoYW5nZUdldEFzc2lnbmVkRWxlbWVudHMsIGUgYXMgc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudCwgZiBhcyBmb2N1c0ZpcnN0VGFiYmFibGUgfSBmcm9tICcuL2RvbS5qcyc7XG5pbXBvcnQgeyBzIGFzIHNldENvbXBvbmVudExvYWRlZCwgYSBhcyBzZXRVcExvYWRhYmxlQ29tcG9uZW50LCBjIGFzIGNvbXBvbmVudEZvY3VzYWJsZSB9IGZyb20gJy4vbG9hZGFibGUuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25uZWN0TG9jYWxpemVkLCBkIGFzIGRpc2Nvbm5lY3RMb2NhbGl6ZWQgfSBmcm9tICcuL2xvY2FsZS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZU9ic2VydmVyIH0gZnJvbSAnLi9vYnNlcnZlcnMuanMnO1xuaW1wb3J0IHsgdSBhcyB1cGRhdGVNZXNzYWdlcywgYyBhcyBjb25uZWN0TWVzc2FnZXMsIHMgYXMgc2V0VXBNZXNzYWdlcywgZCBhcyBkaXNjb25uZWN0TWVzc2FnZXMgfSBmcm9tICcuL3Q5bi5qcyc7XG5pbXBvcnQgeyB0IGFzIHRvZ2dsZUNoaWxkQWN0aW9uVGV4dCwgRSBhcyBFeHBhbmRUb2dnbGUsIG8gYXMgb3ZlcmZsb3dBY3Rpb25zRGVib3VuY2VJbk1zLCBxIGFzIHF1ZXJ5QWN0aW9ucywgZyBhcyBnZUFjdGlvbkRpbWVuc2lvbnMsIGEgYXMgb3ZlcmZsb3dBY3Rpb25zLCBiIGFzIGdldE92ZXJmbG93Q291bnQgfSBmcm9tICcuL0V4cGFuZFRvZ2dsZS5qcyc7XG5pbXBvcnQgeyBkIGFzIGRlZmluZUN1c3RvbUVsZW1lbnQkNyB9IGZyb20gJy4vYWN0aW9uLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ2IH0gZnJvbSAnLi9hY3Rpb24tZ3JvdXAuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDUgfSBmcm9tICcuL2FjdGlvbi1tZW51LmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQ0IH0gZnJvbSAnLi9pY29uLmpzJztcbmltcG9ydCB7IGQgYXMgZGVmaW5lQ3VzdG9tRWxlbWVudCQzIH0gZnJvbSAnLi9sb2FkZXIuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWZpbmVDdXN0b21FbGVtZW50JDIgfSBmcm9tICcuL3BvcG92ZXIuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWJvdW5jZSB9IGZyb20gJy4vZGVib3VuY2UuanMnO1xuXG5jb25zdCBDU1MgPSB7XG4gIGFjdGlvbkdyb3VwRW5kOiBcImFjdGlvbi1ncm91cC0tZW5kXCIsXG59O1xuY29uc3QgU0xPVFMgPSB7XG4gIGFjdGlvbnNFbmQ6IFwiYWN0aW9ucy1lbmRcIixcbiAgYm90dG9tQWN0aW9uczogXCJib3R0b20tYWN0aW9uc1wiLFxuICBleHBhbmRUb29sdGlwOiBcImV4cGFuZC10b29sdGlwXCIsXG59O1xuXG5jb25zdCBhY3Rpb25CYXJDc3MgPSBcIjpob3N0e2JveC1zaXppbmc6Ym9yZGVyLWJveDtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKTtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMik7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0xKX06aG9zdCAqe2JveC1zaXppbmc6Ym9yZGVyLWJveH06aG9zdHtwb2ludGVyLWV2ZW50czphdXRvO2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24tc2VsZjpzdHJldGNoOy0tY2FsY2l0ZS1hY3Rpb24tYmFyLWV4cGFuZGVkLW1heC13aWR0aDphdXRvfTpob3N0KFtsYXlvdXQ9dmVydGljYWxdKXtmbGV4LWRpcmVjdGlvbjpjb2x1bW59Omhvc3QoW2xheW91dD12ZXJ0aWNhbF0pIC5hY3Rpb24tZ3JvdXAtLWVuZHttYXJnaW4tYmxvY2stc3RhcnQ6YXV0b306aG9zdChbbGF5b3V0PWhvcml6b250YWxdKXtmbGV4LWRpcmVjdGlvbjpyb3d9Omhvc3QoW2xheW91dD1ob3Jpem9udGFsXSkgLmFjdGlvbi1ncm91cC0tZW5ke21hcmdpbi1pbmxpbmUtc3RhcnQ6YXV0b306aG9zdChbbGF5b3V0PXZlcnRpY2FsXVtvdmVyZmxvdy1hY3Rpb25zLWRpc2FibGVkXSl7b3ZlcmZsb3cteTphdXRvfTpob3N0KFtsYXlvdXQ9aG9yaXpvbnRhbF1bb3ZlcmZsb3ctYWN0aW9ucy1kaXNhYmxlZF0pe292ZXJmbG93LXg6YXV0b306aG9zdChbbGF5b3V0PXZlcnRpY2FsXVtleHBhbmRlZF0pe21heC1pbmxpbmUtc2l6ZTp2YXIoLS1jYWxjaXRlLWFjdGlvbi1iYXItZXhwYW5kZWQtbWF4LXdpZHRoKX06OnNsb3R0ZWQoY2FsY2l0ZS1hY3Rpb24tZ3JvdXApe2JvcmRlci1ibG9jay1lbmQ6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTMpfTpob3N0KFtsYXlvdXQ9aG9yaXpvbnRhbF0pIDo6c2xvdHRlZChjYWxjaXRlLWFjdGlvbi1ncm91cCl7Ym9yZGVyLWJsb2NrLWVuZDowO2JvcmRlci1pbmxpbmUtZW5kOjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0zKX06aG9zdChbbGF5b3V0PWhvcml6b250YWxdW2V4cGFuZC1kaXNhYmxlZF0pIDo6c2xvdHRlZChjYWxjaXRlLWFjdGlvbi1ncm91cDpsYXN0LW9mLXR5cGUpe2JvcmRlci1pbmxpbmUtZW5kOjB9OjpzbG90dGVkKGNhbGNpdGUtYWN0aW9uLWdyb3VwOmxhc3QtY2hpbGQpe2JvcmRlci1ibG9jay1lbmQ6MDtib3JkZXItaW5saW5lLWVuZDowfS5hY3Rpb24tZ3JvdXAtLWVuZHtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9Omhvc3QoW2hpZGRlbl0pe2Rpc3BsYXk6bm9uZX1baGlkZGVuXXtkaXNwbGF5Om5vbmV9XCI7XG5cbmNvbnN0IEFjdGlvbkJhciA9IC8qQF9fUFVSRV9fKi8gcHJveHlDdXN0b21FbGVtZW50KGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX19yZWdpc3Rlckhvc3QoKTtcbiAgICB0aGlzLl9fYXR0YWNoU2hhZG93KCk7XG4gICAgdGhpcy5jYWxjaXRlQWN0aW9uQmFyVG9nZ2xlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlQWN0aW9uQmFyVG9nZ2xlXCIsIDYpO1xuICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciA9IGNyZWF0ZU9ic2VydmVyKFwibXV0YXRpb25cIiwgKCkgPT4ge1xuICAgICAgY29uc3QgeyBlbCwgZXhwYW5kZWQgfSA9IHRoaXM7XG4gICAgICB0b2dnbGVDaGlsZEFjdGlvblRleHQoeyBlbCwgZXhwYW5kZWQgfSk7XG4gICAgICB0aGlzLm92ZXJmbG93QWN0aW9ucygpO1xuICAgIH0pO1xuICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBjcmVhdGVPYnNlcnZlcihcInJlc2l6ZVwiLCAoZW50cmllcykgPT4gdGhpcy5yZXNpemVIYW5kbGVyRW50cmllcyhlbnRyaWVzKSk7XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy5hY3Rpb25NZW51T3BlbkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC50YXJnZXQubWVudU9wZW4pIHtcbiAgICAgICAgY29uc3QgY29tcG9zZWRQYXRoID0gZXZlbnQuY29tcG9zZWRQYXRoKCk7XG4gICAgICAgIEFycmF5LmZyb20odGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS1hY3Rpb24tZ3JvdXBcIikpLmZvckVhY2goKGdyb3VwKSA9PiB7XG4gICAgICAgICAgaWYgKCFjb21wb3NlZFBhdGguaW5jbHVkZXMoZ3JvdXApKSB7XG4gICAgICAgICAgICBncm91cC5tZW51T3BlbiA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnJlc2l6ZUhhbmRsZXJFbnRyaWVzID0gKGVudHJpZXMpID0+IHtcbiAgICAgIGVudHJpZXMuZm9yRWFjaCh0aGlzLnJlc2l6ZUhhbmRsZXIpO1xuICAgIH07XG4gICAgdGhpcy5yZXNpemVIYW5kbGVyID0gKGVudHJ5KSA9PiB7XG4gICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGVudHJ5LmNvbnRlbnRSZWN0O1xuICAgICAgdGhpcy5yZXNpemUoeyB3aWR0aCwgaGVpZ2h0IH0pO1xuICAgIH07XG4gICAgdGhpcy5yZXNpemUgPSBkZWJvdW5jZSgoeyB3aWR0aCwgaGVpZ2h0IH0pID0+IHtcbiAgICAgIGNvbnN0IHsgZWwsIGV4cGFuZGVkLCBleHBhbmREaXNhYmxlZCwgbGF5b3V0LCBvdmVyZmxvd0FjdGlvbnNEaXNhYmxlZCB9ID0gdGhpcztcbiAgICAgIGlmIChvdmVyZmxvd0FjdGlvbnNEaXNhYmxlZCB8fFxuICAgICAgICAobGF5b3V0ID09PSBcInZlcnRpY2FsXCIgJiYgIWhlaWdodCkgfHxcbiAgICAgICAgKGxheW91dCA9PT0gXCJob3Jpem9udGFsXCIgJiYgIXdpZHRoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBhY3Rpb25zID0gcXVlcnlBY3Rpb25zKGVsKTtcbiAgICAgIGNvbnN0IGFjdGlvbkNvdW50ID0gZXhwYW5kRGlzYWJsZWQgPyBhY3Rpb25zLmxlbmd0aCA6IGFjdGlvbnMubGVuZ3RoICsgMTtcbiAgICAgIGNvbnN0IGFjdGlvbkdyb3VwcyA9IEFycmF5LmZyb20oZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtYWN0aW9uLWdyb3VwXCIpKTtcbiAgICAgIHRoaXMuc2V0R3JvdXBMYXlvdXQoYWN0aW9uR3JvdXBzKTtcbiAgICAgIGNvbnN0IGdyb3VwQ291bnQgPSB0aGlzLmhhc0FjdGlvbnNFbmQgfHwgdGhpcy5oYXNCb3R0b21BY3Rpb25zIHx8ICFleHBhbmREaXNhYmxlZFxuICAgICAgICA/IGFjdGlvbkdyb3Vwcy5sZW5ndGggKyAxXG4gICAgICAgIDogYWN0aW9uR3JvdXBzLmxlbmd0aDtcbiAgICAgIGNvbnN0IHsgYWN0aW9uSGVpZ2h0LCBhY3Rpb25XaWR0aCB9ID0gZ2VBY3Rpb25EaW1lbnNpb25zKGFjdGlvbnMpO1xuICAgICAgY29uc3Qgb3ZlcmZsb3dDb3VudCA9IGdldE92ZXJmbG93Q291bnQoe1xuICAgICAgICBsYXlvdXQsXG4gICAgICAgIGFjdGlvbkNvdW50LFxuICAgICAgICBhY3Rpb25IZWlnaHQsXG4gICAgICAgIGFjdGlvbldpZHRoLFxuICAgICAgICBoZWlnaHQsXG4gICAgICAgIHdpZHRoLFxuICAgICAgICBncm91cENvdW50LFxuICAgICAgfSk7XG4gICAgICBvdmVyZmxvd0FjdGlvbnMoe1xuICAgICAgICBhY3Rpb25Hcm91cHMsXG4gICAgICAgIGV4cGFuZGVkLFxuICAgICAgICBvdmVyZmxvd0NvdW50LFxuICAgICAgfSk7XG4gICAgfSwgb3ZlcmZsb3dBY3Rpb25zRGVib3VuY2VJbk1zKTtcbiAgICB0aGlzLnRvZ2dsZUV4cGFuZCA9ICgpID0+IHtcbiAgICAgIHRoaXMuZXhwYW5kZWQgPSAhdGhpcy5leHBhbmRlZDtcbiAgICAgIHRoaXMuY2FsY2l0ZUFjdGlvbkJhclRvZ2dsZS5lbWl0KCk7XG4gICAgfTtcbiAgICB0aGlzLnNldEV4cGFuZFRvZ2dsZVJlZiA9IChlbCkgPT4ge1xuICAgICAgdGhpcy5leHBhbmRUb2dnbGVFbCA9IGVsO1xuICAgIH07XG4gICAgdGhpcy5oYW5kbGVEZWZhdWx0U2xvdENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgZ3JvdXBzID0gc2xvdENoYW5nZUdldEFzc2lnbmVkRWxlbWVudHMoZXZlbnQpLmZpbHRlcigoZWwpID0+IGVsLm1hdGNoZXMoXCJjYWxjaXRlLWFjdGlvbi1ncm91cFwiKSk7XG4gICAgICB0aGlzLnNldEdyb3VwTGF5b3V0KGdyb3Vwcyk7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZUFjdGlvbnNFbmRTbG90Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmhhc0FjdGlvbnNFbmQgPSBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50KGV2ZW50KTtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlQm90dG9tQWN0aW9uc1Nsb3RDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuaGFzQm90dG9tQWN0aW9ucyA9IHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQoZXZlbnQpO1xuICAgIH07XG4gICAgdGhpcy5oYW5kbGVUb29sdGlwU2xvdENoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgdG9vbHRpcHMgPSBzbG90Q2hhbmdlR2V0QXNzaWduZWRFbGVtZW50cyhldmVudCkuZmlsdGVyKChlbCkgPT4gZWw/Lm1hdGNoZXMoXCJjYWxjaXRlLXRvb2x0aXBcIikpO1xuICAgICAgdGhpcy5leHBhbmRUb29sdGlwID0gdG9vbHRpcHNbMF07XG4gICAgfTtcbiAgICB0aGlzLmFjdGlvbnNFbmRHcm91cExhYmVsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZXhwYW5kRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmV4cGFuZGVkID0gZmFsc2U7XG4gICAgdGhpcy5sYXlvdXQgPSBcInZlcnRpY2FsXCI7XG4gICAgdGhpcy5vdmVyZmxvd0FjdGlvbnNEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMucG9zaXRpb24gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zY2FsZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWVzc2FnZU92ZXJyaWRlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmVmZmVjdGl2ZUxvY2FsZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhhc0FjdGlvbnNFbmQgPSBmYWxzZTtcbiAgICB0aGlzLmhhc0JvdHRvbUFjdGlvbnMgPSBmYWxzZTtcbiAgICB0aGlzLmV4cGFuZFRvb2x0aXAgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5kZWZhdWx0TWVzc2FnZXMgPSB1bmRlZmluZWQ7XG4gIH1cbiAgZXhwYW5kSGFuZGxlcigpIHtcbiAgICB0aGlzLm92ZXJmbG93QWN0aW9ucygpO1xuICB9XG4gIGV4cGFuZGVkSGFuZGxlcigpIHtcbiAgICBjb25zdCB7IGVsLCBleHBhbmRlZCB9ID0gdGhpcztcbiAgICB0b2dnbGVDaGlsZEFjdGlvblRleHQoeyBlbCwgZXhwYW5kZWQgfSk7XG4gICAgdGhpcy5vdmVyZmxvd0FjdGlvbnMoKTtcbiAgfVxuICBsYXlvdXRIYW5kbGVyKCkge1xuICAgIHRoaXMudXBkYXRlR3JvdXBzKCk7XG4gIH1cbiAgb3ZlcmZsb3dEaXNhYmxlZEhhbmRsZXIob3ZlcmZsb3dBY3Rpb25zRGlzYWJsZWQpIHtcbiAgICBpZiAob3ZlcmZsb3dBY3Rpb25zRGlzYWJsZWQpIHtcbiAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXI/LmRpc2Nvbm5lY3QoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5yZXNpemVPYnNlcnZlcj8ub2JzZXJ2ZSh0aGlzLmVsKTtcbiAgICB0aGlzLm92ZXJmbG93QWN0aW9ucygpO1xuICB9XG4gIG9uTWVzc2FnZXNDaGFuZ2UoKSB7XG4gICAgLyogd2lyZWQgdXAgYnkgdDluIHV0aWwgKi9cbiAgfVxuICBlZmZlY3RpdmVMb2NhbGVDaGFuZ2UoKSB7XG4gICAgdXBkYXRlTWVzc2FnZXModGhpcywgdGhpcy5lZmZlY3RpdmVMb2NhbGUpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICBjb25zdCB7IGVsLCBleHBhbmRlZCB9ID0gdGhpcztcbiAgICBzZXRDb21wb25lbnRMb2FkZWQodGhpcyk7XG4gICAgdG9nZ2xlQ2hpbGRBY3Rpb25UZXh0KHsgZWwsIGV4cGFuZGVkIH0pO1xuICAgIHRoaXMub3ZlcmZsb3dBY3Rpb25zKCk7XG4gIH1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29uc3QgeyBlbCwgZXhwYW5kZWQgfSA9IHRoaXM7XG4gICAgY29ubmVjdExvY2FsaXplZCh0aGlzKTtcbiAgICBjb25uZWN0TWVzc2FnZXModGhpcyk7XG4gICAgdG9nZ2xlQ2hpbGRBY3Rpb25UZXh0KHsgZWwsIGV4cGFuZGVkIH0pO1xuICAgIHRoaXMubXV0YXRpb25PYnNlcnZlcj8ub2JzZXJ2ZShlbCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG4gICAgaWYgKCF0aGlzLm92ZXJmbG93QWN0aW9uc0Rpc2FibGVkKSB7XG4gICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyPy5vYnNlcnZlKGVsKTtcbiAgICB9XG4gICAgdGhpcy5vdmVyZmxvd0FjdGlvbnMoKTtcbiAgICBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KHRoaXMpO1xuICB9XG4gIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgIHNldFVwTG9hZGFibGVDb21wb25lbnQodGhpcyk7XG4gICAgYXdhaXQgc2V0VXBNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXI/LmRpc2Nvbm5lY3QoKTtcbiAgICB0aGlzLnJlc2l6ZU9ic2VydmVyPy5kaXNjb25uZWN0KCk7XG4gICAgZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCh0aGlzKTtcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvKipcbiAgICogT3ZlcmZsb3dzIGFjdGlvbnMgdGhhdCB3b24ndCBmaXQgaW50byBtZW51cy5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqL1xuICBhc3luYyBvdmVyZmxvd0FjdGlvbnMoKSB7XG4gICAgdGhpcy5yZXNpemUoeyB3aWR0aDogdGhpcy5lbC5jbGllbnRXaWR0aCwgaGVpZ2h0OiB0aGlzLmVsLmNsaWVudEhlaWdodCB9KTtcbiAgfVxuICAvKipcbiAgICogU2V0cyBmb2N1cyBvbiB0aGUgY29tcG9uZW50J3MgZmlyc3QgZm9jdXNhYmxlIGVsZW1lbnQuXG4gICAqL1xuICBhc3luYyBzZXRGb2N1cygpIHtcbiAgICBhd2FpdCBjb21wb25lbnRGb2N1c2FibGUodGhpcyk7XG4gICAgZm9jdXNGaXJzdFRhYmJhYmxlKHRoaXMuZWwpO1xuICB9XG4gIHVwZGF0ZUdyb3VwcygpIHtcbiAgICB0aGlzLnNldEdyb3VwTGF5b3V0KEFycmF5LmZyb20odGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS1hY3Rpb24tZ3JvdXBcIikpKTtcbiAgfVxuICBzZXRHcm91cExheW91dChncm91cHMpIHtcbiAgICBncm91cHMuZm9yRWFjaCgoZ3JvdXApID0+IChncm91cC5sYXlvdXQgPSB0aGlzLmxheW91dCkpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBSZW5kZXIgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICByZW5kZXJCb3R0b21BY3Rpb25Hcm91cCgpIHtcbiAgICBjb25zdCB7IGV4cGFuZGVkLCBleHBhbmREaXNhYmxlZCwgZWwsIHBvc2l0aW9uLCB0b2dnbGVFeHBhbmQsIHNjYWxlLCBsYXlvdXQsIG1lc3NhZ2VzLCBhY3Rpb25zRW5kR3JvdXBMYWJlbCwgfSA9IHRoaXM7XG4gICAgY29uc3QgZXhwYW5kVG9nZ2xlTm9kZSA9ICFleHBhbmREaXNhYmxlZCA/IChoKEV4cGFuZFRvZ2dsZSwgeyBjb2xsYXBzZVRleHQ6IG1lc3NhZ2VzLmNvbGxhcHNlLCBlbDogZWwsIGV4cGFuZFRleHQ6IG1lc3NhZ2VzLmV4cGFuZCwgZXhwYW5kZWQ6IGV4cGFuZGVkLCBwb3NpdGlvbjogcG9zaXRpb24sIHNjYWxlOiBzY2FsZSwgdG9nZ2xlOiB0b2dnbGVFeHBhbmQsIHRvb2x0aXA6IHRoaXMuZXhwYW5kVG9vbHRpcCxcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9qc3gtc29ydC1wcm9wcyAtLSByZWYgc2hvdWxkIGJlIGxhc3Qgc28gbm9kZSBhdHRycy9wcm9wcyBhcmUgaW4gc3luYyAoc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9wdWxsLzY1MzApXG4gICAgICByZWY6IHRoaXMuc2V0RXhwYW5kVG9nZ2xlUmVmIH0pKSA6IG51bGw7XG4gICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1hY3Rpb24tZ3JvdXBcIiwgeyBjbGFzczogQ1NTLmFjdGlvbkdyb3VwRW5kLCBoaWRkZW46IHRoaXMuZXhwYW5kRGlzYWJsZWQgJiYgISh0aGlzLmhhc0FjdGlvbnNFbmQgfHwgdGhpcy5oYXNCb3R0b21BY3Rpb25zKSwgbGFiZWw6IGFjdGlvbnNFbmRHcm91cExhYmVsLCBsYXlvdXQ6IGxheW91dCwgc2NhbGU6IHNjYWxlIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMuYWN0aW9uc0VuZCwgb25TbG90Y2hhbmdlOiB0aGlzLmhhbmRsZUFjdGlvbnNFbmRTbG90Q2hhbmdlIH0pLCBoKFwic2xvdFwiLCB7IG5hbWU6IFNMT1RTLmJvdHRvbUFjdGlvbnMsIG9uU2xvdGNoYW5nZTogdGhpcy5oYW5kbGVCb3R0b21BY3Rpb25zU2xvdENoYW5nZSB9KSwgaChcInNsb3RcIiwgeyBuYW1lOiBTTE9UUy5leHBhbmRUb29sdGlwLCBvblNsb3RjaGFuZ2U6IHRoaXMuaGFuZGxlVG9vbHRpcFNsb3RDaGFuZ2UgfSksIGV4cGFuZFRvZ2dsZU5vZGUpKTtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChoKEhvc3QsIHsgb25DYWxjaXRlQWN0aW9uTWVudU9wZW46IHRoaXMuYWN0aW9uTWVudU9wZW5IYW5kbGVyIH0sIGgoXCJzbG90XCIsIHsgb25TbG90Y2hhbmdlOiB0aGlzLmhhbmRsZURlZmF1bHRTbG90Q2hhbmdlIH0pLCB0aGlzLnJlbmRlckJvdHRvbUFjdGlvbkdyb3VwKCkpKTtcbiAgfVxuICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJhc3NldHNcIl07IH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gdGhpczsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwiZXhwYW5kRGlzYWJsZWRcIjogW1wiZXhwYW5kSGFuZGxlclwiXSxcbiAgICBcImV4cGFuZGVkXCI6IFtcImV4cGFuZGVkSGFuZGxlclwiXSxcbiAgICBcImxheW91dFwiOiBbXCJsYXlvdXRIYW5kbGVyXCJdLFxuICAgIFwib3ZlcmZsb3dBY3Rpb25zRGlzYWJsZWRcIjogW1wib3ZlcmZsb3dEaXNhYmxlZEhhbmRsZXJcIl0sXG4gICAgXCJtZXNzYWdlT3ZlcnJpZGVzXCI6IFtcIm9uTWVzc2FnZXNDaGFuZ2VcIl0sXG4gICAgXCJlZmZlY3RpdmVMb2NhbGVcIjogW1wiZWZmZWN0aXZlTG9jYWxlQ2hhbmdlXCJdXG4gIH07IH1cbiAgc3RhdGljIGdldCBzdHlsZSgpIHsgcmV0dXJuIGFjdGlvbkJhckNzczsgfVxufSwgWzEsIFwiY2FsY2l0ZS1hY3Rpb24tYmFyXCIsIHtcbiAgICBcImFjdGlvbnNFbmRHcm91cExhYmVsXCI6IFsxLCBcImFjdGlvbnMtZW5kLWdyb3VwLWxhYmVsXCJdLFxuICAgIFwiZXhwYW5kRGlzYWJsZWRcIjogWzUxNiwgXCJleHBhbmQtZGlzYWJsZWRcIl0sXG4gICAgXCJleHBhbmRlZFwiOiBbMTU0MF0sXG4gICAgXCJsYXlvdXRcIjogWzUxM10sXG4gICAgXCJvdmVyZmxvd0FjdGlvbnNEaXNhYmxlZFwiOiBbNTE2LCBcIm92ZXJmbG93LWFjdGlvbnMtZGlzYWJsZWRcIl0sXG4gICAgXCJwb3NpdGlvblwiOiBbNTEzXSxcbiAgICBcInNjYWxlXCI6IFs1MTNdLFxuICAgIFwibWVzc2FnZXNcIjogWzEwNDBdLFxuICAgIFwibWVzc2FnZU92ZXJyaWRlc1wiOiBbMTA0MF0sXG4gICAgXCJlZmZlY3RpdmVMb2NhbGVcIjogWzMyXSxcbiAgICBcImhhc0FjdGlvbnNFbmRcIjogWzMyXSxcbiAgICBcImhhc0JvdHRvbUFjdGlvbnNcIjogWzMyXSxcbiAgICBcImV4cGFuZFRvb2x0aXBcIjogWzMyXSxcbiAgICBcImRlZmF1bHRNZXNzYWdlc1wiOiBbMzJdLFxuICAgIFwib3ZlcmZsb3dBY3Rpb25zXCI6IFs2NF0sXG4gICAgXCJzZXRGb2N1c1wiOiBbNjRdXG4gIH1dKTtcbmZ1bmN0aW9uIGRlZmluZUN1c3RvbUVsZW1lbnQkMSgpIHtcbiAgaWYgKHR5cGVvZiBjdXN0b21FbGVtZW50cyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb21wb25lbnRzID0gW1wiY2FsY2l0ZS1hY3Rpb24tYmFyXCIsIFwiY2FsY2l0ZS1hY3Rpb25cIiwgXCJjYWxjaXRlLWFjdGlvbi1ncm91cFwiLCBcImNhbGNpdGUtYWN0aW9uLW1lbnVcIiwgXCJjYWxjaXRlLWljb25cIiwgXCJjYWxjaXRlLWxvYWRlclwiLCBcImNhbGNpdGUtcG9wb3ZlclwiXTtcbiAgY29tcG9uZW50cy5mb3JFYWNoKHRhZ05hbWUgPT4geyBzd2l0Y2ggKHRhZ05hbWUpIHtcbiAgICBjYXNlIFwiY2FsY2l0ZS1hY3Rpb24tYmFyXCI6XG4gICAgICBpZiAoIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkge1xuICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgQWN0aW9uQmFyKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjYWxjaXRlLWFjdGlvblwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCQ3KCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1hY3Rpb24tZ3JvdXBcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNigpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtYWN0aW9uLW1lbnVcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkNSgpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtaWNvblwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCQ0KCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiY2FsY2l0ZS1sb2FkZXJcIjpcbiAgICAgIGlmICghY3VzdG9tRWxlbWVudHMuZ2V0KHRhZ05hbWUpKSB7XG4gICAgICAgIGRlZmluZUN1c3RvbUVsZW1lbnQkMygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImNhbGNpdGUtcG9wb3ZlclwiOlxuICAgICAgaWYgKCFjdXN0b21FbGVtZW50cy5nZXQodGFnTmFtZSkpIHtcbiAgICAgICAgZGVmaW5lQ3VzdG9tRWxlbWVudCQyKCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgfSB9KTtcbn1cbmRlZmluZUN1c3RvbUVsZW1lbnQkMSgpO1xuXG5jb25zdCBDYWxjaXRlQWN0aW9uQmFyID0gQWN0aW9uQmFyO1xuY29uc3QgZGVmaW5lQ3VzdG9tRWxlbWVudCA9IGRlZmluZUN1c3RvbUVsZW1lbnQkMTtcblxuZXhwb3J0IHsgQ2FsY2l0ZUFjdGlvbkJhciwgZGVmaW5lQ3VzdG9tRWxlbWVudCB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjExLjBcbiAqL1xuaW1wb3J0IHsgZm9yY2VVcGRhdGUgfSBmcm9tICdAc3RlbmNpbC9jb3JlL2ludGVybmFsL2NsaWVudC9pbmRleC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZU9ic2VydmVyIH0gZnJvbSAnLi9vYnNlcnZlcnMuanMnO1xuXG5jb25zdCBvYnNlcnZlZCA9IG5ldyBTZXQoKTtcbmxldCBtdXRhdGlvbk9ic2VydmVyO1xuY29uc3Qgb2JzZXJ2ZXJPcHRpb25zID0geyBjaGlsZExpc3Q6IHRydWUgfTtcbi8qKlxuICogSGVscGVyIHRvIHNldCB1cCBhIGNvbmRpdGlvbmFsIHNsb3QgY29tcG9uZW50IG9uIGNvbm5lY3RlZENhbGxiYWNrLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBkZXByZWNhdGVkIFVzZSBgb25TbG90Y2hhbmdlYCBldmVudCB3aXRoIGBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50YCBET00gdXRpbGl0eSBpbnN0ZWFkLlxuICpcbiAqIGBgYFxuICogPHNsb3Qgb25TbG90Y2hhbmdlPXsoZXZlbnQpID0+IHRoaXMubXlTbG90SGFzRWxlbWVudCA9IHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQoZXZlbnQpfSAvPn1cbiAqIGBgYFxuICovXG5mdW5jdGlvbiBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KGNvbXBvbmVudCkge1xuICBpZiAoIW11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICBtdXRhdGlvbk9ic2VydmVyID0gY3JlYXRlT2JzZXJ2ZXIoXCJtdXRhdGlvblwiLCBwcm9jZXNzTXV0YXRpb25zKTtcbiAgfVxuICBtdXRhdGlvbk9ic2VydmVyLm9ic2VydmUoY29tcG9uZW50LmVsLCBvYnNlcnZlck9wdGlvbnMpO1xufVxuLyoqXG4gKiBIZWxwZXIgdG8gdGVhciBkb3duIGEgY29uZGl0aW9uYWwgc2xvdCBjb21wb25lbnQgb24gZGlzY29ubmVjdGVkQ2FsbGJhY2suXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICogQGRlcHJlY2F0ZWQgVXNlIGBvblNsb3RjaGFuZ2VgIGV2ZW50IHdpdGggYHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnRgIERPTSB1dGlsaXR5IGluc3RlYWQuXG4gKlxuICogYGBgXG4gKiA8c2xvdCBvblNsb3RjaGFuZ2U9eyhldmVudCkgPT4gdGhpcy5teVNsb3RIYXNFbGVtZW50ID0gc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudChldmVudCl9IC8+fVxuICogYGBgXG4gKi9cbmZ1bmN0aW9uIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQoY29tcG9uZW50KSB7XG4gIG9ic2VydmVkLmRlbGV0ZShjb21wb25lbnQuZWwpO1xuICAvLyB3ZSBleHBsaWNpdGx5IHByb2Nlc3MgcXVldWVkIG11dGF0aW9ucyBhbmQgZGlzY29ubmVjdCBhbmQgcmVjb25uZWN0XG4gIC8vIHRoZSBvYnNlcnZlciB1bnRpbCBNdXRhdGlvbk9ic2VydmVyIGdldHMgYW4gYHVub2JzZXJ2ZWAgbWV0aG9kXG4gIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2RvbS9pc3N1ZXMvMTI2XG4gIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25PYnNlcnZlci50YWtlUmVjb3JkcygpKTtcbiAgbXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gIGZvciAoY29uc3QgW2VsZW1lbnRdIG9mIG9ic2VydmVkLmVudHJpZXMoKSkge1xuICAgIG11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50LCBvYnNlcnZlck9wdGlvbnMpO1xuICB9XG59XG5mdW5jdGlvbiBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9ucykge1xuICBtdXRhdGlvbnMuZm9yRWFjaCgoeyB0YXJnZXQgfSkgPT4ge1xuICAgIGZvcmNlVXBkYXRlKHRhcmdldCk7XG4gIH0pO1xufVxuXG5leHBvcnQgeyBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50IGFzIGMsIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQgYXMgZCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9