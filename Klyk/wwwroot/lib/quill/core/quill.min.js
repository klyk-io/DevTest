/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/quill@1.3.7/core/quill.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import"./polyfill";import Delta from"quill-delta";import Editor from"./editor";import Emitter from"./emitter";import Module from"./module";import Parchment from"parchment";import Selection,{Range}from"./selection";import extend from"extend";import logger from"./logger";import Theme from"./theme";let debug=logger("quill");class Quill{static debug(t){!0===t&&(t="log"),logger.level(t)}static find(t){return t.__quill||Parchment.find(t)}static import(t){return null==this.imports[t]&&debug.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(t,e,i=!1){if("string"!=typeof t){let i=t.attrName||t.blotName;"string"==typeof i?this.register("formats/"+i,t,e):Object.keys(t).forEach(i=>{this.register(i,t[i],e)})}else null==this.imports[t]||i||debug.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&"abstract"!==e.blotName?Parchment.register(e):t.startsWith("modules")&&"function"==typeof e.register&&e.register()}constructor(t,e={}){if(this.options=expandConfig(t,e),this.container=this.options.container,null==this.container)return debug.error("Invalid Quill container",t);this.options.debug&&Quill.debug(this.options.debug);let i=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new Emitter,this.scroll=Parchment.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new Editor(this.scroll),this.selection=new Selection(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(Emitter.events.EDITOR_CHANGE,t=>{t===Emitter.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(Emitter.events.SCROLL_UPDATE,(t,e)=>{let i=this.selection.lastRange,r=i&&0===i.length?i.index:void 0;modify.call(this,()=>this.editor.update(null,e,r),t)});let r=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">${i}<p><br></p></div>`);this.setContents(r),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}addContainer(t,e=null){if("string"==typeof t){let e=t;(t=document.createElement("div")).classList.add(e)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,i){return[t,e,,i]=overload(t,e,i),modify.call(this,()=>this.editor.deleteText(t,e),i,t,-1*e)}disable(){this.enable(!1)}enable(t=!0){this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=t,this.scrollIntoView()}format(t,e,i=Emitter.sources.API){return modify.call(this,()=>{let i=this.getSelection(!0),r=new Delta;if(null==i)return r;if(Parchment.query(t,Parchment.Scope.BLOCK))r=this.editor.formatLine(i.index,i.length,{[t]:e});else{if(0===i.length)return this.selection.format(t,e),r;r=this.editor.formatText(i.index,i.length,{[t]:e})}return this.setSelection(i,Emitter.sources.SILENT),r},i)}formatLine(t,e,i,r,o){let s;return[t,e,s,o]=overload(t,e,i,r,o),modify.call(this,()=>this.editor.formatLine(t,e,s),o,t,0)}formatText(t,e,i,r,o){let s;return[t,e,s,o]=overload(t,e,i,r,o),modify.call(this,()=>this.editor.formatText(t,e,s),o,t,0)}getBounds(t,e=0){let i;i="number"==typeof t?this.selection.getBounds(t,e):this.selection.getBounds(t.index,t.length);let r=this.container.getBoundingClientRect();return{bottom:i.bottom-r.top,height:i.height,left:i.left-r.left,right:i.right-r.left,top:i.top-r.top,width:i.width}}getContents(t=0,e=this.getLength()-t){return[t,e]=overload(t,e),this.editor.getContents(t,e)}getFormat(t=this.getSelection(!0),e=0){return"number"==typeof t?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(t=0,e=Number.MAX_VALUE){return"number"!=typeof t?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(t=!1){return t&&this.focus(),this.update(),this.selection.getRange()[0]}getText(t=0,e=this.getLength()-t){return[t,e]=overload(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,i,r=Quill.sources.API){return modify.call(this,()=>this.editor.insertEmbed(t,e,i),r,t)}insertText(t,e,i,r,o){let s;return[t,,s,o]=overload(t,0,i,r,o),modify.call(this,()=>this.editor.insertText(t,e,s),o,t,e.length)}isEnabled(){return!this.container.classList.contains("ql-disabled")}off(){return this.emitter.off.apply(this.emitter,arguments)}on(){return this.emitter.on.apply(this.emitter,arguments)}once(){return this.emitter.once.apply(this.emitter,arguments)}pasteHTML(t,e,i){this.clipboard.dangerouslyPasteHTML(t,e,i)}removeFormat(t,e,i){return[t,e,,i]=overload(t,e,i),modify.call(this,()=>this.editor.removeFormat(t,e),i,t)}scrollIntoView(){this.selection.scrollIntoView(this.scrollingContainer)}setContents(t,e=Emitter.sources.API){return modify.call(this,()=>{t=new Delta(t);let e=this.getLength(),i=this.editor.deleteText(0,e),r=this.editor.applyDelta(t),o=r.ops[r.ops.length-1];return null!=o&&"string"==typeof o.insert&&"\n"===o.insert[o.insert.length-1]&&(this.editor.deleteText(this.getLength()-1,1),r.delete(1)),i.compose(r)},e)}setSelection(t,e,i){null==t?this.selection.setRange(null,e||Quill.sources.API):([t,e,,i]=overload(t,e,i),this.selection.setRange(new Range(t,e),i),i!==Emitter.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer))}setText(t,e=Emitter.sources.API){let i=(new Delta).insert(t);return this.setContents(i,e)}update(t=Emitter.sources.USER){let e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t,e=Emitter.sources.API){return modify.call(this,()=>(t=new Delta(t),this.editor.applyDelta(t,e)),e,!0)}}function expandConfig(t,e){if((e=extend(!0,{container:t,modules:{clipboard:!0,keyboard:!0,history:!0}},e)).theme&&e.theme!==Quill.DEFAULTS.theme){if(e.theme=Quill.import(`themes/${e.theme}`),null==e.theme)throw new Error(`Invalid theme ${e.theme}. Did you register it?`)}else e.theme=Theme;let i=extend(!0,{},e.theme.DEFAULTS);[i,e].forEach(function(t){t.modules=t.modules||{},Object.keys(t.modules).forEach(function(e){!0===t.modules[e]&&(t.modules[e]={})})});let r=Object.keys(i.modules).concat(Object.keys(e.modules)).reduce(function(t,e){let i=Quill.import(`modules/${e}`);return null==i?debug.error(`Cannot load ${e} module. Are you sure you registered it?`):t[e]=i.DEFAULTS||{},t},{});return null!=e.modules&&e.modules.toolbar&&e.modules.toolbar.constructor!==Object&&(e.modules.toolbar={container:e.modules.toolbar}),e=extend(!0,{},Quill.DEFAULTS,{modules:r},i,e),["bounds","container","scrollingContainer"].forEach(function(t){"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))}),e.modules=Object.keys(e.modules).reduce(function(t,i){return e.modules[i]&&(t[i]=e.modules[i]),t},{}),e}function modify(t,e,i,r){if(this.options.strict&&!this.isEnabled()&&e===Emitter.sources.USER)return new Delta;let o=null==i?null:this.getSelection(),s=this.editor.delta,n=t();if(null!=o&&(!0===i&&(i=o.index),null==r?o=shiftRange(o,n,e):0!==r&&(o=shiftRange(o,i,r,e)),this.setSelection(o,Emitter.sources.SILENT)),n.length()>0){let t=[Emitter.events.TEXT_CHANGE,n,s,e];this.emitter.emit(Emitter.events.EDITOR_CHANGE,...t),e!==Emitter.sources.SILENT&&this.emitter.emit(...t)}return n}function overload(t,e,i,r,o){let s={};return"number"==typeof t.index&&"number"==typeof t.length?"number"!=typeof e?(o=r,r=i,i=e,e=t.length,t=t.index):(e=t.length,t=t.index):"number"!=typeof e&&(o=r,r=i,i=e,e=0),"object"==typeof i?(s=i,o=r):"string"==typeof i&&(null!=r?s[i]=r:o=i),[t,e,s,o=o||Emitter.sources.API]}function shiftRange(t,e,i,r){if(null==t)return null;let o,s;return[o,s]=e instanceof Delta?[t.index,t.index+t.length].map(function(t){return e.transformPosition(t,r!==Emitter.sources.USER)}):[t.index,t.index+t.length].map(function(t){return t<e||t===e&&r===Emitter.sources.USER?t:i>=0?t+i:Math.max(e,t+i)}),new Range(o,s-o)}Quill.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},Quill.events=Emitter.events,Quill.sources=Emitter.sources,Quill.version="undefined"==typeof QUILL_VERSION?"dev":QUILL_VERSION,Quill.imports={delta:Delta,parchment:Parchment,"core/module":Module,"core/theme":Theme};export{expandConfig,overload,Quill as default};
//# sourceMappingURL=/sm/5e2d8b87ae93713e614e3d4bd6b0f8d5f61746796f913e9f7fcbdaed350a561f.map