/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/quill@1.3.7/blots/block.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import extend from"extend";import Delta from"quill-delta";import Parchment from"parchment";import Break from"./break";import Inline from"./inline";import TextBlot from"./text";const NEWLINE_LENGTH=1;class BlockEmbed extends Parchment.Embed{attach(){super.attach(),this.attributes=new Parchment.Attributor.Store(this.domNode)}delta(){return(new Delta).insert(this.value(),extend(this.formats(),this.attributes.values()))}format(t,e){let r=Parchment.query(t,Parchment.Scope.BLOCK_ATTRIBUTE);null!=r&&this.attributes.attribute(r,e)}formatAt(t,e,r,s){this.format(r,s)}insertAt(t,e,r){if("string"==typeof e&&e.endsWith("\n")){let r=Parchment.create(Block.blotName);this.parent.insertBefore(r,0===t?this:this.next),r.insertAt(0,e.slice(0,-1))}else super.insertAt(t,e,r)}}BlockEmbed.scope=Parchment.Scope.BLOCK_BLOT;class Block extends Parchment.Block{constructor(t){super(t),this.cache={}}delta(){return null==this.cache.delta&&(this.cache.delta=this.descendants(Parchment.Leaf).reduce((t,e)=>0===e.length()?t:t.insert(e.value(),bubbleFormats(e)),new Delta).insert("\n",bubbleFormats(this))),this.cache.delta}deleteAt(t,e){super.deleteAt(t,e),this.cache={}}formatAt(t,e,r,s){e<=0||(Parchment.query(r,Parchment.Scope.BLOCK)?t+e===this.length()&&this.format(r,s):super.formatAt(t,Math.min(e,this.length()-t-1),r,s),this.cache={})}insertAt(t,e,r){if(null!=r)return super.insertAt(t,e,r);if(0===e.length)return;let s=e.split("\n"),i=s.shift();i.length>0&&(t<this.length()-1||null==this.children.tail?super.insertAt(Math.min(t,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let n=this;s.reduce(function(t,e){return(n=n.split(t,!0)).insertAt(0,e),e.length},t+i.length)}insertBefore(t,e){let r=this.children.head;super.insertBefore(t,e),r instanceof Break&&r.remove(),this.cache={}}length(){return null==this.cache.length&&(this.cache.length=super.length()+NEWLINE_LENGTH),this.cache.length}moveChildren(t,e){super.moveChildren(t,e),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t,e=!1){if(e&&(0===t||t>=this.length()-NEWLINE_LENGTH)){let e=this.clone();return 0===t?(this.parent.insertBefore(e,this),this):(this.parent.insertBefore(e,this.next),e)}{let r=super.split(t,e);return this.cache={},r}}}function bubbleFormats(t,e={}){return null==t?e:("function"==typeof t.formats&&(e=extend(e,t.formats())),null==t.parent||"scroll"==t.parent.blotName||t.parent.statics.scope!==t.statics.scope?e:bubbleFormats(t.parent,e))}Block.blotName="block",Block.tagName="P",Block.defaultChild="break",Block.allowedChildren=[Inline,Parchment.Embed,TextBlot];export{bubbleFormats,BlockEmbed,Block as default};
//# sourceMappingURL=/sm/d87dfaa2ccdc52df86609610073ce5e46135ff53a4c38a3507ce56807d8db8e5.map