"use strict";
(self["webpackChunkklyk"] = self["webpackChunkklyk"] || []).push([["node_modules_arcgis_core_views_2d_layers_RouteLayerView2D_js"],{

/***/ "./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/RouteLayerView2D.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ I)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Collection.js */ "./node_modules/@arcgis/core/core/Collection.js");
/* harmony import */ var _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/CollectionFlattener.js */ "./node_modules/@arcgis/core/core/CollectionFlattener.js");
/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ "./node_modules/@arcgis/core/core/reactiveUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../rest/support/DirectionLine.js */ "./node_modules/@arcgis/core/rest/support/DirectionLine.js");
/* harmony import */ var _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../rest/support/DirectionPoint.js */ "./node_modules/@arcgis/core/rest/support/DirectionPoint.js");
/* harmony import */ var _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../rest/support/PointBarrier.js */ "./node_modules/@arcgis/core/rest/support/PointBarrier.js");
/* harmony import */ var _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../rest/support/PolygonBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolygonBarrier.js");
/* harmony import */ var _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../rest/support/PolylineBarrier.js */ "./node_modules/@arcgis/core/rest/support/PolylineBarrier.js");
/* harmony import */ var _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../rest/support/RouteInfo.js */ "./node_modules/@arcgis/core/rest/support/RouteInfo.js");
/* harmony import */ var _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../rest/support/Stop.js */ "./node_modules/@arcgis/core/rest/support/Stop.js");
/* harmony import */ var _LayerView2D_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./LayerView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js");
/* harmony import */ var _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./graphics/GraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js");
/* harmony import */ var _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./graphics/GraphicsView2D.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicsView2D.js");
/* harmony import */ var _layers_LayerView_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../layers/LayerView.js */ "./node_modules/@arcgis/core/views/layers/LayerView.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const y=Object.freeze({remove(){},pause(){},resume(){}}),k=["route-info","direction-line","direction-point","polygon-barrier","polyline-barrier","point-barrier","stop"],v={graphic:null,property:null,oldValue:null,newValue:null};function M(t){return t instanceof _rest_support_DirectionLine_js__WEBPACK_IMPORTED_MODULE_9__["default"]||t instanceof _rest_support_DirectionPoint_js__WEBPACK_IMPORTED_MODULE_10__["default"]||t instanceof _rest_support_PointBarrier_js__WEBPACK_IMPORTED_MODULE_11__["default"]||t instanceof _rest_support_PolygonBarrier_js__WEBPACK_IMPORTED_MODULE_12__["default"]||t instanceof _rest_support_PolylineBarrier_js__WEBPACK_IMPORTED_MODULE_13__["default"]||t instanceof _rest_support_RouteInfo_js__WEBPACK_IMPORTED_MODULE_14__["default"]||t instanceof _rest_support_Stop_js__WEBPACK_IMPORTED_MODULE_15__["default"]}function V(t){return _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"].isCollection(t)&&t.length&&M(t.at(0))}function j(t){return Array.isArray(t)&&t.length>0&&M(t[0])}let G=class extends((0,_LayerView2D_js__WEBPACK_IMPORTED_MODULE_16__.LayerView2DMixin)(_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_19__["default"])){constructor(){super(...arguments),this._graphics=new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"],this._highlightIds=new Map,this._networkFeatureMap=new Map,this._networkGraphicMap=new Map}get _routeItems(){return new _core_CollectionFlattener_js__WEBPACK_IMPORTED_MODULE_3__["default"]({getCollections:()=>null==this.layer||this.destroyed?[]:[null!=this.layer.routeInfo?new _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"]([this.layer.routeInfo]):null,this.layer.directionLines,this.layer.directionPoints,this.layer.polygonBarriers,this.layer.polylineBarriers,this.layer.pointBarriers,this.layer.stops]})}initialize(){this.updatingHandles.addOnCollectionChange((()=>this._routeItems),(t=>this._routeItemsChanged(t)),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.initial)}destroy(){this._networkFeatureMap.clear(),this._networkGraphicMap.clear(),this._graphics.removeAll(),this._get("_routeItems")?.destroy()}attach(){this._createGraphicsView()}detach(){this._destroyGraphicsView()}async fetchPopupFeatures(t){return this._graphicsView.hitTest(t).filter((t=>!!t.popupTemplate))}highlight(t){let r;r=M(t)?[this._getNetworkFeatureUid(t)]:j(t)?t.map((t=>this._getNetworkFeatureUid(t))):V(t)?t.map((t=>this._getNetworkFeatureUid(t))).toArray():[t.uid];const i=r.filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome);return i.length?(this._addHighlight(i),{remove:()=>this._removeHighlight(i)}):y}async hitTest(t,r){if(this.suspended)return null;const i=this._graphicsView.hitTest(t).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome).map((t=>this._networkGraphicMap.get(t)));if(!i.length)return null;const{layer:s}=this;return i.reverse().map((e=>({type:"route",layer:s,mapPoint:t,networkFeature:e})))}isUpdating(){return this._graphicsView.updating}moveStart(){}moveEnd(){}update(t){this._graphicsView.processUpdate(t)}viewChange(){this._graphicsView.viewChange()}_addHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e);this._highlightIds.set(e,t+1)}else this._highlightIds.set(e,1);this._updateHighlight()}_createGraphic(t){const e=t.toGraphic();return e.layer=this.layer,e.sourceLayer=this.layer,e}_createGraphicsView(){const t=this.view,e=()=>this.requestUpdate(),r=new _graphics_GraphicContainer_js__WEBPACK_IMPORTED_MODULE_17__["default"](t.featuresTilingScheme);this._graphicsView=new _graphics_GraphicsView2D_js__WEBPACK_IMPORTED_MODULE_18__["default"]({container:r,graphics:this._graphics,requestUpdateCallback:e,view:t}),this.container.addChild(r),this._updateHighlight()}_destroyGraphicsView(){this.container.removeChild(this._graphicsView.container),this._graphicsView.destroy()}_getDrawOrder(t){const e=this._networkGraphicMap.get(t);return k.indexOf(e.type)}_getNetworkFeatureUid(t){return this._networkFeatureMap.has(t)?this._networkFeatureMap.get(t).uid:null}_removeHighlight(t){for(const e of t)if(this._highlightIds.has(e)){const t=this._highlightIds.get(e)-1;0===t?this._highlightIds.delete(e):this._highlightIds.set(e,t)}this._updateHighlight()}_routeItemsChanged(t){if(t.removed.length){this._graphics.removeMany(t.removed.map((t=>{const e=this._networkFeatureMap.get(t);return this._networkFeatureMap.delete(t),this._networkGraphicMap.delete(e),e})));for(const e of t.removed)this.removeHandles(e)}if(t.added.length){this._graphics.addMany(t.added.map((t=>{const e=this._createGraphic(t);return null==e.symbol?null:(this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),e)})).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_1__.isSome));for(const e of t.added)this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>e.geometry),((t,r)=>{this._updateGraphic(e,"geometry",t,r)})),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_4__.watch)((()=>e.symbol),((t,r)=>{this._updateGraphic(e,"symbol",t,r)}))],e);this._graphics.sort(((t,e)=>this._getDrawOrder(t)-this._getDrawOrder(e)))}}_updateGraphic(t,e,r,i){if(!this._networkFeatureMap.has(t)){const e=this._createGraphic(t);return this._networkFeatureMap.set(t,e),this._networkGraphicMap.set(e,t),void this._graphics.add(e)}const s=this._networkFeatureMap.get(t);s[e]=r,v.graphic=s,v.property=e,v.oldValue=i,v.newValue=r,this._graphicsView.graphicUpdateHandler(v)}_updateHighlight(){const t=Array.from(this._highlightIds.keys());this._graphicsView.setHighlight(t)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],G.prototype,"_graphics",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__.property)()],G.prototype,"_routeItems",null),G=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.views.2d.layers.RouteLayerView2D")],G);const I=G;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../engine/webgl/enums.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/enums.js");
/* harmony import */ var _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BaseGraphicContainer.js */ "./node_modules/@arcgis/core/views/2d/layers/graphics/BaseGraphicContainer.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
class i extends _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__["default"]{renderChildren(r){this.attributeView.update(),this.children.some((e=>e.hasData))&&(this.attributeView.bindTextures(r.context,!1),super.renderChildren(r),r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.MAP&&this._renderChildren(r),this.hasHighlight()&&r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(r),this._boundsRenderer&&this._boundsRenderer.doRender(r))}_renderHighlight(e){const{painter:r}=e,i=r.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX3ZpZXdzXzJkX2xheWVyc19Sb3V0ZUxheWVyVmlldzJEX2pzLjIwNGRmYjA1ZTA5YjdmYmZjZjVlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ2lpQyx1QkFBdUIsVUFBVSxVQUFVLFlBQVkscUhBQXFILHdEQUF3RCxjQUFjLG9CQUFvQixzRUFBQyxlQUFlLHdFQUFDLGVBQWUsc0VBQUMsZUFBZSx3RUFBQyxlQUFlLHlFQUFDLGVBQWUsbUVBQUMsZUFBZSw4REFBQyxDQUFDLGNBQWMsT0FBTywyREFBQyx1Q0FBdUMsY0FBYyw2Q0FBNkMsb0JBQW9CLGtFQUFDLENBQUMsNkRBQUMsR0FBRyxjQUFjLHVDQUF1QywyREFBQyw0RkFBNEYsa0JBQWtCLFdBQVcsb0VBQUMsRUFBRSx1RkFBdUYsMkRBQUMscUxBQXFMLEVBQUUsYUFBYSxrR0FBa0csMkRBQUMsRUFBRSxVQUFVLCtIQUErSCxTQUFTLDJCQUEyQixTQUFTLDRCQUE0Qiw0QkFBNEIsb0VBQW9FLGFBQWEsTUFBTSx1SkFBdUosaUJBQWlCLHVEQUFDLEVBQUUsd0NBQXdDLG9DQUFvQyxJQUFJLG1CQUFtQiw4QkFBOEIsNkNBQTZDLHVEQUFDLDJDQUEyQyx5QkFBeUIsTUFBTSxRQUFRLE1BQU0sNkJBQTZCLGlEQUFpRCxJQUFJLGFBQWEsbUNBQW1DLGFBQWEsV0FBVyxVQUFVLG9DQUFvQyxhQUFhLGdDQUFnQyxpQkFBaUIsK0NBQStDLGtDQUFrQyw4QkFBOEIsaUNBQWlDLHdCQUF3QixrQkFBa0Isc0JBQXNCLHFEQUFxRCxzQkFBc0IsbURBQW1ELHNFQUFDLHlCQUF5Qix1QkFBdUIsb0VBQUMsRUFBRSxtRUFBbUUscURBQXFELHVCQUF1QixzRkFBc0YsaUJBQWlCLHVDQUF1Qyx5QkFBeUIseUJBQXlCLDhFQUE4RSxvQkFBb0IsK0NBQStDLG9DQUFvQywrREFBK0Qsd0JBQXdCLHNCQUFzQixxQkFBcUIsNkNBQTZDLHVDQUF1Qyw2RUFBNkUsSUFBSSwrQ0FBK0MsbUJBQW1CLHdDQUF3QywrQkFBK0IsaUdBQWlHLFVBQVUsdURBQUMsR0FBRyx3Q0FBd0MsNkRBQUMsMkJBQTJCLHNDQUFzQyxHQUFHLDZEQUFDLHlCQUF5QixvQ0FBb0MsT0FBTywyRUFBMkUsd0JBQXdCLG9DQUFvQywrQkFBK0Isb0dBQW9HLHVDQUF1QyxxR0FBcUcsbUJBQW1CLDhDQUE4QyxxQ0FBcUMsdURBQUMsRUFBRSxzRkFBQyxvQ0FBb0MsdURBQUMsRUFBRSxzRkFBQyxzQ0FBc0MsdURBQUMsRUFBRSxzRkFBQyw4Q0FBOEMsVUFBK0I7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDSmowSztBQUNBO0FBQ0E7QUFDQTtBQUNvRyxnQkFBZ0IsZ0VBQUMsQ0FBQyxrQkFBa0IscUpBQXFKLGdFQUFDLGlFQUFpRSxnRUFBQyw2RkFBNkYsb0JBQW9CLE1BQU0sVUFBVSx5QkFBeUIsa0VBQXVGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8va2x5ay8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvMmQvbGF5ZXJzL1JvdXRlTGF5ZXJWaWV3MkQuanMiLCJ3ZWJwYWNrOi8va2x5ay8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvMmQvbGF5ZXJzL2dyYXBoaWNzL0dyYXBoaWNDb250YWluZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtfIGFzIHR9ZnJvbVwiLi4vLi4vLi4vY2h1bmtzL3RzbGliLmVzNi5qc1wiO2ltcG9ydHtpc1NvbWUgYXMgZX1mcm9tXCIuLi8uLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnQgciBmcm9tXCIuLi8uLi8uLi9jb3JlL0NvbGxlY3Rpb24uanNcIjtpbXBvcnQgaSBmcm9tXCIuLi8uLi8uLi9jb3JlL0NvbGxlY3Rpb25GbGF0dGVuZXIuanNcIjtpbXBvcnR7aW5pdGlhbCBhcyBzLHdhdGNoIGFzIG99ZnJvbVwiLi4vLi4vLi4vY29yZS9yZWFjdGl2ZVV0aWxzLmpzXCI7aW1wb3J0e3Byb3BlcnR5IGFzIGF9ZnJvbVwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9wcm9wZXJ0eS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZW5zdXJlVHlwZS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vY29yZS9oYXMuanNcIjtpbXBvcnR7c3ViY2xhc3MgYXMgaH1mcm9tXCIuLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3N1YmNsYXNzLmpzXCI7aW1wb3J0IG4gZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L0RpcmVjdGlvbkxpbmUuanNcIjtpbXBvcnQgcCBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvRGlyZWN0aW9uUG9pbnQuanNcIjtpbXBvcnQgbCBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvUG9pbnRCYXJyaWVyLmpzXCI7aW1wb3J0IGMgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L1BvbHlnb25CYXJyaWVyLmpzXCI7aW1wb3J0IGcgZnJvbVwiLi4vLi4vLi4vcmVzdC9zdXBwb3J0L1BvbHlsaW5lQmFycmllci5qc1wiO2ltcG9ydCB1IGZyb21cIi4uLy4uLy4uL3Jlc3Qvc3VwcG9ydC9Sb3V0ZUluZm8uanNcIjtpbXBvcnQgZCBmcm9tXCIuLi8uLi8uLi9yZXN0L3N1cHBvcnQvU3RvcC5qc1wiO2ltcG9ydHtMYXllclZpZXcyRE1peGluIGFzIF99ZnJvbVwiLi9MYXllclZpZXcyRC5qc1wiO2ltcG9ydCBtIGZyb21cIi4vZ3JhcGhpY3MvR3JhcGhpY0NvbnRhaW5lci5qc1wiO2ltcG9ydCB3IGZyb21cIi4vZ3JhcGhpY3MvR3JhcGhpY3NWaWV3MkQuanNcIjtpbXBvcnQgZiBmcm9tXCIuLi8uLi9sYXllcnMvTGF5ZXJWaWV3LmpzXCI7Y29uc3QgeT1PYmplY3QuZnJlZXplKHtyZW1vdmUoKXt9LHBhdXNlKCl7fSxyZXN1bWUoKXt9fSksaz1bXCJyb3V0ZS1pbmZvXCIsXCJkaXJlY3Rpb24tbGluZVwiLFwiZGlyZWN0aW9uLXBvaW50XCIsXCJwb2x5Z29uLWJhcnJpZXJcIixcInBvbHlsaW5lLWJhcnJpZXJcIixcInBvaW50LWJhcnJpZXJcIixcInN0b3BcIl0sdj17Z3JhcGhpYzpudWxsLHByb3BlcnR5Om51bGwsb2xkVmFsdWU6bnVsbCxuZXdWYWx1ZTpudWxsfTtmdW5jdGlvbiBNKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygbnx8dCBpbnN0YW5jZW9mIHB8fHQgaW5zdGFuY2VvZiBsfHx0IGluc3RhbmNlb2YgY3x8dCBpbnN0YW5jZW9mIGd8fHQgaW5zdGFuY2VvZiB1fHx0IGluc3RhbmNlb2YgZH1mdW5jdGlvbiBWKHQpe3JldHVybiByLmlzQ29sbGVjdGlvbih0KSYmdC5sZW5ndGgmJk0odC5hdCgwKSl9ZnVuY3Rpb24gaih0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KSYmdC5sZW5ndGg+MCYmTSh0WzBdKX1sZXQgRz1jbGFzcyBleHRlbmRzKF8oZikpe2NvbnN0cnVjdG9yKCl7c3VwZXIoLi4uYXJndW1lbnRzKSx0aGlzLl9ncmFwaGljcz1uZXcgcix0aGlzLl9oaWdobGlnaHRJZHM9bmV3IE1hcCx0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcD1uZXcgTWFwLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwPW5ldyBNYXB9Z2V0IF9yb3V0ZUl0ZW1zKCl7cmV0dXJuIG5ldyBpKHtnZXRDb2xsZWN0aW9uczooKT0+bnVsbD09dGhpcy5sYXllcnx8dGhpcy5kZXN0cm95ZWQ/W106W251bGwhPXRoaXMubGF5ZXIucm91dGVJbmZvP25ldyByKFt0aGlzLmxheWVyLnJvdXRlSW5mb10pOm51bGwsdGhpcy5sYXllci5kaXJlY3Rpb25MaW5lcyx0aGlzLmxheWVyLmRpcmVjdGlvblBvaW50cyx0aGlzLmxheWVyLnBvbHlnb25CYXJyaWVycyx0aGlzLmxheWVyLnBvbHlsaW5lQmFycmllcnMsdGhpcy5sYXllci5wb2ludEJhcnJpZXJzLHRoaXMubGF5ZXIuc3RvcHNdfSl9aW5pdGlhbGl6ZSgpe3RoaXMudXBkYXRpbmdIYW5kbGVzLmFkZE9uQ29sbGVjdGlvbkNoYW5nZSgoKCk9PnRoaXMuX3JvdXRlSXRlbXMpLCh0PT50aGlzLl9yb3V0ZUl0ZW1zQ2hhbmdlZCh0KSkscyl9ZGVzdHJveSgpe3RoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmNsZWFyKCksdGhpcy5fbmV0d29ya0dyYXBoaWNNYXAuY2xlYXIoKSx0aGlzLl9ncmFwaGljcy5yZW1vdmVBbGwoKSx0aGlzLl9nZXQoXCJfcm91dGVJdGVtc1wiKT8uZGVzdHJveSgpfWF0dGFjaCgpe3RoaXMuX2NyZWF0ZUdyYXBoaWNzVmlldygpfWRldGFjaCgpe3RoaXMuX2Rlc3Ryb3lHcmFwaGljc1ZpZXcoKX1hc3luYyBmZXRjaFBvcHVwRmVhdHVyZXModCl7cmV0dXJuIHRoaXMuX2dyYXBoaWNzVmlldy5oaXRUZXN0KHQpLmZpbHRlcigodD0+ISF0LnBvcHVwVGVtcGxhdGUpKX1oaWdobGlnaHQodCl7bGV0IHI7cj1NKHQpP1t0aGlzLl9nZXROZXR3b3JrRmVhdHVyZVVpZCh0KV06aih0KT90Lm1hcCgodD0+dGhpcy5fZ2V0TmV0d29ya0ZlYXR1cmVVaWQodCkpKTpWKHQpP3QubWFwKCh0PT50aGlzLl9nZXROZXR3b3JrRmVhdHVyZVVpZCh0KSkpLnRvQXJyYXkoKTpbdC51aWRdO2NvbnN0IGk9ci5maWx0ZXIoZSk7cmV0dXJuIGkubGVuZ3RoPyh0aGlzLl9hZGRIaWdobGlnaHQoaSkse3JlbW92ZTooKT0+dGhpcy5fcmVtb3ZlSGlnaGxpZ2h0KGkpfSk6eX1hc3luYyBoaXRUZXN0KHQscil7aWYodGhpcy5zdXNwZW5kZWQpcmV0dXJuIG51bGw7Y29uc3QgaT10aGlzLl9ncmFwaGljc1ZpZXcuaGl0VGVzdCh0KS5maWx0ZXIoZSkubWFwKCh0PT50aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5nZXQodCkpKTtpZighaS5sZW5ndGgpcmV0dXJuIG51bGw7Y29uc3R7bGF5ZXI6c309dGhpcztyZXR1cm4gaS5yZXZlcnNlKCkubWFwKChlPT4oe3R5cGU6XCJyb3V0ZVwiLGxheWVyOnMsbWFwUG9pbnQ6dCxuZXR3b3JrRmVhdHVyZTplfSkpKX1pc1VwZGF0aW5nKCl7cmV0dXJuIHRoaXMuX2dyYXBoaWNzVmlldy51cGRhdGluZ31tb3ZlU3RhcnQoKXt9bW92ZUVuZCgpe311cGRhdGUodCl7dGhpcy5fZ3JhcGhpY3NWaWV3LnByb2Nlc3NVcGRhdGUodCl9dmlld0NoYW5nZSgpe3RoaXMuX2dyYXBoaWNzVmlldy52aWV3Q2hhbmdlKCl9X2FkZEhpZ2hsaWdodCh0KXtmb3IoY29uc3QgZSBvZiB0KWlmKHRoaXMuX2hpZ2hsaWdodElkcy5oYXMoZSkpe2NvbnN0IHQ9dGhpcy5faGlnaGxpZ2h0SWRzLmdldChlKTt0aGlzLl9oaWdobGlnaHRJZHMuc2V0KGUsdCsxKX1lbHNlIHRoaXMuX2hpZ2hsaWdodElkcy5zZXQoZSwxKTt0aGlzLl91cGRhdGVIaWdobGlnaHQoKX1fY3JlYXRlR3JhcGhpYyh0KXtjb25zdCBlPXQudG9HcmFwaGljKCk7cmV0dXJuIGUubGF5ZXI9dGhpcy5sYXllcixlLnNvdXJjZUxheWVyPXRoaXMubGF5ZXIsZX1fY3JlYXRlR3JhcGhpY3NWaWV3KCl7Y29uc3QgdD10aGlzLnZpZXcsZT0oKT0+dGhpcy5yZXF1ZXN0VXBkYXRlKCkscj1uZXcgbSh0LmZlYXR1cmVzVGlsaW5nU2NoZW1lKTt0aGlzLl9ncmFwaGljc1ZpZXc9bmV3IHcoe2NvbnRhaW5lcjpyLGdyYXBoaWNzOnRoaXMuX2dyYXBoaWNzLHJlcXVlc3RVcGRhdGVDYWxsYmFjazplLHZpZXc6dH0pLHRoaXMuY29udGFpbmVyLmFkZENoaWxkKHIpLHRoaXMuX3VwZGF0ZUhpZ2hsaWdodCgpfV9kZXN0cm95R3JhcGhpY3NWaWV3KCl7dGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5fZ3JhcGhpY3NWaWV3LmNvbnRhaW5lciksdGhpcy5fZ3JhcGhpY3NWaWV3LmRlc3Ryb3koKX1fZ2V0RHJhd09yZGVyKHQpe2NvbnN0IGU9dGhpcy5fbmV0d29ya0dyYXBoaWNNYXAuZ2V0KHQpO3JldHVybiBrLmluZGV4T2YoZS50eXBlKX1fZ2V0TmV0d29ya0ZlYXR1cmVVaWQodCl7cmV0dXJuIHRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmhhcyh0KT90aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5nZXQodCkudWlkOm51bGx9X3JlbW92ZUhpZ2hsaWdodCh0KXtmb3IoY29uc3QgZSBvZiB0KWlmKHRoaXMuX2hpZ2hsaWdodElkcy5oYXMoZSkpe2NvbnN0IHQ9dGhpcy5faGlnaGxpZ2h0SWRzLmdldChlKS0xOzA9PT10P3RoaXMuX2hpZ2hsaWdodElkcy5kZWxldGUoZSk6dGhpcy5faGlnaGxpZ2h0SWRzLnNldChlLHQpfXRoaXMuX3VwZGF0ZUhpZ2hsaWdodCgpfV9yb3V0ZUl0ZW1zQ2hhbmdlZCh0KXtpZih0LnJlbW92ZWQubGVuZ3RoKXt0aGlzLl9ncmFwaGljcy5yZW1vdmVNYW55KHQucmVtb3ZlZC5tYXAoKHQ9Pntjb25zdCBlPXRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmdldCh0KTtyZXR1cm4gdGhpcy5fbmV0d29ya0ZlYXR1cmVNYXAuZGVsZXRlKHQpLHRoaXMuX25ldHdvcmtHcmFwaGljTWFwLmRlbGV0ZShlKSxlfSkpKTtmb3IoY29uc3QgZSBvZiB0LnJlbW92ZWQpdGhpcy5yZW1vdmVIYW5kbGVzKGUpfWlmKHQuYWRkZWQubGVuZ3RoKXt0aGlzLl9ncmFwaGljcy5hZGRNYW55KHQuYWRkZWQubWFwKCh0PT57Y29uc3QgZT10aGlzLl9jcmVhdGVHcmFwaGljKHQpO3JldHVybiBudWxsPT1lLnN5bWJvbD9udWxsOih0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5zZXQodCxlKSx0aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5zZXQoZSx0KSxlKX0pKS5maWx0ZXIoZSkpO2Zvcihjb25zdCBlIG9mIHQuYWRkZWQpdGhpcy5hZGRIYW5kbGVzKFtvKCgoKT0+ZS5nZW9tZXRyeSksKCh0LHIpPT57dGhpcy5fdXBkYXRlR3JhcGhpYyhlLFwiZ2VvbWV0cnlcIix0LHIpfSkpLG8oKCgpPT5lLnN5bWJvbCksKCh0LHIpPT57dGhpcy5fdXBkYXRlR3JhcGhpYyhlLFwic3ltYm9sXCIsdCxyKX0pKV0sZSk7dGhpcy5fZ3JhcGhpY3Muc29ydCgoKHQsZSk9PnRoaXMuX2dldERyYXdPcmRlcih0KS10aGlzLl9nZXREcmF3T3JkZXIoZSkpKX19X3VwZGF0ZUdyYXBoaWModCxlLHIsaSl7aWYoIXRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmhhcyh0KSl7Y29uc3QgZT10aGlzLl9jcmVhdGVHcmFwaGljKHQpO3JldHVybiB0aGlzLl9uZXR3b3JrRmVhdHVyZU1hcC5zZXQodCxlKSx0aGlzLl9uZXR3b3JrR3JhcGhpY01hcC5zZXQoZSx0KSx2b2lkIHRoaXMuX2dyYXBoaWNzLmFkZChlKX1jb25zdCBzPXRoaXMuX25ldHdvcmtGZWF0dXJlTWFwLmdldCh0KTtzW2VdPXIsdi5ncmFwaGljPXMsdi5wcm9wZXJ0eT1lLHYub2xkVmFsdWU9aSx2Lm5ld1ZhbHVlPXIsdGhpcy5fZ3JhcGhpY3NWaWV3LmdyYXBoaWNVcGRhdGVIYW5kbGVyKHYpfV91cGRhdGVIaWdobGlnaHQoKXtjb25zdCB0PUFycmF5LmZyb20odGhpcy5faGlnaGxpZ2h0SWRzLmtleXMoKSk7dGhpcy5fZ3JhcGhpY3NWaWV3LnNldEhpZ2hsaWdodCh0KX19O3QoW2EoKV0sRy5wcm90b3R5cGUsXCJfZ3JhcGhpY3NcIix2b2lkIDApLHQoW2EoKV0sRy5wcm90b3R5cGUsXCJfcm91dGVJdGVtc1wiLG51bGwpLEc9dChbaChcImVzcmkudmlld3MuMmQubGF5ZXJzLlJvdXRlTGF5ZXJWaWV3MkRcIildLEcpO2NvbnN0IEk9RztleHBvcnR7SSBhcyBkZWZhdWx0fTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI3L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7V0dMRHJhd1BoYXNlIGFzIGV9ZnJvbVwiLi4vLi4vZW5naW5lL3dlYmdsL2VudW1zLmpzXCI7aW1wb3J0IHIgZnJvbVwiLi9CYXNlR3JhcGhpY0NvbnRhaW5lci5qc1wiO2NsYXNzIGkgZXh0ZW5kcyBye3JlbmRlckNoaWxkcmVuKHIpe3RoaXMuYXR0cmlidXRlVmlldy51cGRhdGUoKSx0aGlzLmNoaWxkcmVuLnNvbWUoKGU9PmUuaGFzRGF0YSkpJiYodGhpcy5hdHRyaWJ1dGVWaWV3LmJpbmRUZXh0dXJlcyhyLmNvbnRleHQsITEpLHN1cGVyLnJlbmRlckNoaWxkcmVuKHIpLHIuZHJhd1BoYXNlPT09ZS5NQVAmJnRoaXMuX3JlbmRlckNoaWxkcmVuKHIpLHRoaXMuaGFzSGlnaGxpZ2h0KCkmJnIuZHJhd1BoYXNlPT09ZS5ISUdITElHSFQmJnRoaXMuX3JlbmRlckhpZ2hsaWdodChyKSx0aGlzLl9ib3VuZHNSZW5kZXJlciYmdGhpcy5fYm91bmRzUmVuZGVyZXIuZG9SZW5kZXIocikpfV9yZW5kZXJIaWdobGlnaHQoZSl7Y29uc3R7cGFpbnRlcjpyfT1lLGk9ci5lZmZlY3RzLmhpZ2hsaWdodDtpLmJpbmQoZSksdGhpcy5fcmVuZGVyQ2hpbGRyZW4oZSxpLmRlZmluZXMpLGkuZHJhdyhlKSxpLnVuYmluZCgpfX1leHBvcnR7aSBhcyBkZWZhdWx0fTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==