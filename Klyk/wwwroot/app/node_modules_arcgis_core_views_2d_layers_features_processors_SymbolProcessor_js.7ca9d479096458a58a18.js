"use strict";
(self["webpackChunkklyk"] = self["webpackChunkklyk"] || []).push([["node_modules_arcgis_core_views_2d_layers_features_processors_SymbolProcessor_js"],{

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_HandleOwner_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/HandleOwner.js */ "./node_modules/@arcgis/core/core/HandleOwner.js");
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/property.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
let s=class extends _core_HandleOwner_js__WEBPACK_IMPORTED_MODULE_1__.HandleOwner{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({readOnly:!0})],s.prototype,"supportsTileUpdates",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"remoteClient",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"service",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)()],s.prototype,"spatialReference",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"tileInfo",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.property)({constructOnly:!0})],s.prototype,"tileStore",void 0),s=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)("esri.views.2d.layers.features.processors.BaseProcessor")],s);const p=s;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/processors/SymbolProcessor.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processors/SymbolProcessor.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ I)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ "./node_modules/@arcgis/core/chunks/tslib.es6.js");
/* harmony import */ var _core_BidiText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/BidiText.js */ "./node_modules/@arcgis/core/core/BidiText.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/has.js */ "./node_modules/@arcgis/core/core/has.js");
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/Logger.js */ "./node_modules/@arcgis/core/core/Logger.js");
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/maybe.js */ "./node_modules/@arcgis/core/core/maybe.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../../core/accessorSupport/ensureType.js */ "./node_modules/@arcgis/core/core/accessorSupport/ensureType.js");
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../../core/arrayUtils.js */ "./node_modules/@arcgis/core/core/arrayUtils.js");
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ "./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js");
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../../core/accessorSupport/diffUtils.js */ "./node_modules/@arcgis/core/core/accessorSupport/diffUtils.js");
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../../geometry/SpatialReference.js */ "./node_modules/@arcgis/core/geometry/SpatialReference.js");
/* harmony import */ var _engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../engine/webgl/DisplayId.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/DisplayId.js");
/* harmony import */ var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../engine/webgl/enums.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/enums.js");
/* harmony import */ var _engine_webgl_mesh_MeshData_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../engine/webgl/mesh/MeshData.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/MeshData.js");
/* harmony import */ var _engine_webgl_mesh_factories_WGLMeshFactory_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../engine/webgl/mesh/factories/WGLMeshFactory.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/factories/WGLMeshFactory.js");
/* harmony import */ var _engine_webgl_mesh_templates_WGLTemplateStore_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../engine/webgl/mesh/templates/WGLTemplateStore.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLTemplateStore.js");
/* harmony import */ var _engine_webgl_util_Matcher_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../engine/webgl/util/Matcher.js */ "./node_modules/@arcgis/core/views/2d/engine/webgl/util/Matcher.js");
/* harmony import */ var _textUtils_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../textUtils.js */ "./node_modules/@arcgis/core/views/2d/layers/features/textUtils.js");
/* harmony import */ var _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./BaseProcessor.js */ "./node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js");
/* harmony import */ var _support_ResourceManagerProxy_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../support/ResourceManagerProxy.js */ "./node_modules/@arcgis/core/views/2d/layers/features/support/ResourceManagerProxy.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function b(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}function S(e){const t=e.message,r={message:{data:{},tileKey:t.tileKey,tileKeyOrigin:t.tileKeyOrigin,version:t.version},transferList:new Array};for(const i in t.data){const e=i,a=t.data[e];if(r.message.data[e]=null,null!=a){const t=a.stride,i=a.indices.slice(0),o=a.vertices.slice(0),n=a.records.slice(0),l={stride:t,indices:i,vertices:o,records:n,metrics:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.applySome)(a.metrics,(e=>e.slice(0)))};r.transferList.push(i,o,n),r.message.data[e]=l}}return r}let w=class extends _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_19__["default"]{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map,this._bufferIds=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._resourceManagerProxy=new _support_ResourceManagerProxy_js__WEBPACK_IMPORTED_MODULE_20__["default"](this.remoteClient)}destroy(){this._resourceManagerProxy.destroy()}get supportsTileUpdates(){return!0}forEachBufferId(e){this._bufferIds.forEach((t=>{t.forEach(e)}))}async update(e,t){const s=t.schema.processors[0];if("symbol"!==s.type)return;const r=(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_10__.diff)(this._schema,s);((0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_10__.hasDiff)(r,"mesh")||(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_10__.hasDiff)(r,"target"))&&(e.mesh=!0,e.why?.mesh.push("Symbology changed"),this._schema=s,this._factory=this._createFactory(s),this._factory.update(s,this.tileStore.tileScheme.tileInfo))}onTileMessage(e,t,s,r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(r),this._onTileData(e,t,s,r)}onTileClear(e,t){const s={clear:!0,end:t};return this._bufferData.delete(e.key.id),this._bufferIds.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:s})}onTileError(e,t,s){const r=s.signal,i={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",i,{signal:r})}onTileUpdate(e){for(const t of e.removed)this._bufferData.has(t.key.id)&&this._bufferData.delete(t.key.id),this._bufferIds.has(t.key.id)&&this._bufferIds.delete(t.key.id);for(const t of e.added)this._bufferData.forEach((e=>{for(const s of e)s.message.tileKey===t.id&&this._updateTileMesh("append",t,S(s),[],!1,!1,null)}))}_addBufferData(e,t){this._bufferData.has(e)||this._bufferData.set(e,[]),this._bufferData.get(e)?.push(S(t))}_createFactory(e){const{geometryType:t,objectIdField:r,fields:i}=this.service,a=(e,t)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",e,t),o={geometryType:t,fields:i,spatialReference:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__["default"].fromJSON(this.spatialReference)},n=new _engine_webgl_mesh_templates_WGLTemplateStore_js__WEBPACK_IMPORTED_MODULE_16__.WGLTemplateStore(a,this.tileStore.tileScheme.tileInfo),{matcher:l,aggregateMatcher:d}=e.mesh;return this._store=n,this._matchers.feature=(0,_engine_webgl_util_Matcher_js__WEBPACK_IMPORTED_MODULE_17__.createMatcher)(l,n,o,this._resourceManagerProxy),this._matchers.aggregate=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.applySome)(d,(e=>(0,_engine_webgl_util_Matcher_js__WEBPACK_IMPORTED_MODULE_17__.createMatcher)(e,n,o,this._resourceManagerProxy))),new _engine_webgl_mesh_factories_WGLMeshFactory_js__WEBPACK_IMPORTED_MODULE_15__.WGLMeshFactory(t,r,n)}async _onTileData(e,t,s,r){(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(r);const{type:a,addOrUpdate:o,remove:n,clear:l,end:c}=t,d=!!this._schema.mesh.sortKey;if(!o){const t={type:a,addOrUpdate:null,remove:n,clear:l,end:c,sort:d};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t},r)}const h=this._processFeatures(e,o,s,r,t.status?.version);try{const s=await h;if(null==s){const t={type:a,addOrUpdate:null,remove:n,clear:l,end:c,sort:d};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t},r)}const i=[];for(const t of s){let s=!1;const r=t.message.bufferIds,a=e.key.id,o=t.message.tileKey;if(a!==o&&null!=r){if(!this.tileStore.get(o)){this._addBufferData(a,t),i.push(t);continue}let e=this._bufferIds.get(o);e||(e=new Set,this._bufferIds.set(o,e));const n=Array.from(r);for(const t of n){if(e.has(t)){s=!0;break}e.add(t)}}s||(this._addBufferData(a,t),i.push(t))}await Promise.all(i.map((s=>{const i=e.key.id===s.message.tileKey,o=i?t.remove:[],n=i&&t.end;return this._updateTileMesh(a,e,s,o,n,!!t.clear,r.signal)})))}catch(f){this._handleError(e,f,r)}}async _updateTileMesh(e,t,r,a,o,n,l){const c=e,d=r.message.tileKey,h=!!this._schema.mesh.sortKey;d!==t.key.id&&(o=!1);const f={type:c,addOrUpdate:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.applySome)(r,(e=>e.message)),remove:a,clear:n,end:o,sort:h},u={transferList:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.applySome)(r,(e=>e.transferList))||[]||0,signal:l};return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(u),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:d,data:f},u)}async _processFeatures(e,t,s,r,a){if(null==t||!t.hasFeatures)return null;const o={transform:e.transform,hasZ:!1,hasM:!1},n=this._factory,l={viewingMode:"",scale:e.scale},c=await this._matchers.feature,d=await this._matchers.aggregate;(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(r);const h=this._getLabelInfos(e,t);return await n.analyze(t.getCursor(),this._resourceManagerProxy,c,d,o,l),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.throwIfAborted)(r),this._writeFeatureSet(e,t,o,h,n,s,a)}_writeFeatureSet(e,t,s,r,i,a,o){const n=t.getSize(),l=this._schema.mesh.matcher.symbologyType,c=new _engine_webgl_mesh_MeshData_js__WEBPACK_IMPORTED_MODULE_14__.MeshData(e.key.id,{features:n,records:n,metrics:0},l,a,l!==_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_13__.WGLSymbologyType.HEATMAP,o),d={viewingMode:"",scale:e.scale},u=t.getCursor();for(;u.next();)try{const t=u.getDisplayId(),a=null!=r?r.get(t):null;i.writeCursor(c,u,s,d,e.level,a,this._resourceManagerProxy)}catch(g){}const m=e.tileInfoView.tileInfo.isWrappable;return c.serialize(m)}_handleError(e,t,s){if(!(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.isAbortError)(t)){const r={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",r,{signal:s.signal})}return Promise.resolve()}_getLabelingSchemaForScale(e){const t=this._schema.mesh.labels;if(null==t)return null;if("subtype"===t.type){const s={type:"subtype",classes:{}};let r=!1;for(const i in t.classes){const a=t.classes[i].filter((t=>b(t,e.scale)));r=r||!!a.length,s.classes[i]=a}return r?s:null}const s=t.classes.filter((t=>b(t,e.scale)));return s.length?{type:"simple",classes:s}:null}_getLabels(e,t){if("subtype"===t.type){const s=this.service.subtypeField,i=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.unwrapOrThrow)(s,"Expected to find subtype Field"),a=e.readAttribute(i);return null==a?[]:t.classes[a]??[]}return t.classes}_getLabelInfos(e,s){const r=this._getLabelingSchemaForScale(e);if(null==r)return null;const i=new Map,a=s.getCursor();for(;a.next();){const e=a.getDisplayId(),s=[],o=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_12__.isAggregateId)(e),n=o&&1!==a.readAttribute("cluster_count")?"aggregate":"feature",l=this._getLabels(a,r);for(const r of l){if(r.target!==n)continue;const i=a.getStorage(),l=o&&"feature"===n?i.getComputedStringAtIndex(a.readAttribute("referenceId"),r.fieldIndex):i.getComputedStringAtIndex(e,r.fieldIndex);if(!l)continue;const c=(0,_core_BidiText_js__WEBPACK_IMPORTED_MODULE_1__.bidiText)(l.toString()),d=c[0],h=c[1];this._store.getMosaicItem(r.symbol,(0,_textUtils_js__WEBPACK_IMPORTED_MODULE_18__.codepoints)(d)).then((e=>{s[r.index]={glyphs:e.glyphMosaicItems??[],rtl:h,index:r.index}}))}i.set(e,s)}return i}};w=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__.subclass)("esri.views.2d.layers.features.processors.SymbolProcessor")],w);const I=w;


/***/ }),

/***/ "./node_modules/@arcgis/core/views/2d/layers/features/support/ResourceManagerProxy.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/ResourceManagerProxy.js ***!
  \********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ t)
/* harmony export */ });
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
class t{constructor(e){this._remoteClient=e,this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){}async fetchResource(t,r){const s=this._resourceMap,i=s.get(t);if(i)return i;let n=this._inFlightResourceMap.get(t);if(n)return n;try{n=this._remoteClient.invoke("tileRenderer.fetchResource",{url:t},{...r}),this._inFlightResourceMap.set(t,n),n.then((e=>(this._inFlightResourceMap.delete(t),s.set(t,e),e)))}catch(o){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.isAbortError)(o)?null:{width:0,height:0}}return n}getResource(e){return this._resourceMap.get(e)??null}loadFont(e){return Promise.resolve(null)}}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX3ZpZXdzXzJkX2xheWVyc19mZWF0dXJlc19wcm9jZXNzb3JzX1N5bWJvbFByb2Nlc3Nvcl9qcy43Y2E5ZDQ3OTA5NjQ1OGE1OGExOC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzJhLG9CQUFvQiw2REFBQyxDQUFDLGNBQWMsV0FBVywwQkFBMEIsU0FBUyx1QkFBdUIsMERBQTBELDZCQUE2Qix1REFBQyxFQUFFLHNGQUFDLEVBQUUsWUFBWSwyQ0FBMkMsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQixzQ0FBc0MsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQixpQ0FBaUMsdURBQUMsRUFBRSxzRkFBQyx5Q0FBeUMsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQixrQ0FBa0MsdURBQUMsRUFBRSxzRkFBQyxFQUFFLGlCQUFpQixxQ0FBcUMsdURBQUMsRUFBRSxzRkFBQywrREFBK0QsVUFBK0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0pqaUM7QUFDQTtBQUNBO0FBQ0E7QUFDK3dDLGdCQUFnQixpRUFBaUUsY0FBYyxxQkFBcUIsU0FBUyxPQUFPLG1FQUFtRSx5QkFBeUIsdUJBQXVCLHNCQUFzQixtQ0FBbUMsb0ZBQW9GLGdEQUFnRCx5REFBQyw2QkFBNkIsZ0RBQWdELFNBQVMsb0JBQW9CLDBEQUFDLENBQUMsY0FBYyx1REFBdUQsNEJBQTRCLGtEQUFrRCxhQUFhLDRHQUE0Ryx5RUFBQyxvQkFBb0IsVUFBVSxxQ0FBcUMsMEJBQTBCLFNBQVMsbUJBQW1CLDZCQUE2QixhQUFhLEdBQUcsa0JBQWtCLCtCQUErQiw0QkFBNEIsUUFBUSx5RUFBQyxpQkFBaUIsQ0FBQyw0RUFBQyxZQUFZLDRFQUFDLGdMQUFnTCx1QkFBdUIsT0FBTyxxRUFBQyw4QkFBOEIsaUJBQWlCLFNBQVMsZ0JBQWdCLDhIQUE4SCxvQkFBb0IsRUFBRSxtQkFBbUIsb0JBQW9CLHNCQUFzQiw4REFBOEQsU0FBUyxFQUFFLGdCQUFnQiwySkFBMkoscURBQXFELCtGQUErRixHQUFHLG9CQUFvQix3RkFBd0Ysa0JBQWtCLE1BQU0sd0NBQXdDLHdGQUF3Rix5Q0FBeUMsc0VBQUMsaUNBQWlDLE9BQU8sK0ZBQUMsd0NBQXdDLDZCQUE2QixRQUFRLDRDQUE0Qyw2RUFBQyw0REFBNEQseURBQUMsT0FBTyw2RUFBQyx5Q0FBeUMsMkZBQUMsUUFBUSwyQkFBMkIscUVBQUMsSUFBSSxNQUFNLDRDQUE0QyxpQ0FBaUMsT0FBTyxTQUFTLHVEQUF1RCwyREFBMkQsb0JBQW9CLElBQUkseURBQXlELElBQUksZ0JBQWdCLFlBQVksU0FBUyx1REFBdUQsMkRBQTJELG9CQUFvQixJQUFJLFdBQVcsa0JBQWtCLFNBQVMsMkRBQTJELG1CQUFtQiwyQkFBMkIsbUNBQW1DLFNBQVMsNkJBQTZCLHdDQUF3QyxzQkFBc0Isa0JBQWtCLGFBQWEsS0FBSyxNQUFNLFVBQVUsd0NBQXdDLDZCQUE2QixnRUFBZ0UsMERBQTBELElBQUksU0FBUywwQkFBMEIscUNBQXFDLDREQUE0RCxxQkFBcUIsU0FBUyxtQkFBbUIseURBQUMsaURBQWlELElBQUksYUFBYSx5REFBQyw2QkFBNkIsQ0FBRSxXQUFXLE9BQU8scUVBQUMsd0RBQXdELGlCQUFpQixJQUFJLGtDQUFrQyx1Q0FBdUMsU0FBUyxzQ0FBc0Msb0JBQW9CLDZCQUE2QixpRUFBaUUscUVBQUMsSUFBSSxpQ0FBaUMseUVBQXlFLHFFQUFDLHlDQUF5QyxnQ0FBZ0Msb0VBQW9FLHFFQUFDLFdBQVcsK0JBQStCLFNBQVMscUVBQUMsZUFBZSw2QkFBNkIsaUJBQWlCLEtBQUssU0FBUyxLQUFLLGlEQUFpRCw0REFBNEQsVUFBVSw0Q0FBNEMsc0JBQXNCLG9CQUFvQixJQUFJLG1FQUFDLEtBQUssU0FBUyw4QkFBOEIsOERBQThELGdCQUFnQixFQUFFLHlCQUF5Qiw4QkFBOEIsaUNBQWlDLHVCQUF1Qix1QkFBdUIsU0FBUywyQkFBMkIsU0FBUywwQkFBMEIsK0NBQStDLCtCQUErQixnQkFBZ0IsNENBQTRDLGlCQUFpQix3QkFBd0IsTUFBTSxnQkFBZ0IsdUJBQXVCLG9DQUFvQyw2REFBQywwREFBMEQsbUNBQW1DLGlCQUFpQixvQkFBb0IsMkNBQTJDLHVCQUF1QixnQ0FBZ0MsS0FBSyxTQUFTLEVBQUUsZ0NBQWdDLDBFQUFDLDJGQUEyRixrQkFBa0IseUJBQXlCLDZKQUE2SixlQUFlLFFBQVEsMkRBQUMsNkJBQTZCLG1DQUFtQywwREFBQyxlQUFlLFlBQVksbURBQW1ELEdBQUcsV0FBVyxXQUFXLEVBQUUsdURBQUMsRUFBRSxzRkFBQyxpRUFBaUUsVUFBK0I7Ozs7Ozs7Ozs7Ozs7Ozs7QUNKNTNPO0FBQ0E7QUFDQTtBQUNBO0FBQ21FLFFBQVEsZUFBZSwwSUFBMEksV0FBVyx5QkFBeUIscUNBQXFDLGNBQWMsdUNBQXVDLGNBQWMsSUFBSSwwREFBMEQsTUFBTSxFQUFFLEtBQUsscUdBQXFHLFNBQVMsT0FBTyxtRUFBQyxVQUFVLGtCQUFrQixTQUFTLGVBQWUsc0NBQXNDLFlBQVksOEJBQW1EIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8va2x5ay8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvMmQvbGF5ZXJzL2ZlYXR1cmVzL3Byb2Nlc3NvcnMvQmFzZVByb2Nlc3Nvci5qcyIsIndlYnBhY2s6Ly9rbHlrLy4vbm9kZV9tb2R1bGVzL0BhcmNnaXMvY29yZS92aWV3cy8yZC9sYXllcnMvZmVhdHVyZXMvcHJvY2Vzc29ycy9TeW1ib2xQcm9jZXNzb3IuanMiLCJ3ZWJwYWNrOi8va2x5ay8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvdmlld3MvMmQvbGF5ZXJzL2ZlYXR1cmVzL3N1cHBvcnQvUmVzb3VyY2VNYW5hZ2VyUHJveHkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtfIGFzIGV9ZnJvbVwiLi4vLi4vLi4vLi4vLi4vY2h1bmtzL3RzbGliLmVzNi5qc1wiO2ltcG9ydHtIYW5kbGVPd25lciBhcyByfWZyb21cIi4uLy4uLy4uLy4uLy4uL2NvcmUvSGFuZGxlT3duZXIuanNcIjtpbXBvcnR7cHJvcGVydHkgYXMgdH1mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9kZWNvcmF0b3JzL3Byb3BlcnR5LmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FjY2Vzc29yU3VwcG9ydC9lbnN1cmVUeXBlLmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL2FycmF5VXRpbHMuanNcIjtpbXBvcnRcIi4uLy4uLy4uLy4uLy4uL2NvcmUvaGFzLmpzXCI7aW1wb3J0e3N1YmNsYXNzIGFzIG99ZnJvbVwiLi4vLi4vLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9zdWJjbGFzcy5qc1wiO2xldCBzPWNsYXNzIGV4dGVuZHMgcntpbml0aWFsaXplKCl7fWRlc3Ryb3koKXt9Z2V0IHN1cHBvcnRzVGlsZVVwZGF0ZXMoKXtyZXR1cm4hMX1nZXQgc3BhdGlhbFJlZmVyZW5jZSgpe2NvbnN0IGU9dGhpcy5nZXQoXCJ0aWxlU3RvcmUudGlsZVNjaGVtZS5zcGF0aWFsUmVmZXJlbmNlXCIpO3JldHVybiBlJiZlLnRvSlNPTigpfHxudWxsfX07ZShbdCh7cmVhZE9ubHk6ITB9KV0scy5wcm90b3R5cGUsXCJzdXBwb3J0c1RpbGVVcGRhdGVzXCIsbnVsbCksZShbdCh7Y29uc3RydWN0T25seTohMH0pXSxzLnByb3RvdHlwZSxcInJlbW90ZUNsaWVudFwiLHZvaWQgMCksZShbdCh7Y29uc3RydWN0T25seTohMH0pXSxzLnByb3RvdHlwZSxcInNlcnZpY2VcIix2b2lkIDApLGUoW3QoKV0scy5wcm90b3R5cGUsXCJzcGF0aWFsUmVmZXJlbmNlXCIsbnVsbCksZShbdCh7Y29uc3RydWN0T25seTohMH0pXSxzLnByb3RvdHlwZSxcInRpbGVJbmZvXCIsdm9pZCAwKSxlKFt0KHtjb25zdHJ1Y3RPbmx5OiEwfSldLHMucHJvdG90eXBlLFwidGlsZVN0b3JlXCIsdm9pZCAwKSxzPWUoW28oXCJlc3JpLnZpZXdzLjJkLmxheWVycy5mZWF0dXJlcy5wcm9jZXNzb3JzLkJhc2VQcm9jZXNzb3JcIildLHMpO2NvbnN0IHA9cztleHBvcnR7cCBhcyBkZWZhdWx0fTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI3L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7XyBhcyBlfWZyb21cIi4uLy4uLy4uLy4uLy4uL2NodW5rcy90c2xpYi5lczYuanNcIjtpbXBvcnR7YmlkaVRleHQgYXMgdH1mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL0JpZGlUZXh0LmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL0Vycm9yLmpzXCI7aW1wb3J0XCIuLi8uLi8uLi8uLi8uLi9jb3JlL2hhcy5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vLi4vLi4vY29yZS9Mb2dnZXIuanNcIjtpbXBvcnR7YXBwbHlTb21lIGFzIHMsdW53cmFwT3JUaHJvdyBhcyByfWZyb21cIi4uLy4uLy4uLy4uLy4uL2NvcmUvbWF5YmUuanNcIjtpbXBvcnR7dGhyb3dJZkFib3J0ZWQgYXMgaSxpc0Fib3J0RXJyb3IgYXMgYX1mcm9tXCIuLi8uLi8uLi8uLi8uLi9jb3JlL3Byb21pc2VVdGlscy5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZW5zdXJlVHlwZS5qc1wiO2ltcG9ydFwiLi4vLi4vLi4vLi4vLi4vY29yZS9hcnJheVV0aWxzLmpzXCI7aW1wb3J0e3N1YmNsYXNzIGFzIG99ZnJvbVwiLi4vLi4vLi4vLi4vLi4vY29yZS9hY2Nlc3NvclN1cHBvcnQvZGVjb3JhdG9ycy9zdWJjbGFzcy5qc1wiO2ltcG9ydHtkaWZmIGFzIG4saGFzRGlmZiBhcyBsfWZyb21cIi4uLy4uLy4uLy4uLy4uL2NvcmUvYWNjZXNzb3JTdXBwb3J0L2RpZmZVdGlscy5qc1wiO2ltcG9ydCBjIGZyb21cIi4uLy4uLy4uLy4uLy4uL2dlb21ldHJ5L1NwYXRpYWxSZWZlcmVuY2UuanNcIjtpbXBvcnR7aXNBZ2dyZWdhdGVJZCBhcyBkfWZyb21cIi4uLy4uLy4uL2VuZ2luZS93ZWJnbC9EaXNwbGF5SWQuanNcIjtpbXBvcnR7V0dMU3ltYm9sb2d5VHlwZSBhcyBofWZyb21cIi4uLy4uLy4uL2VuZ2luZS93ZWJnbC9lbnVtcy5qc1wiO2ltcG9ydHtNZXNoRGF0YSBhcyBmfWZyb21cIi4uLy4uLy4uL2VuZ2luZS93ZWJnbC9tZXNoL01lc2hEYXRhLmpzXCI7aW1wb3J0e1dHTE1lc2hGYWN0b3J5IGFzIHV9ZnJvbVwiLi4vLi4vLi4vZW5naW5lL3dlYmdsL21lc2gvZmFjdG9yaWVzL1dHTE1lc2hGYWN0b3J5LmpzXCI7aW1wb3J0e1dHTFRlbXBsYXRlU3RvcmUgYXMgbX1mcm9tXCIuLi8uLi8uLi9lbmdpbmUvd2ViZ2wvbWVzaC90ZW1wbGF0ZXMvV0dMVGVtcGxhdGVTdG9yZS5qc1wiO2ltcG9ydHtjcmVhdGVNYXRjaGVyIGFzIGd9ZnJvbVwiLi4vLi4vLi4vZW5naW5lL3dlYmdsL3V0aWwvTWF0Y2hlci5qc1wiO2ltcG9ydHtjb2RlcG9pbnRzIGFzIHB9ZnJvbVwiLi4vdGV4dFV0aWxzLmpzXCI7aW1wb3J0IHkgZnJvbVwiLi9CYXNlUHJvY2Vzc29yLmpzXCI7aW1wb3J0IF8gZnJvbVwiLi4vc3VwcG9ydC9SZXNvdXJjZU1hbmFnZXJQcm94eS5qc1wiO2Z1bmN0aW9uIGIoZSx0KXtyZXR1cm4oIWUubWluU2NhbGV8fGUubWluU2NhbGU+PXQpJiYoIWUubWF4U2NhbGV8fGUubWF4U2NhbGU8PXQpfWZ1bmN0aW9uIFMoZSl7Y29uc3QgdD1lLm1lc3NhZ2Uscj17bWVzc2FnZTp7ZGF0YTp7fSx0aWxlS2V5OnQudGlsZUtleSx0aWxlS2V5T3JpZ2luOnQudGlsZUtleU9yaWdpbix2ZXJzaW9uOnQudmVyc2lvbn0sdHJhbnNmZXJMaXN0Om5ldyBBcnJheX07Zm9yKGNvbnN0IGkgaW4gdC5kYXRhKXtjb25zdCBlPWksYT10LmRhdGFbZV07aWYoci5tZXNzYWdlLmRhdGFbZV09bnVsbCxudWxsIT1hKXtjb25zdCB0PWEuc3RyaWRlLGk9YS5pbmRpY2VzLnNsaWNlKDApLG89YS52ZXJ0aWNlcy5zbGljZSgwKSxuPWEucmVjb3Jkcy5zbGljZSgwKSxsPXtzdHJpZGU6dCxpbmRpY2VzOmksdmVydGljZXM6byxyZWNvcmRzOm4sbWV0cmljczpzKGEubWV0cmljcywoZT0+ZS5zbGljZSgwKSkpfTtyLnRyYW5zZmVyTGlzdC5wdXNoKGksbyxuKSxyLm1lc3NhZ2UuZGF0YVtlXT1sfX1yZXR1cm4gcn1sZXQgdz1jbGFzcyBleHRlbmRzIHl7Y29uc3RydWN0b3IoKXtzdXBlciguLi5hcmd1bWVudHMpLHRoaXMudHlwZT1cInN5bWJvbFwiLHRoaXMuX21hdGNoZXJzPXtmZWF0dXJlOm51bGwsYWdncmVnYXRlOm51bGx9LHRoaXMuX2J1ZmZlckRhdGE9bmV3IE1hcCx0aGlzLl9idWZmZXJJZHM9bmV3IE1hcH1pbml0aWFsaXplKCl7dGhpcy5oYW5kbGVzLmFkZChbdGhpcy50aWxlU3RvcmUub24oXCJ1cGRhdGVcIix0aGlzLm9uVGlsZVVwZGF0ZS5iaW5kKHRoaXMpKV0pLHRoaXMuX3Jlc291cmNlTWFuYWdlclByb3h5PW5ldyBfKHRoaXMucmVtb3RlQ2xpZW50KX1kZXN0cm95KCl7dGhpcy5fcmVzb3VyY2VNYW5hZ2VyUHJveHkuZGVzdHJveSgpfWdldCBzdXBwb3J0c1RpbGVVcGRhdGVzKCl7cmV0dXJuITB9Zm9yRWFjaEJ1ZmZlcklkKGUpe3RoaXMuX2J1ZmZlcklkcy5mb3JFYWNoKCh0PT57dC5mb3JFYWNoKGUpfSkpfWFzeW5jIHVwZGF0ZShlLHQpe2NvbnN0IHM9dC5zY2hlbWEucHJvY2Vzc29yc1swXTtpZihcInN5bWJvbFwiIT09cy50eXBlKXJldHVybjtjb25zdCByPW4odGhpcy5fc2NoZW1hLHMpOyhsKHIsXCJtZXNoXCIpfHxsKHIsXCJ0YXJnZXRcIikpJiYoZS5tZXNoPSEwLGUud2h5Py5tZXNoLnB1c2goXCJTeW1ib2xvZ3kgY2hhbmdlZFwiKSx0aGlzLl9zY2hlbWE9cyx0aGlzLl9mYWN0b3J5PXRoaXMuX2NyZWF0ZUZhY3RvcnkocyksdGhpcy5fZmFjdG9yeS51cGRhdGUocyx0aGlzLnRpbGVTdG9yZS50aWxlU2NoZW1lLnRpbGVJbmZvKSl9b25UaWxlTWVzc2FnZShlLHQscyxyKXtyZXR1cm4gaShyKSx0aGlzLl9vblRpbGVEYXRhKGUsdCxzLHIpfW9uVGlsZUNsZWFyKGUsdCl7Y29uc3Qgcz17Y2xlYXI6ITAsZW5kOnR9O3JldHVybiB0aGlzLl9idWZmZXJEYXRhLmRlbGV0ZShlLmtleS5pZCksdGhpcy5fYnVmZmVySWRzLmRlbGV0ZShlLmtleS5pZCksdGhpcy5yZW1vdGVDbGllbnQuaW52b2tlKFwidGlsZVJlbmRlcmVyLm9uVGlsZURhdGFcIix7dGlsZUtleTplLmlkLGRhdGE6c30pfW9uVGlsZUVycm9yKGUsdCxzKXtjb25zdCByPXMuc2lnbmFsLGk9e3RpbGVLZXk6ZS5pZCxlcnJvcjp0fTtyZXR1cm4gdGhpcy5yZW1vdGVDbGllbnQuaW52b2tlKFwidGlsZVJlbmRlcmVyLm9uVGlsZUVycm9yXCIsaSx7c2lnbmFsOnJ9KX1vblRpbGVVcGRhdGUoZSl7Zm9yKGNvbnN0IHQgb2YgZS5yZW1vdmVkKXRoaXMuX2J1ZmZlckRhdGEuaGFzKHQua2V5LmlkKSYmdGhpcy5fYnVmZmVyRGF0YS5kZWxldGUodC5rZXkuaWQpLHRoaXMuX2J1ZmZlcklkcy5oYXModC5rZXkuaWQpJiZ0aGlzLl9idWZmZXJJZHMuZGVsZXRlKHQua2V5LmlkKTtmb3IoY29uc3QgdCBvZiBlLmFkZGVkKXRoaXMuX2J1ZmZlckRhdGEuZm9yRWFjaCgoZT0+e2Zvcihjb25zdCBzIG9mIGUpcy5tZXNzYWdlLnRpbGVLZXk9PT10LmlkJiZ0aGlzLl91cGRhdGVUaWxlTWVzaChcImFwcGVuZFwiLHQsUyhzKSxbXSwhMSwhMSxudWxsKX0pKX1fYWRkQnVmZmVyRGF0YShlLHQpe3RoaXMuX2J1ZmZlckRhdGEuaGFzKGUpfHx0aGlzLl9idWZmZXJEYXRhLnNldChlLFtdKSx0aGlzLl9idWZmZXJEYXRhLmdldChlKT8ucHVzaChTKHQpKX1fY3JlYXRlRmFjdG9yeShlKXtjb25zdHtnZW9tZXRyeVR5cGU6dCxvYmplY3RJZEZpZWxkOnIsZmllbGRzOml9PXRoaXMuc2VydmljZSxhPShlLHQpPT50aGlzLnJlbW90ZUNsaWVudC5pbnZva2UoXCJ0aWxlUmVuZGVyZXIuZ2V0TWF0ZXJpYWxJdGVtc1wiLGUsdCksbz17Z2VvbWV0cnlUeXBlOnQsZmllbGRzOmksc3BhdGlhbFJlZmVyZW5jZTpjLmZyb21KU09OKHRoaXMuc3BhdGlhbFJlZmVyZW5jZSl9LG49bmV3IG0oYSx0aGlzLnRpbGVTdG9yZS50aWxlU2NoZW1lLnRpbGVJbmZvKSx7bWF0Y2hlcjpsLGFnZ3JlZ2F0ZU1hdGNoZXI6ZH09ZS5tZXNoO3JldHVybiB0aGlzLl9zdG9yZT1uLHRoaXMuX21hdGNoZXJzLmZlYXR1cmU9ZyhsLG4sbyx0aGlzLl9yZXNvdXJjZU1hbmFnZXJQcm94eSksdGhpcy5fbWF0Y2hlcnMuYWdncmVnYXRlPXMoZCwoZT0+ZyhlLG4sbyx0aGlzLl9yZXNvdXJjZU1hbmFnZXJQcm94eSkpKSxuZXcgdSh0LHIsbil9YXN5bmMgX29uVGlsZURhdGEoZSx0LHMscil7aShyKTtjb25zdHt0eXBlOmEsYWRkT3JVcGRhdGU6byxyZW1vdmU6bixjbGVhcjpsLGVuZDpjfT10LGQ9ISF0aGlzLl9zY2hlbWEubWVzaC5zb3J0S2V5O2lmKCFvKXtjb25zdCB0PXt0eXBlOmEsYWRkT3JVcGRhdGU6bnVsbCxyZW1vdmU6bixjbGVhcjpsLGVuZDpjLHNvcnQ6ZH07cmV0dXJuIHRoaXMucmVtb3RlQ2xpZW50Lmludm9rZShcInRpbGVSZW5kZXJlci5vblRpbGVEYXRhXCIse3RpbGVLZXk6ZS5pZCxkYXRhOnR9LHIpfWNvbnN0IGg9dGhpcy5fcHJvY2Vzc0ZlYXR1cmVzKGUsbyxzLHIsdC5zdGF0dXM/LnZlcnNpb24pO3RyeXtjb25zdCBzPWF3YWl0IGg7aWYobnVsbD09cyl7Y29uc3QgdD17dHlwZTphLGFkZE9yVXBkYXRlOm51bGwscmVtb3ZlOm4sY2xlYXI6bCxlbmQ6Yyxzb3J0OmR9O3JldHVybiB0aGlzLnJlbW90ZUNsaWVudC5pbnZva2UoXCJ0aWxlUmVuZGVyZXIub25UaWxlRGF0YVwiLHt0aWxlS2V5OmUuaWQsZGF0YTp0fSxyKX1jb25zdCBpPVtdO2Zvcihjb25zdCB0IG9mIHMpe2xldCBzPSExO2NvbnN0IHI9dC5tZXNzYWdlLmJ1ZmZlcklkcyxhPWUua2V5LmlkLG89dC5tZXNzYWdlLnRpbGVLZXk7aWYoYSE9PW8mJm51bGwhPXIpe2lmKCF0aGlzLnRpbGVTdG9yZS5nZXQobykpe3RoaXMuX2FkZEJ1ZmZlckRhdGEoYSx0KSxpLnB1c2godCk7Y29udGludWV9bGV0IGU9dGhpcy5fYnVmZmVySWRzLmdldChvKTtlfHwoZT1uZXcgU2V0LHRoaXMuX2J1ZmZlcklkcy5zZXQobyxlKSk7Y29uc3Qgbj1BcnJheS5mcm9tKHIpO2Zvcihjb25zdCB0IG9mIG4pe2lmKGUuaGFzKHQpKXtzPSEwO2JyZWFrfWUuYWRkKHQpfX1zfHwodGhpcy5fYWRkQnVmZmVyRGF0YShhLHQpLGkucHVzaCh0KSl9YXdhaXQgUHJvbWlzZS5hbGwoaS5tYXAoKHM9Pntjb25zdCBpPWUua2V5LmlkPT09cy5tZXNzYWdlLnRpbGVLZXksbz1pP3QucmVtb3ZlOltdLG49aSYmdC5lbmQ7cmV0dXJuIHRoaXMuX3VwZGF0ZVRpbGVNZXNoKGEsZSxzLG8sbiwhIXQuY2xlYXIsci5zaWduYWwpfSkpKX1jYXRjaChmKXt0aGlzLl9oYW5kbGVFcnJvcihlLGYscil9fWFzeW5jIF91cGRhdGVUaWxlTWVzaChlLHQscixhLG8sbixsKXtjb25zdCBjPWUsZD1yLm1lc3NhZ2UudGlsZUtleSxoPSEhdGhpcy5fc2NoZW1hLm1lc2guc29ydEtleTtkIT09dC5rZXkuaWQmJihvPSExKTtjb25zdCBmPXt0eXBlOmMsYWRkT3JVcGRhdGU6cyhyLChlPT5lLm1lc3NhZ2UpKSxyZW1vdmU6YSxjbGVhcjpuLGVuZDpvLHNvcnQ6aH0sdT17dHJhbnNmZXJMaXN0OnMociwoZT0+ZS50cmFuc2Zlckxpc3QpKXx8W118fFtdLHNpZ25hbDpsfTtyZXR1cm4gaSh1KSx0aGlzLnJlbW90ZUNsaWVudC5pbnZva2UoXCJ0aWxlUmVuZGVyZXIub25UaWxlRGF0YVwiLHt0aWxlS2V5OmQsZGF0YTpmfSx1KX1hc3luYyBfcHJvY2Vzc0ZlYXR1cmVzKGUsdCxzLHIsYSl7aWYobnVsbD09dHx8IXQuaGFzRmVhdHVyZXMpcmV0dXJuIG51bGw7Y29uc3Qgbz17dHJhbnNmb3JtOmUudHJhbnNmb3JtLGhhc1o6ITEsaGFzTTohMX0sbj10aGlzLl9mYWN0b3J5LGw9e3ZpZXdpbmdNb2RlOlwiXCIsc2NhbGU6ZS5zY2FsZX0sYz1hd2FpdCB0aGlzLl9tYXRjaGVycy5mZWF0dXJlLGQ9YXdhaXQgdGhpcy5fbWF0Y2hlcnMuYWdncmVnYXRlO2kocik7Y29uc3QgaD10aGlzLl9nZXRMYWJlbEluZm9zKGUsdCk7cmV0dXJuIGF3YWl0IG4uYW5hbHl6ZSh0LmdldEN1cnNvcigpLHRoaXMuX3Jlc291cmNlTWFuYWdlclByb3h5LGMsZCxvLGwpLGkociksdGhpcy5fd3JpdGVGZWF0dXJlU2V0KGUsdCxvLGgsbixzLGEpfV93cml0ZUZlYXR1cmVTZXQoZSx0LHMscixpLGEsbyl7Y29uc3Qgbj10LmdldFNpemUoKSxsPXRoaXMuX3NjaGVtYS5tZXNoLm1hdGNoZXIuc3ltYm9sb2d5VHlwZSxjPW5ldyBmKGUua2V5LmlkLHtmZWF0dXJlczpuLHJlY29yZHM6bixtZXRyaWNzOjB9LGwsYSxsIT09aC5IRUFUTUFQLG8pLGQ9e3ZpZXdpbmdNb2RlOlwiXCIsc2NhbGU6ZS5zY2FsZX0sdT10LmdldEN1cnNvcigpO2Zvcig7dS5uZXh0KCk7KXRyeXtjb25zdCB0PXUuZ2V0RGlzcGxheUlkKCksYT1udWxsIT1yP3IuZ2V0KHQpOm51bGw7aS53cml0ZUN1cnNvcihjLHUscyxkLGUubGV2ZWwsYSx0aGlzLl9yZXNvdXJjZU1hbmFnZXJQcm94eSl9Y2F0Y2goZyl7fWNvbnN0IG09ZS50aWxlSW5mb1ZpZXcudGlsZUluZm8uaXNXcmFwcGFibGU7cmV0dXJuIGMuc2VyaWFsaXplKG0pfV9oYW5kbGVFcnJvcihlLHQscyl7aWYoIWEodCkpe2NvbnN0IHI9e3RpbGVLZXk6ZS5pZCxlcnJvcjp0Lm1lc3NhZ2V9O3JldHVybiB0aGlzLnJlbW90ZUNsaWVudC5pbnZva2UoXCJ0aWxlUmVuZGVyZXIub25UaWxlRXJyb3JcIixyLHtzaWduYWw6cy5zaWduYWx9KX1yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9X2dldExhYmVsaW5nU2NoZW1hRm9yU2NhbGUoZSl7Y29uc3QgdD10aGlzLl9zY2hlbWEubWVzaC5sYWJlbHM7aWYobnVsbD09dClyZXR1cm4gbnVsbDtpZihcInN1YnR5cGVcIj09PXQudHlwZSl7Y29uc3Qgcz17dHlwZTpcInN1YnR5cGVcIixjbGFzc2VzOnt9fTtsZXQgcj0hMTtmb3IoY29uc3QgaSBpbiB0LmNsYXNzZXMpe2NvbnN0IGE9dC5jbGFzc2VzW2ldLmZpbHRlcigodD0+Yih0LGUuc2NhbGUpKSk7cj1yfHwhIWEubGVuZ3RoLHMuY2xhc3Nlc1tpXT1hfXJldHVybiByP3M6bnVsbH1jb25zdCBzPXQuY2xhc3Nlcy5maWx0ZXIoKHQ9PmIodCxlLnNjYWxlKSkpO3JldHVybiBzLmxlbmd0aD97dHlwZTpcInNpbXBsZVwiLGNsYXNzZXM6c306bnVsbH1fZ2V0TGFiZWxzKGUsdCl7aWYoXCJzdWJ0eXBlXCI9PT10LnR5cGUpe2NvbnN0IHM9dGhpcy5zZXJ2aWNlLnN1YnR5cGVGaWVsZCxpPXIocyxcIkV4cGVjdGVkIHRvIGZpbmQgc3VidHlwZSBGaWVsZFwiKSxhPWUucmVhZEF0dHJpYnV0ZShpKTtyZXR1cm4gbnVsbD09YT9bXTp0LmNsYXNzZXNbYV0/P1tdfXJldHVybiB0LmNsYXNzZXN9X2dldExhYmVsSW5mb3MoZSxzKXtjb25zdCByPXRoaXMuX2dldExhYmVsaW5nU2NoZW1hRm9yU2NhbGUoZSk7aWYobnVsbD09cilyZXR1cm4gbnVsbDtjb25zdCBpPW5ldyBNYXAsYT1zLmdldEN1cnNvcigpO2Zvcig7YS5uZXh0KCk7KXtjb25zdCBlPWEuZ2V0RGlzcGxheUlkKCkscz1bXSxvPWQoZSksbj1vJiYxIT09YS5yZWFkQXR0cmlidXRlKFwiY2x1c3Rlcl9jb3VudFwiKT9cImFnZ3JlZ2F0ZVwiOlwiZmVhdHVyZVwiLGw9dGhpcy5fZ2V0TGFiZWxzKGEscik7Zm9yKGNvbnN0IHIgb2YgbCl7aWYoci50YXJnZXQhPT1uKWNvbnRpbnVlO2NvbnN0IGk9YS5nZXRTdG9yYWdlKCksbD1vJiZcImZlYXR1cmVcIj09PW4/aS5nZXRDb21wdXRlZFN0cmluZ0F0SW5kZXgoYS5yZWFkQXR0cmlidXRlKFwicmVmZXJlbmNlSWRcIiksci5maWVsZEluZGV4KTppLmdldENvbXB1dGVkU3RyaW5nQXRJbmRleChlLHIuZmllbGRJbmRleCk7aWYoIWwpY29udGludWU7Y29uc3QgYz10KGwudG9TdHJpbmcoKSksZD1jWzBdLGg9Y1sxXTt0aGlzLl9zdG9yZS5nZXRNb3NhaWNJdGVtKHIuc3ltYm9sLHAoZCkpLnRoZW4oKGU9PntzW3IuaW5kZXhdPXtnbHlwaHM6ZS5nbHlwaE1vc2FpY0l0ZW1zPz9bXSxydGw6aCxpbmRleDpyLmluZGV4fX0pKX1pLnNldChlLHMpfXJldHVybiBpfX07dz1lKFtvKFwiZXNyaS52aWV3cy4yZC5sYXllcnMuZmVhdHVyZXMucHJvY2Vzc29ycy5TeW1ib2xQcm9jZXNzb3JcIildLHcpO2NvbnN0IEk9dztleHBvcnR7SSBhcyBkZWZhdWx0fTtcbiIsIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI3L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7aXNBYm9ydEVycm9yIGFzIGV9ZnJvbVwiLi4vLi4vLi4vLi4vLi4vY29yZS9wcm9taXNlVXRpbHMuanNcIjtjbGFzcyB0e2NvbnN0cnVjdG9yKGUpe3RoaXMuX3JlbW90ZUNsaWVudD1lLHRoaXMuX3Jlc291cmNlTWFwPW5ldyBNYXAsdGhpcy5faW5GbGlnaHRSZXNvdXJjZU1hcD1uZXcgTWFwLHRoaXMuZ2VvbWV0cnlFbmdpbmU9bnVsbCx0aGlzLmdlb21ldHJ5RW5naW5lUHJvbWlzZT1udWxsfWRlc3Ryb3koKXt9YXN5bmMgZmV0Y2hSZXNvdXJjZSh0LHIpe2NvbnN0IHM9dGhpcy5fcmVzb3VyY2VNYXAsaT1zLmdldCh0KTtpZihpKXJldHVybiBpO2xldCBuPXRoaXMuX2luRmxpZ2h0UmVzb3VyY2VNYXAuZ2V0KHQpO2lmKG4pcmV0dXJuIG47dHJ5e249dGhpcy5fcmVtb3RlQ2xpZW50Lmludm9rZShcInRpbGVSZW5kZXJlci5mZXRjaFJlc291cmNlXCIse3VybDp0fSx7Li4ucn0pLHRoaXMuX2luRmxpZ2h0UmVzb3VyY2VNYXAuc2V0KHQsbiksbi50aGVuKChlPT4odGhpcy5faW5GbGlnaHRSZXNvdXJjZU1hcC5kZWxldGUodCkscy5zZXQodCxlKSxlKSkpfWNhdGNoKG8pe3JldHVybiBlKG8pP251bGw6e3dpZHRoOjAsaGVpZ2h0OjB9fXJldHVybiBufWdldFJlc291cmNlKGUpe3JldHVybiB0aGlzLl9yZXNvdXJjZU1hcC5nZXQoZSk/P251bGx9bG9hZEZvbnQoZSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKX19ZXhwb3J0e3QgYXMgZGVmYXVsdH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=