"use strict";
(self["webpackChunkklyk"] = self["webpackChunkklyk"] || []).push([["defaultVendors-node_modules_arcgis_core_arcade_functions_featuresetbase_js"],{

/***/ "./node_modules/@arcgis/core/arcade/functions/featuresetbase.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/functions/featuresetbase.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   registerFunctions: () => (/* binding */ ae)
/* harmony export */ });
/* harmony import */ var _ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ArcadeDate.js */ "./node_modules/@arcgis/core/arcade/ArcadeDate.js");
/* harmony import */ var _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ArcadePortal.js */ "./node_modules/@arcgis/core/arcade/ArcadePortal.js");
/* harmony import */ var _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Dictionary.js */ "./node_modules/@arcgis/core/arcade/Dictionary.js");
/* harmony import */ var _executionError_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../executionError.js */ "./node_modules/@arcgis/core/arcade/executionError.js");
/* harmony import */ var _Feature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Feature.js */ "./node_modules/@arcgis/core/arcade/Feature.js");
/* harmony import */ var _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../featureSetCollection.js */ "./node_modules/@arcgis/core/arcade/featureSetCollection.js");
/* harmony import */ var _featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../featureSetUtils.js */ "./node_modules/@arcgis/core/arcade/featureSetUtils.js");
/* harmony import */ var _ImmutableArray_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../ImmutableArray.js */ "./node_modules/@arcgis/core/arcade/ImmutableArray.js");
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../chunks/languageUtils.js */ "./node_modules/@arcgis/core/chunks/languageUtils.js");
/* harmony import */ var _portalUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../portalUtils.js */ "./node_modules/@arcgis/core/arcade/portalUtils.js");
/* harmony import */ var _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../featureset/actions/Adapted.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js");
/* harmony import */ var _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../featureset/actions/AttributeFilter.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js");
/* harmony import */ var _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../featureset/actions/OrderBy.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js");
/* harmony import */ var _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../featureset/actions/Top.js */ "./node_modules/@arcgis/core/arcade/featureset/actions/Top.js");
/* harmony import */ var _featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../featureset/sources/Empty.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js");
/* harmony import */ var _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../featureset/sources/FeatureLayerMemory.js */ "./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js");
/* harmony import */ var _featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../featureset/support/OrderbyClause.js */ "./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js");
/* harmony import */ var _featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../featureset/support/shared.js */ "./node_modules/@arcgis/core/arcade/featureset/support/shared.js");
/* harmony import */ var _featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../featureset/support/sqlUtils.js */ "./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js");
/* harmony import */ var _fieldStats_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./fieldStats.js */ "./node_modules/@arcgis/core/arcade/functions/fieldStats.js");
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../core/promiseUtils.js */ "./node_modules/@arcgis/core/core/promiseUtils.js");
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../core/sql/WhereClause.js */ "./node_modules/@arcgis/core/core/sql/WhereClause.js");
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../layers/FeatureLayer.js */ "./node_modules/@arcgis/core/layers/FeatureLayer.js");
/* harmony import */ var _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../layers/support/Field.js */ "./node_modules/@arcgis/core/layers/support/Field.js");
/* harmony import */ var _portal_Portal_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../portal/Portal.js */ "./node_modules/@arcgis/core/portal/Portal.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function J(e,t,n,i){if(1===i.length){if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(i[0]))return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_19__.calculateStat)(e,i[0],-1);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(i[0]))return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_19__.calculateStat)(e,i[0].toArray(),-1)}return (0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_19__.calculateStat)(e,i,-1)}async function K(e,t,n){const i=e.getVariables();if(i.length>0){const a=[];for(let e=0;e<i.length;e++){const r={name:i[e]};a.push(await t.evaluateIdentifier(n,r))}const r={};for(let e=0;e<i.length;e++)r[i[e]]=a[e];return e.parameters=r,e}return e}function Y(e,t,n=null){for(const i in e)if(i.toLowerCase()===t.toLowerCase())return e[i];return n}function X(e){if(null===e)return null;const t={type:Y(e,"type",""),name:Y(e,"name","")};if("range"===t.type)t.range=Y(e,"range",[]);else{t.codedValues=[];for(const n of Y(e,"codedValues",[]))t.codedValues.push({name:Y(n,"name",""),code:Y(n,"code",null)})}return t}function ee(e){if(null===e)return null;const t={},n=Y(e,"wkt",null);null!==n&&(t.wkt=n);const i=Y(e,"wkid",null);return null!==i&&(t.wkid=i),t}function te(e){if(null===e)return null;const t={hasZ:Y(e,"hasz",!1),hasM:Y(e,"hasm",!1)},n=Y(e,"spatialreference",null);n&&(t.spatialReference=ee(n));const i=Y(e,"x",null);if(null!==i)return t.x=i,t.y=Y(e,"y",null),t;const a=Y(e,"rings",null);if(null!==a)return t.rings=a,t;const r=Y(e,"paths",null);if(null!==r)return t.paths=r,t;const s=Y(e,"points",null);if(null!==s)return t.points=s,t;for(const l of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const n=Y(e,l,null);null!==n&&(t[l]=n)}return t}function ne(e,t){for(const n of t)if(n===e)return!0;return!1}function ie(e){return!!e.layerDefinition&&(!!e.featureSet&&(!1!==ne(e.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&(!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(e.layerDefinition.fields)&&!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(e.featureSet.features))))}function ae(_){"async"===_.mode&&(_.functions.timezone=function(t,r){return _.standardFunctionAsync(t,r,(async(s,l,o)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(o,1,2,t,r),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(o[0])){if(await o[0].load(),1===o.length||null===o[1])return o[0].dateTimeReferenceFieldIndex.layerDateFieldsTimeZone;if(!(o[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"])||!1===o[1].hasField("type"))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(t,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,r);const e=o[1].field("type");if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(e))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(t,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,r);switch((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(e).toLowerCase()){case"preferredtimezone":return o[0].dateTimeReferenceFieldIndex.layerPreferredTimeZone;case"editfieldsinfo":return o[0].dateTimeReferenceFieldIndex.layerEditFieldsTimeZone;case"timeinfo":return o[0].dateTimeReferenceFieldIndex.layerTimeInfoTimeZone;case"field":if(o[1].hasField("fieldname")&&(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(o[1].field("fieldname")))return o[0].dateTimeReferenceFieldIndex.fieldTimeZone((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(o[1].field("fieldname")))}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(t,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,r)}const f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.l)(o[0],(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.G)(t));if(null===f)return null;const u=f.timeZone;return"system"===u?_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__.ArcadeDate.systemTimeZoneCanonicalName:u}))},_.functions.sqltimestamp=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,1,3,e,t);const l=s[0];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.k)(l)){if(1===s.length)return l.toSQLString();if(2===s.length)return l.changeTimeZone((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(s[1])).toSQLString();throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(l)){if(3!==s.length)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);await l.load();const n=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(s[1]);if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.k)(s[2]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);const r=l.fieldTimeZone(n);return null===r?s[2].toSQLString():s[2].changeTimeZone(r).toSQLString()}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"sqltimestamp",min:2,max:4}),_.functions.featuresetbyid=function(e,t){return _.standardFunctionAsync(e,t,((n,r,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,2,4,e,t),l[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_5__["default"]){const n=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[1]);let r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[2],null);const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[3],!0));if(null===r&&(r=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(r))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);return l[0].featureSetById(n,s,r)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"featuresetbyid",min:2,max:4}),_.functions.getfeatureset=function(e,t){return _.standardFunctionAsync(e,t,((n,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,1,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(s[0])){let t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(s[1],"datasource");return null===t&&(t="datasource"),t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(t).toLowerCase(),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.convertToFeatureSet)(s[0].fullSchema(),t,e.lrucache,e.interceptor,e.spatialReference)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"getfeatureset",min:1,max:2}),_.functions.featuresetbyportalitem=function(e,n){return _.standardFunctionAsync(e,n,((r,s,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,2,5,e,n),null===l[0])throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.PortalRequired,n);if(l[0]instanceof _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_1__["default"]){const t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[1]),r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[2]);let s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[3],null);const f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[4],!0));if(null===s&&(s=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(s))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,n);let u=null;return u=e.services&&e.services.portal?e.services.portal:_portal_Portal_js__WEBPACK_IMPORTED_MODULE_24__["default"].getDefault(),u=(0,_portalUtils_js__WEBPACK_IMPORTED_MODULE_9__.getPortal)(l[0],u),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSetFromPortalItem)(t,r,e.spatialReference,s,f,u,e.lrucache,e.interceptor)}if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(l[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.PortalRequired,n);const f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[0]),u=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[1]);let c=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[2],null);const d=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[3],!0));if(null===c&&(c=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(c))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,n);return (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSetFromPortalItem)(f,u,e.spatialReference,c,d,e.services?.portal??_portal_Portal_js__WEBPACK_IMPORTED_MODULE_24__["default"].getDefault(),e.lrucache,e.interceptor)}))},_.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),_.functions.featuresetbyname=function(e,t){return _.standardFunctionAsync(e,t,((n,r,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,2,4,e,t),l[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_5__["default"]){const n=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l[1]);let r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[2],null);const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(l[3],!0));if(null===r&&(r=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(r))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);return l[0].featureSetByName(n,s,r)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"featuresetbyname",min:2,max:4}),_.functions.featureset=function(e,t){return _.standardFunction(e,t,((r,s,l)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,1,1,e,t);let o=l[0];const f={layerDefinition:{geometryType:"",objectIdField:"",hasM:!1,hasZ:!1,globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(o))o=JSON.parse(o),void 0!==o.layerDefinition?(f.layerDefinition=o.layerDefinition,f.featureSet=o.featureSet,o.layerDefinition.spatialReference&&(f.layerDefinition.spatialReference=o.layerDefinition.spatialReference)):(f.featureSet.features=o.features,f.featureSet.geometryType=o.geometryType,f.layerDefinition.geometryType=f.featureSet.geometryType,f.layerDefinition.objectIdField=o.objectIdFieldName??"",f.layerDefinition.typeIdField=o.typeIdFieldName,f.layerDefinition.globalIdField=o.globalIdFieldName,f.layerDefinition.fields=o.fields,o.spatialReference&&(f.layerDefinition.spatialReference=o.spatialReference));else{if(!(l[0]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);{o=JSON.parse(l[0].castToText(!0));const e=Y(o,"layerdefinition");if(null!==e){f.layerDefinition.geometryType=Y(e,"geometrytype",""),f.featureSet.geometryType=f.layerDefinition.geometryType,f.layerDefinition.globalIdField=Y(e,"globalidfield",""),f.layerDefinition.objectIdField=Y(e,"objectidfield",""),f.layerDefinition.typeIdField=Y(e,"typeidfield",""),f.layerDefinition.hasZ=!0===Y(e,"hasz",!1),f.layerDefinition.hasM=!0===Y(e,"hasm",!1);const t=Y(e,"spatialreference",null);t&&(f.layerDefinition.spatialReference=ee(t));for(const i of Y(e,"fields",[])){const e={name:Y(i,"name",""),alias:Y(i,"alias",""),type:Y(i,"type",""),nullable:Y(i,"nullable",!0),editable:Y(i,"editable",!0),length:Y(i,"length",null),domain:X(Y(i,"domain"))};f.layerDefinition.fields.push(e)}const n=Y(o,"featureset",null);if(n){const e={};for(const t of f.layerDefinition.fields)e[t.name.toLowerCase()]=t.name;for(const t of Y(n,"features",[])){const n={},i=Y(t,"attributes",{});for(const t in i)n[e[t.toLowerCase()]]=i[t];f.featureSet.features.push({attributes:n,geometry:te(Y(t,"geometry",null))})}}}else{f.layerDefinition.hasZ=!0===Y(o,"hasz",!1),f.layerDefinition.hasM=!0===Y(o,"hasm",!1),f.layerDefinition.geometryType=Y(o,"geometrytype",""),f.featureSet.geometryType=f.layerDefinition.geometryType,f.layerDefinition.objectIdField=Y(o,"objectidfieldname",""),f.layerDefinition.typeIdField=Y(o,"typeidfieldname","");const e=Y(o,"spatialreference",null);e&&(f.layerDefinition.spatialReference=ee(e));let t=Y(o,"fields",null);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(t))for(const a of t){const e={name:Y(a,"name",""),alias:Y(a,"alias",""),type:Y(a,"type",""),nullable:Y(a,"nullable",!0),editable:Y(a,"editable",!0),length:Y(a,"length",null),domain:X(Y(a,"domain"))};f.layerDefinition.fields.push(e)}else t=null,f.layerDefinition.fields=t;const n={};for(const a of f.layerDefinition.fields)n[a.name.toLowerCase()]=a.name;let i=Y(o,"features",null);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(i))for(const a of i){const e={},t=Y(a,"attributes",{});for(const i in t)e[n[i.toLowerCase()]]=t[i];f.featureSet.features.push({attributes:e,geometry:te(Y(a,"geometry",null))})}else i=null,f.featureSet.features=i}}}if(!1===ie(f))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);return""===(f?.layerDefinition?.geometryType||"")&&(f.layerDefinition.geometryType="esriGeometryNull"),_featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_15__["default"].create(f,e.spatialReference)}))},_.signatures.push({name:"featureset",min:1,max:1}),_.functions.filter=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(s[0])||(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(s[0])){const n=[];let r=s[0];r instanceof _ImmutableArray_js__WEBPACK_IMPORTED_MODULE_7__["default"]&&(r=r.toArray());let l=null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.i)(s[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);l=s[1].createFunction(e);for(const e of r){const t=l(e);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_20__.isPromiseLike)(t)?!0===await t&&n.push(e):!0===t&&n.push(e)}return n}if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(s[0])){const t=await s[0].load(),n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(s[1],t.getFieldsIndex()),i=n.getVariables();if(i.length>0){const t=[];for(let n=0;n<i.length;n++){const a={name:i[n]};t.push(await _.evaluateIdentifier(e,a))}const a={};for(let e=0;e<i.length;e++)a[i[e]]=t[e];return n.parameters=a,new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_11__["default"]({parentfeatureset:s[0],whereclause:n})}return new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_11__["default"]({parentfeatureset:s[0],whereclause:n})}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"filter",min:2,max:2}),_.functions.orderby=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(s[0])){const e=new _featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_16__["default"](s[1]);return new _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_12__["default"]({parentfeatureset:s[0],orderbyclause:e})}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"orderby",min:2,max:2}),_.functions.top=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(s[0]))return new _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_13__["default"]({parentfeatureset:s[0],topnum:s[1]});if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(s[0]))return (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(s[1])>=s[0].length?s[0].slice(0):s[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(s[1]));if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(s[0]))return (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(s[1])>=s[0].length()?s[0].slice(0):s[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(s[1]));throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"top",min:2,max:2}),_.functions.first=function(e,t){return _.standardFunctionAsync(e,t,(async(n,i,a)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(a,1,1,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(a[0])){const t=await a[0].first(n.abortSignal);if(null!==t){const n=_Feature_js__WEBPACK_IMPORTED_MODULE_4__["default"].createFromGraphicLikeObject(t.geometry,t.attributes,a[0],e.timeReference);return n._underlyingGraphic=t,n}return t}return (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(a[0])?0===a[0].length?null:a[0][0]:(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(a[0])?0===a[0].length()?null:a[0].get(0):null}))},_.signatures.push({name:"first",min:1,max:1}),_.functions.attachments=function(e,t){return _.standardFunctionAsync(e,t,(async(r,s,l)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,1,2,e,t);const o={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(l.length>1)if(l[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]){if(l[1].hasField("minsize")&&(o.minsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(l[1].field("minsize"))),l[1].hasField("metadata")&&(o.returnMetadata=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)(l[1].field("metadata"))),l[1].hasField("maxsize")&&(o.maxsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.g)(l[1].field("maxsize"))),l[1].hasField("types")){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.a0)(l[1].field("types"),!1);e.length>0&&(o.types=e)}}else if(null!==l[1])throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(l[0])){let t=l[0]._layer;return t instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_22__["default"]&&(t=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSet)(t,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===t?[]:!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(t)?[]:(await t.load(),t.queryAttachments(l[0].field(t.objectIdField),o.minsize,o.maxsize,o.types,o.returnMetadata))}if(null===l[0])return[];throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}))},_.signatures.push({name:"attachments",min:1,max:2}),_.functions.featuresetbyrelationshipname=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,2,4,e,t);const l=s[0],o=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(s[1]);let d=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(s[2],null);const m=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(s[3],!0));if(null===d&&(d=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(d))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);if(null===s[0])return null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(s[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);let h=l._layer;if(h instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_22__["default"]&&(h=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSet)(h,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===h)return null;if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(h))return null;h=await h.load();const w=h.relationshipMetaData().filter((e=>e.name===o));if(0===w.length)return null;if(void 0!==w[0].relationshipTableId&&null!==w[0].relationshipTableId&&w[0].relationshipTableId>-1)return (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSetFromRelationship)(h,w[0],l.field(h.objectIdField),h.spatialReference,d,m,e.lrucache,e.interceptor);let I=h.serviceUrl();if(!I)return null;I="/"===I.charAt(I.length-1)?I+w[0].relatedTableId.toString():I+"/"+w[0].relatedTableId.toString();const F=await (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSetFromUrl)(I,h.spatialReference,d,m,e.lrucache,e.interceptor);await F.load();let A=F.relationshipMetaData();if(A=A.filter((e=>e.id===w[0].id)),!1===l.hasField(w[0].keyField)||null===l.field(w[0].keyField)){const e=await h.getFeatureByObjectId(l.field(h.objectIdField),[w[0].keyField]);if(e){const t=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(A[0].keyField+"= @id",F.getFieldsIndex());return t.parameters={id:e.attributes[w[0].keyField]},F.filter(t)}return new _featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_14__["default"]({parentfeatureset:F})}const N=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(A[0].keyField+"= @id",F.getFieldsIndex());return N.parameters={id:l.field(w[0].keyField)},F.filter(N)}))},_.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),_.functions.featuresetbyassociation=function(e,t){return _.standardFunctionAsync(e,t,(async(n,r,s)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(s,2,3,e,t);const l=s[0],o=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.D)(s[1],"")).toLowerCase(),u=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(s[2])?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(s[2]):null;if(null===s[0])return null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(s[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);let c=l._layer;if(c instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_22__["default"]&&(c=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructFeatureSet)(c,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===c)return null;if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(c))return null;await c.load();const m=c.serviceUrl(),w=await (0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_6__.constructAssociationMetaDataFeatureSetFromUrl)(m,e.spatialReference);let I=null,F=null,E=!1;if(null!==u&&""!==u&&void 0!==u){for(const e of w.terminals)e.terminalName===u&&(F=e.terminalId);null===F&&(E=!0)}const b=w.associations.getFieldsIndex(),A=b.get("TOGLOBALID").name,N=b.get("FROMGLOBALID").name,S=b.get("TOTERMINALID").name,T=b.get("FROMTERMINALID").name,$=b.get("FROMNETWORKSOURCEID").name,M=b.get("TONETWORKSOURCEID").name,O=b.get("ASSOCIATIONTYPE").name,k=b.get("ISCONTENTVISIBLE").name,z=b.get("OBJECTID").name;for(const e of c.fields)if("global-id"===e.type){I=l.field(e.name);break}let H=null,Z=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__["default"]({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create("0",w.associations.getFieldsIndex())),W=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__["default"]({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create("''",w.associations.getFieldsIndex()));const _="globalid",U="globalId",Q={};for(const e in w.lkp)Q[e]=w.lkp[e].sourceId;const J=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.StringToCodeAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__["default"]({name:"classname",alias:"classname",type:"string"}),null,Q);let K="";switch(o){case"midspan":{K=`((${A}='${I}') OR ( ${N}='${I}')) AND (${O} IN (5))`,J.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(`CASE WHEN (${A}='${I}') THEN ${$} ELSE ${M} END`,w.associations.getFieldsIndex());const e=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_17__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,N));e.name=_,e.alias=_,H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(e,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(`CASE WHEN (${N}='${I}') THEN ${A} ELSE ${N} END`,w.associations.getFieldsIndex())),Z=w.unVersion>=4?new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,b.get("PERCENTALONG").name)):new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__["default"]({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create("0",w.associations.getFieldsIndex()));break}case"junctionedge":{K=`((${A}='${I}') OR ( ${N}='${I}')) AND (${O} IN (4,6))`,J.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(`CASE WHEN (${A}='${I}') THEN ${$} ELSE ${M} END`,w.associations.getFieldsIndex());const e=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_17__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,N));e.name=_,e.alias=_,H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(e,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(`CASE WHEN (${N}='${I}') THEN ${A} ELSE ${N} END`,w.associations.getFieldsIndex())),W=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_23__["default"]({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(`CASE WHEN (${O}=4) THEN 'from' ELSE 'to' END`,w.associations.getFieldsIndex()));break}case"connected":{let e=`${A}='@T'`,t=`${N}='@T'`;null!==F&&(e+=` AND ${S}=@A`,t+=` AND ${T}=@A`),K="(("+e+") OR ("+t+"))",K=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.P)(K,"@T",I??""),e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.P)(e,"@T",I??""),null!==F&&(e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.P)(e,"@A",F.toString()),K=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.P)(K,"@A",F.toString())),J.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create("CASE WHEN "+e+` THEN ${$} ELSE ${M} END`,w.associations.getFieldsIndex());const n=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_17__.cloneField)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,N));n.name=_,n.alias=_,H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.SqlExpressionAdapted(n,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create("CASE WHEN "+e+` THEN ${N} ELSE ${A} END`,w.associations.getFieldsIndex()));break}case"container":K=`${A}='${I}' AND ${O} = 2`,null!==F&&(K+=` AND ${S} = `+F.toString()),J.codefield=$,K="( "+K+" )",H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,N),_,_);break;case"content":K=`(${N}='${I}' AND ${O} = 2)`,null!==F&&(K+=` AND ${T} = `+F.toString()),J.codefield=M,K="( "+K+" )",H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,A),_,_);break;case"structure":K=`(${A}='${I}' AND ${O} = 3)`,null!==F&&(K+=` AND ${S} = `+F.toString()),J.codefield=$,K="( "+K+" )",H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,N),_,U);break;case"attached":K=`(${N}='${I}' AND ${O} = 3)`,null!==F&&(K+=` AND ${T} = `+F.toString()),J.codefield=M,K="( "+K+" )",H=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.FieldRename(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,A),_,U);break;default:throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t)}E&&(K="1 <> 1");return new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet({parentfeatureset:w.associations,adaptedFields:[new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,z)),new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.OriginalField(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_10__.AdaptedFeatureSet.findField(w.associations.fields,k)),H,W,J,Z],extraFilter:K?_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(K,w.associations.getFieldsIndex()):null})}))},_.signatures.push({name:"featuresetbyassociation",min:2,max:6}),_.functions.groupby=function(e,t){return _.standardFunctionAsync(e,t,(async(r,s,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,3,3,e,t),!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(l[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);const o=await l[0].load(),f=[],u=[];let c=!1,d=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(l[1]))d.push(l[1]);else if(l[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"])d.push(l[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(l[1]))d=l[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(l[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);d=l[1].toArray()}for(const m of d)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(m)){const e=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(m),o.getFieldsIndex()),t=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_18__.isSingleField)(e)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(m):"%%%%FIELDNAME";f.push({name:t,expression:e}),"%%%%FIELDNAME"===t&&(c=!0)}else{if(!(m instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);{const n=m.hasField("name")?m.field("name"):"%%%%FIELDNAME",r=m.hasField("expression")?m.field("expression"):"";if("%%%%FIELDNAME"===n&&(c=!0),!n)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);f.push({name:n,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(r||n,o.getFieldsIndex())})}}if(d=[],(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(l[2]))d.push(l[2]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(l[2]))d=l[2];else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(l[2]))d=l[2].toArray();else{if(!(l[2]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);d.push(l[2])}for(const m of d){if(!(m instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);{const n=m.hasField("name")?m.field("name"):"",r=m.hasField("statistic")?m.field("statistic"):"",s=m.hasField("expression")?m.field("expression"):"";if(!n||!r||!s)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);u.push({name:n,statistic:r.toLowerCase(),expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(s,o.getFieldsIndex())})}}if(c){const e={};for(const n of o.fields)e[n.name.toLowerCase()]=1;for(const n of f)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of u)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of f)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}for(const t of f)await K(t.expression,_,e);for(const t of u)await K(t.expression,_,e);return l[0].groupby(f,u)}))},_.signatures.push({name:"groupby",min:3,max:3}),_.functions.distinct=function(e,t){return _.standardFunctionAsync(e,t,(async(r,s,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(l[0])){(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.C)(l,2,2,e,t);const r=await l[0].load(),s=[];let o=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(l[1]))o.push(l[1]);else if(l[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"])o.push(l[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.m)(l[1]))o=l[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.o)(l[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);o=l[1].toArray()}let f=!1;for(const l of o)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.c)(l)){const e=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l),r.getFieldsIndex()),t=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_18__.isSingleField)(e)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_8__.j)(l):"%%%%FIELDNAME";s.push({name:t,expression:e}),"%%%%FIELDNAME"===t&&(f=!0)}else{if(!(l instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_2__["default"]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);{const n=l.hasField("name")?l.field("name"):"%%%%FIELDNAME",o=l.hasField("expression")?l.field("expression"):"";if("%%%%FIELDNAME"===n&&(f=!0),!n)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_3__.ArcadeExecutionError(e,_executionError_js__WEBPACK_IMPORTED_MODULE_3__.ExecutionErrorCodes.InvalidParameter,t);s.push({name:n,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_21__.WhereClause.create(o||n,r.getFieldsIndex())})}}if(f){const e={};for(const n of r.fields)e[n.name.toLowerCase()]=1;for(const n of s)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of s)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}for(const t of s)await K(t.expression,_,e);return l[0].groupby(s,[])}return J("distinct",r,s,l)}))})}


/***/ }),

/***/ "./node_modules/@arcgis/core/arcade/portalUtils.js":
/*!*********************************************************!*\
  !*** ./node_modules/@arcgis/core/arcade/portalUtils.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getPortal: () => (/* binding */ t),
/* harmony export */   lookupUser: () => (/* binding */ s)
/* harmony export */ });
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../kernel.js */ "./node_modules/@arcgis/core/kernel.js");
/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request.js */ "./node_modules/@arcgis/core/request.js");
/* harmony import */ var _portal_Portal_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../portal/Portal.js */ "./node_modules/@arcgis/core/portal/Portal.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
function t(r,e){if(null===r)return e;return new _portal_Portal_js__WEBPACK_IMPORTED_MODULE_2__["default"]({url:r.field("url")})}async function s(n,t,s){const u=_kernel_js__WEBPACK_IMPORTED_MODULE_0__.id?.findCredential(n.restUrl);if(!u)return null;if("loaded"===n.loadStatus&&""===t&&n.user&&n.user.sourceJSON&&!1===s)return n.user.sourceJSON;if(""===t){const r=await (0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(n.restUrl+"/community/self",{responseType:"json",query:{f:"json",...!1===s?{}:{returnUserLicenseTypeExtensions:!0}}});if(r.data){const e=r.data;if(e&&e.username)return e}return null}const o=await (0,_request_js__WEBPACK_IMPORTED_MODULE_1__["default"])(n.restUrl+"/community/users/"+t,{responseType:"json",query:{f:"json"}});if(o.data){const r=o.data;return r.error?null:r}return null}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVmYXVsdFZlbmRvcnMtbm9kZV9tb2R1bGVzX2FyY2dpc19jb3JlX2FyY2FkZV9mdW5jdGlvbnNfZmVhdHVyZXNldGJhc2VfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDaW1ELG9CQUFvQixpQkFBaUIsR0FBRywyREFBQyxjQUFjLDhEQUFDLFlBQVksR0FBRywyREFBQyxjQUFjLDhEQUFDLHNCQUFzQixPQUFPLDhEQUFDLFNBQVMsd0JBQXdCLHlCQUF5QixlQUFlLFdBQVcsWUFBWSxXQUFXLEtBQUssU0FBUyxXQUFXLHdDQUF3QyxXQUFXLFlBQVksV0FBVyxpQkFBaUIsd0JBQXdCLFNBQVMsdUJBQXVCLGtFQUFrRSxTQUFTLGNBQWMsd0JBQXdCLFNBQVMseUNBQXlDLDRDQUE0QyxLQUFLLGlCQUFpQix5REFBeUQsMENBQTBDLEVBQUUsU0FBUyxlQUFlLHdCQUF3QixVQUFVLG1CQUFtQixvQkFBb0IseUJBQXlCLDhCQUE4QixlQUFlLHdCQUF3QixTQUFTLHdDQUF3QyxnQ0FBZ0MsOEJBQThCLHNCQUFzQiw2Q0FBNkMsMEJBQTBCLCtCQUErQiwwQkFBMEIsK0JBQStCLDJCQUEyQixnQ0FBZ0MseUVBQXlFLG9CQUFvQixtQkFBbUIsU0FBUyxpQkFBaUIsbUNBQW1DLFNBQVMsZUFBZSwwT0FBME8sMkRBQUMsaUNBQWlDLDJEQUFDLDJCQUEyQixlQUFlLHNEQUFzRCxtREFBbUQsR0FBRywyREFBQyxZQUFZLDJEQUFDLFFBQVEsK0dBQStHLG9CQUFvQixzREFBQyx3Q0FBd0Msb0VBQUMsR0FBRyxtRUFBQyxxQkFBcUIsMkJBQTJCLFFBQVEsMkRBQUMsY0FBYyxvRUFBQyxHQUFHLG1FQUFDLHFCQUFxQixPQUFPLDJEQUFDLG1CQUFtQix1RkFBdUYscUZBQXFGLDZFQUE2RSwyQ0FBMkMsMkRBQUMsZ0ZBQWdGLDJEQUFDLDJCQUEyQixVQUFVLG9FQUFDLEdBQUcs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Ozs7O0FDSm5ucUI7QUFDQTtBQUNBO0FBQ0E7QUFDa0csZ0JBQWdCLHFCQUFxQixXQUFXLHlEQUFDLEVBQUUsbUJBQW1CLEVBQUUsd0JBQXdCLFFBQVEsMENBQUMsNEJBQTRCLGtCQUFrQiwrRkFBK0YsV0FBVyxjQUFjLHVEQUFDLDhCQUE4QiwyQkFBMkIscUJBQXFCLEVBQUUscUNBQXFDLEVBQUUsV0FBVyxlQUFlLDBCQUEwQixZQUFZLGNBQWMsdURBQUMsa0NBQWtDLDJCQUEyQixVQUFVLEVBQUUsV0FBVyxlQUFlLHNCQUFzQixZQUFtRCIsInNvdXJjZXMiOlsid2VicGFjazovL2tseWsvLi9ub2RlX21vZHVsZXMvQGFyY2dpcy9jb3JlL2FyY2FkZS9mdW5jdGlvbnMvZmVhdHVyZXNldGJhc2UuanMiLCJ3ZWJwYWNrOi8va2x5ay8uL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2NvcmUvYXJjYWRlL3BvcnRhbFV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5BbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuU2VlIGh0dHBzOi8vanMuYXJjZ2lzLmNvbS80LjI3L2VzcmkvY29weXJpZ2h0LnR4dCBmb3IgZGV0YWlscy5cbiovXG5pbXBvcnR7QXJjYWRlRGF0ZSBhcyBlfWZyb21cIi4uL0FyY2FkZURhdGUuanNcIjtpbXBvcnQgdCBmcm9tXCIuLi9BcmNhZGVQb3J0YWwuanNcIjtpbXBvcnQgbiBmcm9tXCIuLi9EaWN0aW9uYXJ5LmpzXCI7aW1wb3J0e0FyY2FkZUV4ZWN1dGlvbkVycm9yIGFzIGksRXhlY3V0aW9uRXJyb3JDb2RlcyBhcyBhfWZyb21cIi4uL2V4ZWN1dGlvbkVycm9yLmpzXCI7aW1wb3J0IHIgZnJvbVwiLi4vRmVhdHVyZS5qc1wiO2ltcG9ydCBzIGZyb21cIi4uL2ZlYXR1cmVTZXRDb2xsZWN0aW9uLmpzXCI7aW1wb3J0e2NvbnZlcnRUb0ZlYXR1cmVTZXQgYXMgbCxjb25zdHJ1Y3RGZWF0dXJlU2V0RnJvbVBvcnRhbEl0ZW0gYXMgbyxjb25zdHJ1Y3RGZWF0dXJlU2V0IGFzIGYsY29uc3RydWN0RmVhdHVyZVNldEZyb21SZWxhdGlvbnNoaXAgYXMgdSxjb25zdHJ1Y3RGZWF0dXJlU2V0RnJvbVVybCBhcyBjLGNvbnN0cnVjdEFzc29jaWF0aW9uTWV0YURhdGFGZWF0dXJlU2V0RnJvbVVybCBhcyBkfWZyb21cIi4uL2ZlYXR1cmVTZXRVdGlscy5qc1wiO2ltcG9ydCBtIGZyb21cIi4uL0ltbXV0YWJsZUFycmF5LmpzXCI7aW1wb3J0e0MgYXMgcCxyIGFzIHksYyBhcyBoLGogYXMgZyxsIGFzIHcsRyBhcyBJLGsgYXMgRixELGggYXMgRSxtIGFzIGIscCBhcyB4LG8gYXMgQSxpIGFzIE4sZyBhcyBTLGEwIGFzIFQsUCBhcyBMfWZyb21cIi4uLy4uL2NodW5rcy9sYW5ndWFnZVV0aWxzLmpzXCI7aW1wb3J0e2dldFBvcnRhbCBhcyAkfWZyb21cIi4uL3BvcnRhbFV0aWxzLmpzXCI7aW1wb3J0e1NxbEV4cHJlc3Npb25BZGFwdGVkIGFzIHYsU3RyaW5nVG9Db2RlQWRhcHRlZCBhcyBQLEZpZWxkUmVuYW1lIGFzIFIsQWRhcHRlZEZlYXR1cmVTZXQgYXMgaixPcmlnaW5hbEZpZWxkIGFzIEN9ZnJvbVwiLi4vZmVhdHVyZXNldC9hY3Rpb25zL0FkYXB0ZWQuanNcIjtpbXBvcnQgTSBmcm9tXCIuLi9mZWF0dXJlc2V0L2FjdGlvbnMvQXR0cmlidXRlRmlsdGVyLmpzXCI7aW1wb3J0IE8gZnJvbVwiLi4vZmVhdHVyZXNldC9hY3Rpb25zL09yZGVyQnkuanNcIjtpbXBvcnQgayBmcm9tXCIuLi9mZWF0dXJlc2V0L2FjdGlvbnMvVG9wLmpzXCI7aW1wb3J0IHogZnJvbVwiLi4vZmVhdHVyZXNldC9zb3VyY2VzL0VtcHR5LmpzXCI7aW1wb3J0IEggZnJvbVwiLi4vZmVhdHVyZXNldC9zb3VyY2VzL0ZlYXR1cmVMYXllck1lbW9yeS5qc1wiO2ltcG9ydCBaIGZyb21cIi4uL2ZlYXR1cmVzZXQvc3VwcG9ydC9PcmRlcmJ5Q2xhdXNlLmpzXCI7aW1wb3J0e2Nsb25lRmllbGQgYXMgR31mcm9tXCIuLi9mZWF0dXJlc2V0L3N1cHBvcnQvc2hhcmVkLmpzXCI7aW1wb3J0e2lzU2luZ2xlRmllbGQgYXMgV31mcm9tXCIuLi9mZWF0dXJlc2V0L3N1cHBvcnQvc3FsVXRpbHMuanNcIjtpbXBvcnR7Y2FsY3VsYXRlU3RhdCBhcyBffWZyb21cIi4vZmllbGRTdGF0cy5qc1wiO2ltcG9ydHtpc1Byb21pc2VMaWtlIGFzIFV9ZnJvbVwiLi4vLi4vY29yZS9wcm9taXNlVXRpbHMuanNcIjtpbXBvcnR7V2hlcmVDbGF1c2UgYXMgQn1mcm9tXCIuLi8uLi9jb3JlL3NxbC9XaGVyZUNsYXVzZS5qc1wiO2ltcG9ydCBxIGZyb21cIi4uLy4uL2xheWVycy9GZWF0dXJlTGF5ZXIuanNcIjtpbXBvcnQgViBmcm9tXCIuLi8uLi9sYXllcnMvc3VwcG9ydC9GaWVsZC5qc1wiO2ltcG9ydCBRIGZyb21cIi4uLy4uL3BvcnRhbC9Qb3J0YWwuanNcIjtmdW5jdGlvbiBKKGUsdCxuLGkpe2lmKDE9PT1pLmxlbmd0aCl7aWYoYihpWzBdKSlyZXR1cm4gXyhlLGlbMF0sLTEpO2lmKEEoaVswXSkpcmV0dXJuIF8oZSxpWzBdLnRvQXJyYXkoKSwtMSl9cmV0dXJuIF8oZSxpLC0xKX1hc3luYyBmdW5jdGlvbiBLKGUsdCxuKXtjb25zdCBpPWUuZ2V0VmFyaWFibGVzKCk7aWYoaS5sZW5ndGg+MCl7Y29uc3QgYT1bXTtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKyl7Y29uc3Qgcj17bmFtZTppW2VdfTthLnB1c2goYXdhaXQgdC5ldmFsdWF0ZUlkZW50aWZpZXIobixyKSl9Y29uc3Qgcj17fTtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKylyW2lbZV1dPWFbZV07cmV0dXJuIGUucGFyYW1ldGVycz1yLGV9cmV0dXJuIGV9ZnVuY3Rpb24gWShlLHQsbj1udWxsKXtmb3IoY29uc3QgaSBpbiBlKWlmKGkudG9Mb3dlckNhc2UoKT09PXQudG9Mb3dlckNhc2UoKSlyZXR1cm4gZVtpXTtyZXR1cm4gbn1mdW5jdGlvbiBYKGUpe2lmKG51bGw9PT1lKXJldHVybiBudWxsO2NvbnN0IHQ9e3R5cGU6WShlLFwidHlwZVwiLFwiXCIpLG5hbWU6WShlLFwibmFtZVwiLFwiXCIpfTtpZihcInJhbmdlXCI9PT10LnR5cGUpdC5yYW5nZT1ZKGUsXCJyYW5nZVwiLFtdKTtlbHNle3QuY29kZWRWYWx1ZXM9W107Zm9yKGNvbnN0IG4gb2YgWShlLFwiY29kZWRWYWx1ZXNcIixbXSkpdC5jb2RlZFZhbHVlcy5wdXNoKHtuYW1lOlkobixcIm5hbWVcIixcIlwiKSxjb2RlOlkobixcImNvZGVcIixudWxsKX0pfXJldHVybiB0fWZ1bmN0aW9uIGVlKGUpe2lmKG51bGw9PT1lKXJldHVybiBudWxsO2NvbnN0IHQ9e30sbj1ZKGUsXCJ3a3RcIixudWxsKTtudWxsIT09biYmKHQud2t0PW4pO2NvbnN0IGk9WShlLFwid2tpZFwiLG51bGwpO3JldHVybiBudWxsIT09aSYmKHQud2tpZD1pKSx0fWZ1bmN0aW9uIHRlKGUpe2lmKG51bGw9PT1lKXJldHVybiBudWxsO2NvbnN0IHQ9e2hhc1o6WShlLFwiaGFzelwiLCExKSxoYXNNOlkoZSxcImhhc21cIiwhMSl9LG49WShlLFwic3BhdGlhbHJlZmVyZW5jZVwiLG51bGwpO24mJih0LnNwYXRpYWxSZWZlcmVuY2U9ZWUobikpO2NvbnN0IGk9WShlLFwieFwiLG51bGwpO2lmKG51bGwhPT1pKXJldHVybiB0Lng9aSx0Lnk9WShlLFwieVwiLG51bGwpLHQ7Y29uc3QgYT1ZKGUsXCJyaW5nc1wiLG51bGwpO2lmKG51bGwhPT1hKXJldHVybiB0LnJpbmdzPWEsdDtjb25zdCByPVkoZSxcInBhdGhzXCIsbnVsbCk7aWYobnVsbCE9PXIpcmV0dXJuIHQucGF0aHM9cix0O2NvbnN0IHM9WShlLFwicG9pbnRzXCIsbnVsbCk7aWYobnVsbCE9PXMpcmV0dXJuIHQucG9pbnRzPXMsdDtmb3IoY29uc3QgbCBvZltcInhtaW5cIixcInhtYXhcIixcInltaW5cIixcInltYXhcIixcInptaW5cIixcInptYXhcIixcIm1taW5cIixcIm1tYXhcIl0pe2NvbnN0IG49WShlLGwsbnVsbCk7bnVsbCE9PW4mJih0W2xdPW4pfXJldHVybiB0fWZ1bmN0aW9uIG5lKGUsdCl7Zm9yKGNvbnN0IG4gb2YgdClpZihuPT09ZSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBpZShlKXtyZXR1cm4hIWUubGF5ZXJEZWZpbml0aW9uJiYoISFlLmZlYXR1cmVTZXQmJighMSE9PW5lKGUubGF5ZXJEZWZpbml0aW9uLmdlb21ldHJ5VHlwZSxbXCJcIixudWxsLFwiZXNyaUdlb21ldHJ5TnVsbFwiLFwiZXNyaUdlb21ldHJ5UG9pbnRcIixcImVzcmlHZW9tZXRyeVBvbHlsaW5lXCIsXCJlc3JpR2VvbWV0cnlQb2x5Z29uXCIsXCJlc3JpR2VvbWV0cnlNdWx0aXBvaW50XCIsXCJlc3JpR2VvbWV0cnlFbnZlbG9wZVwiXSkmJighMSE9PWIoZS5sYXllckRlZmluaXRpb24uZmllbGRzKSYmITEhPT1iKGUuZmVhdHVyZVNldC5mZWF0dXJlcykpKSl9ZnVuY3Rpb24gYWUoXyl7XCJhc3luY1wiPT09Xy5tb2RlJiYoXy5mdW5jdGlvbnMudGltZXpvbmU9ZnVuY3Rpb24odCxyKXtyZXR1cm4gXy5zdGFuZGFyZEZ1bmN0aW9uQXN5bmModCxyLChhc3luYyhzLGwsbyk9PntpZihwKG8sMSwyLHQscikseShvWzBdKSl7aWYoYXdhaXQgb1swXS5sb2FkKCksMT09PW8ubGVuZ3RofHxudWxsPT09b1sxXSlyZXR1cm4gb1swXS5kYXRlVGltZVJlZmVyZW5jZUZpZWxkSW5kZXgubGF5ZXJEYXRlRmllbGRzVGltZVpvbmU7aWYoIShvWzFdaW5zdGFuY2VvZiBuKXx8ITE9PT1vWzFdLmhhc0ZpZWxkKFwidHlwZVwiKSl0aHJvdyBuZXcgaSh0LGEuSW52YWxpZFBhcmFtZXRlcixyKTtjb25zdCBlPW9bMV0uZmllbGQoXCJ0eXBlXCIpO2lmKCExPT09aChlKSl0aHJvdyBuZXcgaSh0LGEuSW52YWxpZFBhcmFtZXRlcixyKTtzd2l0Y2goZyhlKS50b0xvd2VyQ2FzZSgpKXtjYXNlXCJwcmVmZXJyZWR0aW1lem9uZVwiOnJldHVybiBvWzBdLmRhdGVUaW1lUmVmZXJlbmNlRmllbGRJbmRleC5sYXllclByZWZlcnJlZFRpbWVab25lO2Nhc2VcImVkaXRmaWVsZHNpbmZvXCI6cmV0dXJuIG9bMF0uZGF0ZVRpbWVSZWZlcmVuY2VGaWVsZEluZGV4LmxheWVyRWRpdEZpZWxkc1RpbWVab25lO2Nhc2VcInRpbWVpbmZvXCI6cmV0dXJuIG9bMF0uZGF0ZVRpbWVSZWZlcmVuY2VGaWVsZEluZGV4LmxheWVyVGltZUluZm9UaW1lWm9uZTtjYXNlXCJmaWVsZFwiOmlmKG9bMV0uaGFzRmllbGQoXCJmaWVsZG5hbWVcIikmJmgob1sxXS5maWVsZChcImZpZWxkbmFtZVwiKSkpcmV0dXJuIG9bMF0uZGF0ZVRpbWVSZWZlcmVuY2VGaWVsZEluZGV4LmZpZWxkVGltZVpvbmUoZyhvWzFdLmZpZWxkKFwiZmllbGRuYW1lXCIpKSl9dGhyb3cgbmV3IGkodCxhLkludmFsaWRQYXJhbWV0ZXIscil9Y29uc3QgZj13KG9bMF0sSSh0KSk7aWYobnVsbD09PWYpcmV0dXJuIG51bGw7Y29uc3QgdT1mLnRpbWVab25lO3JldHVyblwic3lzdGVtXCI9PT11P2Uuc3lzdGVtVGltZVpvbmVDYW5vbmljYWxOYW1lOnV9KSl9LF8uZnVuY3Rpb25zLnNxbHRpbWVzdGFtcD1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKG4scixzKT0+e3AocywxLDMsZSx0KTtjb25zdCBsPXNbMF07aWYoRihsKSl7aWYoMT09PXMubGVuZ3RoKXJldHVybiBsLnRvU1FMU3RyaW5nKCk7aWYoMj09PXMubGVuZ3RoKXJldHVybiBsLmNoYW5nZVRpbWVab25lKGcoc1sxXSkpLnRvU1FMU3RyaW5nKCk7dGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCl9aWYoeShsKSl7aWYoMyE9PXMubGVuZ3RoKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2F3YWl0IGwubG9hZCgpO2NvbnN0IG49ZyhzWzFdKTtpZighMT09PUYoc1syXSkpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7Y29uc3Qgcj1sLmZpZWxkVGltZVpvbmUobik7cmV0dXJuIG51bGw9PT1yP3NbMl0udG9TUUxTdHJpbmcoKTpzWzJdLmNoYW5nZVRpbWVab25lKHIpLnRvU1FMU3RyaW5nKCl9dGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCl9KSl9LF8uc2lnbmF0dXJlcy5wdXNoKHtuYW1lOlwic3FsdGltZXN0YW1wXCIsbWluOjIsbWF4OjR9KSxfLmZ1bmN0aW9ucy5mZWF0dXJlc2V0YnlpZD1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKChuLHIsbCk9PntpZihwKGwsMiw0LGUsdCksbFswXWluc3RhbmNlb2Ygcyl7Y29uc3Qgbj1nKGxbMV0pO2xldCByPUQobFsyXSxudWxsKTtjb25zdCBzPUUoRChsWzNdLCEwKSk7aWYobnVsbD09PXImJihyPVtcIipcIl0pLCExPT09YihyKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KTtyZXR1cm4gbFswXS5mZWF0dXJlU2V0QnlJZChuLHMscil9dGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCl9KSl9LF8uc2lnbmF0dXJlcy5wdXNoKHtuYW1lOlwiZmVhdHVyZXNldGJ5aWRcIixtaW46MixtYXg6NH0pLF8uZnVuY3Rpb25zLmdldGZlYXR1cmVzZXQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gXy5zdGFuZGFyZEZ1bmN0aW9uQXN5bmMoZSx0LCgobixyLHMpPT57aWYocChzLDEsMixlLHQpLHgoc1swXSkpe2xldCB0PUQoc1sxXSxcImRhdGFzb3VyY2VcIik7cmV0dXJuIG51bGw9PT10JiYodD1cImRhdGFzb3VyY2VcIiksdD1nKHQpLnRvTG93ZXJDYXNlKCksbChzWzBdLmZ1bGxTY2hlbWEoKSx0LGUubHJ1Y2FjaGUsZS5pbnRlcmNlcHRvcixlLnNwYXRpYWxSZWZlcmVuY2UpfXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImdldGZlYXR1cmVzZXRcIixtaW46MSxtYXg6Mn0pLF8uZnVuY3Rpb25zLmZlYXR1cmVzZXRieXBvcnRhbGl0ZW09ZnVuY3Rpb24oZSxuKXtyZXR1cm4gXy5zdGFuZGFyZEZ1bmN0aW9uQXN5bmMoZSxuLCgocixzLGwpPT57aWYocChsLDIsNSxlLG4pLG51bGw9PT1sWzBdKXRocm93IG5ldyBpKGUsYS5Qb3J0YWxSZXF1aXJlZCxuKTtpZihsWzBdaW5zdGFuY2VvZiB0KXtjb25zdCB0PWcobFsxXSkscj1nKGxbMl0pO2xldCBzPUQobFszXSxudWxsKTtjb25zdCBmPUUoRChsWzRdLCEwKSk7aWYobnVsbD09PXMmJihzPVtcIipcIl0pLCExPT09YihzKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcixuKTtsZXQgdT1udWxsO3JldHVybiB1PWUuc2VydmljZXMmJmUuc2VydmljZXMucG9ydGFsP2Uuc2VydmljZXMucG9ydGFsOlEuZ2V0RGVmYXVsdCgpLHU9JChsWzBdLHUpLG8odCxyLGUuc3BhdGlhbFJlZmVyZW5jZSxzLGYsdSxlLmxydWNhY2hlLGUuaW50ZXJjZXB0b3IpfWlmKCExPT09aChsWzBdKSl0aHJvdyBuZXcgaShlLGEuUG9ydGFsUmVxdWlyZWQsbik7Y29uc3QgZj1nKGxbMF0pLHU9ZyhsWzFdKTtsZXQgYz1EKGxbMl0sbnVsbCk7Y29uc3QgZD1FKEQobFszXSwhMCkpO2lmKG51bGw9PT1jJiYoYz1bXCIqXCJdKSwhMT09PWIoYykpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsbik7cmV0dXJuIG8oZix1LGUuc3BhdGlhbFJlZmVyZW5jZSxjLGQsZS5zZXJ2aWNlcz8ucG9ydGFsPz9RLmdldERlZmF1bHQoKSxlLmxydWNhY2hlLGUuaW50ZXJjZXB0b3IpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZlYXR1cmVzZXRieXBvcnRhbGl0ZW1cIixtaW46MixtYXg6NX0pLF8uZnVuY3Rpb25zLmZlYXR1cmVzZXRieW5hbWU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gXy5zdGFuZGFyZEZ1bmN0aW9uQXN5bmMoZSx0LCgobixyLGwpPT57aWYocChsLDIsNCxlLHQpLGxbMF1pbnN0YW5jZW9mIHMpe2NvbnN0IG49ZyhsWzFdKTtsZXQgcj1EKGxbMl0sbnVsbCk7Y29uc3Qgcz1FKEQobFszXSwhMCkpO2lmKG51bGw9PT1yJiYocj1bXCIqXCJdKSwhMT09PWIocikpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7cmV0dXJuIGxbMF0uZmVhdHVyZVNldEJ5TmFtZShuLHMscil9dGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCl9KSl9LF8uc2lnbmF0dXJlcy5wdXNoKHtuYW1lOlwiZmVhdHVyZXNldGJ5bmFtZVwiLG1pbjoyLG1heDo0fSksXy5mdW5jdGlvbnMuZmVhdHVyZXNldD1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb24oZSx0LCgocixzLGwpPT57cChsLDEsMSxlLHQpO2xldCBvPWxbMF07Y29uc3QgZj17bGF5ZXJEZWZpbml0aW9uOntnZW9tZXRyeVR5cGU6XCJcIixvYmplY3RJZEZpZWxkOlwiXCIsaGFzTTohMSxoYXNaOiExLGdsb2JhbElkRmllbGQ6XCJcIix0eXBlSWRGaWVsZDpcIlwiLGZpZWxkczpbXX0sZmVhdHVyZVNldDp7Z2VvbWV0cnlUeXBlOlwiXCIsZmVhdHVyZXM6W119fTtpZihoKG8pKW89SlNPTi5wYXJzZShvKSx2b2lkIDAhPT1vLmxheWVyRGVmaW5pdGlvbj8oZi5sYXllckRlZmluaXRpb249by5sYXllckRlZmluaXRpb24sZi5mZWF0dXJlU2V0PW8uZmVhdHVyZVNldCxvLmxheWVyRGVmaW5pdGlvbi5zcGF0aWFsUmVmZXJlbmNlJiYoZi5sYXllckRlZmluaXRpb24uc3BhdGlhbFJlZmVyZW5jZT1vLmxheWVyRGVmaW5pdGlvbi5zcGF0aWFsUmVmZXJlbmNlKSk6KGYuZmVhdHVyZVNldC5mZWF0dXJlcz1vLmZlYXR1cmVzLGYuZmVhdHVyZVNldC5nZW9tZXRyeVR5cGU9by5nZW9tZXRyeVR5cGUsZi5sYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlPWYuZmVhdHVyZVNldC5nZW9tZXRyeVR5cGUsZi5sYXllckRlZmluaXRpb24ub2JqZWN0SWRGaWVsZD1vLm9iamVjdElkRmllbGROYW1lPz9cIlwiLGYubGF5ZXJEZWZpbml0aW9uLnR5cGVJZEZpZWxkPW8udHlwZUlkRmllbGROYW1lLGYubGF5ZXJEZWZpbml0aW9uLmdsb2JhbElkRmllbGQ9by5nbG9iYWxJZEZpZWxkTmFtZSxmLmxheWVyRGVmaW5pdGlvbi5maWVsZHM9by5maWVsZHMsby5zcGF0aWFsUmVmZXJlbmNlJiYoZi5sYXllckRlZmluaXRpb24uc3BhdGlhbFJlZmVyZW5jZT1vLnNwYXRpYWxSZWZlcmVuY2UpKTtlbHNle2lmKCEobFswXWluc3RhbmNlb2YgbikpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7e289SlNPTi5wYXJzZShsWzBdLmNhc3RUb1RleHQoITApKTtjb25zdCBlPVkobyxcImxheWVyZGVmaW5pdGlvblwiKTtpZihudWxsIT09ZSl7Zi5sYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlPVkoZSxcImdlb21ldHJ5dHlwZVwiLFwiXCIpLGYuZmVhdHVyZVNldC5nZW9tZXRyeVR5cGU9Zi5sYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlLGYubGF5ZXJEZWZpbml0aW9uLmdsb2JhbElkRmllbGQ9WShlLFwiZ2xvYmFsaWRmaWVsZFwiLFwiXCIpLGYubGF5ZXJEZWZpbml0aW9uLm9iamVjdElkRmllbGQ9WShlLFwib2JqZWN0aWRmaWVsZFwiLFwiXCIpLGYubGF5ZXJEZWZpbml0aW9uLnR5cGVJZEZpZWxkPVkoZSxcInR5cGVpZGZpZWxkXCIsXCJcIiksZi5sYXllckRlZmluaXRpb24uaGFzWj0hMD09PVkoZSxcImhhc3pcIiwhMSksZi5sYXllckRlZmluaXRpb24uaGFzTT0hMD09PVkoZSxcImhhc21cIiwhMSk7Y29uc3QgdD1ZKGUsXCJzcGF0aWFscmVmZXJlbmNlXCIsbnVsbCk7dCYmKGYubGF5ZXJEZWZpbml0aW9uLnNwYXRpYWxSZWZlcmVuY2U9ZWUodCkpO2Zvcihjb25zdCBpIG9mIFkoZSxcImZpZWxkc1wiLFtdKSl7Y29uc3QgZT17bmFtZTpZKGksXCJuYW1lXCIsXCJcIiksYWxpYXM6WShpLFwiYWxpYXNcIixcIlwiKSx0eXBlOlkoaSxcInR5cGVcIixcIlwiKSxudWxsYWJsZTpZKGksXCJudWxsYWJsZVwiLCEwKSxlZGl0YWJsZTpZKGksXCJlZGl0YWJsZVwiLCEwKSxsZW5ndGg6WShpLFwibGVuZ3RoXCIsbnVsbCksZG9tYWluOlgoWShpLFwiZG9tYWluXCIpKX07Zi5sYXllckRlZmluaXRpb24uZmllbGRzLnB1c2goZSl9Y29uc3Qgbj1ZKG8sXCJmZWF0dXJlc2V0XCIsbnVsbCk7aWYobil7Y29uc3QgZT17fTtmb3IoY29uc3QgdCBvZiBmLmxheWVyRGVmaW5pdGlvbi5maWVsZHMpZVt0Lm5hbWUudG9Mb3dlckNhc2UoKV09dC5uYW1lO2Zvcihjb25zdCB0IG9mIFkobixcImZlYXR1cmVzXCIsW10pKXtjb25zdCBuPXt9LGk9WSh0LFwiYXR0cmlidXRlc1wiLHt9KTtmb3IoY29uc3QgdCBpbiBpKW5bZVt0LnRvTG93ZXJDYXNlKCldXT1pW3RdO2YuZmVhdHVyZVNldC5mZWF0dXJlcy5wdXNoKHthdHRyaWJ1dGVzOm4sZ2VvbWV0cnk6dGUoWSh0LFwiZ2VvbWV0cnlcIixudWxsKSl9KX19fWVsc2V7Zi5sYXllckRlZmluaXRpb24uaGFzWj0hMD09PVkobyxcImhhc3pcIiwhMSksZi5sYXllckRlZmluaXRpb24uaGFzTT0hMD09PVkobyxcImhhc21cIiwhMSksZi5sYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlPVkobyxcImdlb21ldHJ5dHlwZVwiLFwiXCIpLGYuZmVhdHVyZVNldC5nZW9tZXRyeVR5cGU9Zi5sYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlLGYubGF5ZXJEZWZpbml0aW9uLm9iamVjdElkRmllbGQ9WShvLFwib2JqZWN0aWRmaWVsZG5hbWVcIixcIlwiKSxmLmxheWVyRGVmaW5pdGlvbi50eXBlSWRGaWVsZD1ZKG8sXCJ0eXBlaWRmaWVsZG5hbWVcIixcIlwiKTtjb25zdCBlPVkobyxcInNwYXRpYWxyZWZlcmVuY2VcIixudWxsKTtlJiYoZi5sYXllckRlZmluaXRpb24uc3BhdGlhbFJlZmVyZW5jZT1lZShlKSk7bGV0IHQ9WShvLFwiZmllbGRzXCIsbnVsbCk7aWYoYih0KSlmb3IoY29uc3QgYSBvZiB0KXtjb25zdCBlPXtuYW1lOlkoYSxcIm5hbWVcIixcIlwiKSxhbGlhczpZKGEsXCJhbGlhc1wiLFwiXCIpLHR5cGU6WShhLFwidHlwZVwiLFwiXCIpLG51bGxhYmxlOlkoYSxcIm51bGxhYmxlXCIsITApLGVkaXRhYmxlOlkoYSxcImVkaXRhYmxlXCIsITApLGxlbmd0aDpZKGEsXCJsZW5ndGhcIixudWxsKSxkb21haW46WChZKGEsXCJkb21haW5cIikpfTtmLmxheWVyRGVmaW5pdGlvbi5maWVsZHMucHVzaChlKX1lbHNlIHQ9bnVsbCxmLmxheWVyRGVmaW5pdGlvbi5maWVsZHM9dDtjb25zdCBuPXt9O2Zvcihjb25zdCBhIG9mIGYubGF5ZXJEZWZpbml0aW9uLmZpZWxkcyluW2EubmFtZS50b0xvd2VyQ2FzZSgpXT1hLm5hbWU7bGV0IGk9WShvLFwiZmVhdHVyZXNcIixudWxsKTtpZihiKGkpKWZvcihjb25zdCBhIG9mIGkpe2NvbnN0IGU9e30sdD1ZKGEsXCJhdHRyaWJ1dGVzXCIse30pO2Zvcihjb25zdCBpIGluIHQpZVtuW2kudG9Mb3dlckNhc2UoKV1dPXRbaV07Zi5mZWF0dXJlU2V0LmZlYXR1cmVzLnB1c2goe2F0dHJpYnV0ZXM6ZSxnZW9tZXRyeTp0ZShZKGEsXCJnZW9tZXRyeVwiLG51bGwpKX0pfWVsc2UgaT1udWxsLGYuZmVhdHVyZVNldC5mZWF0dXJlcz1pfX19aWYoITE9PT1pZShmKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KTtyZXR1cm5cIlwiPT09KGY/LmxheWVyRGVmaW5pdGlvbj8uZ2VvbWV0cnlUeXBlfHxcIlwiKSYmKGYubGF5ZXJEZWZpbml0aW9uLmdlb21ldHJ5VHlwZT1cImVzcmlHZW9tZXRyeU51bGxcIiksSC5jcmVhdGUoZixlLnNwYXRpYWxSZWZlcmVuY2UpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZlYXR1cmVzZXRcIixtaW46MSxtYXg6MX0pLF8uZnVuY3Rpb25zLmZpbHRlcj1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKG4scixzKT0+e2lmKHAocywyLDIsZSx0KSxiKHNbMF0pfHxBKHNbMF0pKXtjb25zdCBuPVtdO2xldCByPXNbMF07ciBpbnN0YW5jZW9mIG0mJihyPXIudG9BcnJheSgpKTtsZXQgbD1udWxsO2lmKCFOKHNbMV0pKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2w9c1sxXS5jcmVhdGVGdW5jdGlvbihlKTtmb3IoY29uc3QgZSBvZiByKXtjb25zdCB0PWwoZSk7VSh0KT8hMD09PWF3YWl0IHQmJm4ucHVzaChlKTohMD09PXQmJm4ucHVzaChlKX1yZXR1cm4gbn1pZih5KHNbMF0pKXtjb25zdCB0PWF3YWl0IHNbMF0ubG9hZCgpLG49Qi5jcmVhdGUoc1sxXSx0LmdldEZpZWxkc0luZGV4KCkpLGk9bi5nZXRWYXJpYWJsZXMoKTtpZihpLmxlbmd0aD4wKXtjb25zdCB0PVtdO2ZvcihsZXQgbj0wO248aS5sZW5ndGg7bisrKXtjb25zdCBhPXtuYW1lOmlbbl19O3QucHVzaChhd2FpdCBfLmV2YWx1YXRlSWRlbnRpZmllcihlLGEpKX1jb25zdCBhPXt9O2ZvcihsZXQgZT0wO2U8aS5sZW5ndGg7ZSsrKWFbaVtlXV09dFtlXTtyZXR1cm4gbi5wYXJhbWV0ZXJzPWEsbmV3IE0oe3BhcmVudGZlYXR1cmVzZXQ6c1swXSx3aGVyZWNsYXVzZTpufSl9cmV0dXJuIG5ldyBNKHtwYXJlbnRmZWF0dXJlc2V0OnNbMF0sd2hlcmVjbGF1c2U6bn0pfXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZpbHRlclwiLG1pbjoyLG1heDoyfSksXy5mdW5jdGlvbnMub3JkZXJieT1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKG4scixzKT0+e2lmKHAocywyLDIsZSx0KSx5KHNbMF0pKXtjb25zdCBlPW5ldyBaKHNbMV0pO3JldHVybiBuZXcgTyh7cGFyZW50ZmVhdHVyZXNldDpzWzBdLG9yZGVyYnljbGF1c2U6ZX0pfXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcIm9yZGVyYnlcIixtaW46MixtYXg6Mn0pLF8uZnVuY3Rpb25zLnRvcD1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKG4scixzKT0+e2lmKHAocywyLDIsZSx0KSx5KHNbMF0pKXJldHVybiBuZXcgayh7cGFyZW50ZmVhdHVyZXNldDpzWzBdLHRvcG51bTpzWzFdfSk7aWYoYihzWzBdKSlyZXR1cm4gUyhzWzFdKT49c1swXS5sZW5ndGg/c1swXS5zbGljZSgwKTpzWzBdLnNsaWNlKDAsUyhzWzFdKSk7aWYoQShzWzBdKSlyZXR1cm4gUyhzWzFdKT49c1swXS5sZW5ndGgoKT9zWzBdLnNsaWNlKDApOnNbMF0uc2xpY2UoMCxTKHNbMV0pKTt0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KX0pKX0sXy5zaWduYXR1cmVzLnB1c2goe25hbWU6XCJ0b3BcIixtaW46MixtYXg6Mn0pLF8uZnVuY3Rpb25zLmZpcnN0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8uc3RhbmRhcmRGdW5jdGlvbkFzeW5jKGUsdCwoYXN5bmMobixpLGEpPT57aWYocChhLDEsMSxlLHQpLHkoYVswXSkpe2NvbnN0IHQ9YXdhaXQgYVswXS5maXJzdChuLmFib3J0U2lnbmFsKTtpZihudWxsIT09dCl7Y29uc3Qgbj1yLmNyZWF0ZUZyb21HcmFwaGljTGlrZU9iamVjdCh0Lmdlb21ldHJ5LHQuYXR0cmlidXRlcyxhWzBdLGUudGltZVJlZmVyZW5jZSk7cmV0dXJuIG4uX3VuZGVybHlpbmdHcmFwaGljPXQsbn1yZXR1cm4gdH1yZXR1cm4gYihhWzBdKT8wPT09YVswXS5sZW5ndGg/bnVsbDphWzBdWzBdOkEoYVswXSk/MD09PWFbMF0ubGVuZ3RoKCk/bnVsbDphWzBdLmdldCgwKTpudWxsfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZpcnN0XCIsbWluOjEsbWF4OjF9KSxfLmZ1bmN0aW9ucy5hdHRhY2htZW50cz1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKHIscyxsKT0+e3AobCwxLDIsZSx0KTtjb25zdCBvPXttaW5zaXplOi0xLG1heHNpemU6LTEsdHlwZXM6bnVsbCxyZXR1cm5NZXRhZGF0YTohMX07aWYobC5sZW5ndGg+MSlpZihsWzFdaW5zdGFuY2VvZiBuKXtpZihsWzFdLmhhc0ZpZWxkKFwibWluc2l6ZVwiKSYmKG8ubWluc2l6ZT1TKGxbMV0uZmllbGQoXCJtaW5zaXplXCIpKSksbFsxXS5oYXNGaWVsZChcIm1ldGFkYXRhXCIpJiYoby5yZXR1cm5NZXRhZGF0YT1FKGxbMV0uZmllbGQoXCJtZXRhZGF0YVwiKSkpLGxbMV0uaGFzRmllbGQoXCJtYXhzaXplXCIpJiYoby5tYXhzaXplPVMobFsxXS5maWVsZChcIm1heHNpemVcIikpKSxsWzFdLmhhc0ZpZWxkKFwidHlwZXNcIikpe2NvbnN0IGU9VChsWzFdLmZpZWxkKFwidHlwZXNcIiksITEpO2UubGVuZ3RoPjAmJihvLnR5cGVzPWUpfX1lbHNlIGlmKG51bGwhPT1sWzFdKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2lmKHgobFswXSkpe2xldCB0PWxbMF0uX2xheWVyO3JldHVybiB0IGluc3RhbmNlb2YgcSYmKHQ9Zih0LGUuc3BhdGlhbFJlZmVyZW5jZSxbXCIqXCJdLCEwLGUubHJ1Y2FjaGUsZS5pbnRlcmNlcHRvcikpLG51bGw9PT10P1tdOiExPT09eSh0KT9bXTooYXdhaXQgdC5sb2FkKCksdC5xdWVyeUF0dGFjaG1lbnRzKGxbMF0uZmllbGQodC5vYmplY3RJZEZpZWxkKSxvLm1pbnNpemUsby5tYXhzaXplLG8udHlwZXMsby5yZXR1cm5NZXRhZGF0YSkpfWlmKG51bGw9PT1sWzBdKXJldHVybltdO3Rocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImF0dGFjaG1lbnRzXCIsbWluOjEsbWF4OjJ9KSxfLmZ1bmN0aW9ucy5mZWF0dXJlc2V0YnlyZWxhdGlvbnNoaXBuYW1lPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8uc3RhbmRhcmRGdW5jdGlvbkFzeW5jKGUsdCwoYXN5bmMobixyLHMpPT57cChzLDIsNCxlLHQpO2NvbnN0IGw9c1swXSxvPWcoc1sxXSk7bGV0IGQ9RChzWzJdLG51bGwpO2NvbnN0IG09RShEKHNbM10sITApKTtpZihudWxsPT09ZCYmKGQ9W1wiKlwiXSksITE9PT1iKGQpKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2lmKG51bGw9PT1zWzBdKXJldHVybiBudWxsO2lmKCF4KHNbMF0pKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2xldCBoPWwuX2xheWVyO2lmKGggaW5zdGFuY2VvZiBxJiYoaD1mKGgsZS5zcGF0aWFsUmVmZXJlbmNlLFtcIipcIl0sITAsZS5scnVjYWNoZSxlLmludGVyY2VwdG9yKSksbnVsbD09PWgpcmV0dXJuIG51bGw7aWYoITE9PT15KGgpKXJldHVybiBudWxsO2g9YXdhaXQgaC5sb2FkKCk7Y29uc3Qgdz1oLnJlbGF0aW9uc2hpcE1ldGFEYXRhKCkuZmlsdGVyKChlPT5lLm5hbWU9PT1vKSk7aWYoMD09PXcubGVuZ3RoKXJldHVybiBudWxsO2lmKHZvaWQgMCE9PXdbMF0ucmVsYXRpb25zaGlwVGFibGVJZCYmbnVsbCE9PXdbMF0ucmVsYXRpb25zaGlwVGFibGVJZCYmd1swXS5yZWxhdGlvbnNoaXBUYWJsZUlkPi0xKXJldHVybiB1KGgsd1swXSxsLmZpZWxkKGgub2JqZWN0SWRGaWVsZCksaC5zcGF0aWFsUmVmZXJlbmNlLGQsbSxlLmxydWNhY2hlLGUuaW50ZXJjZXB0b3IpO2xldCBJPWguc2VydmljZVVybCgpO2lmKCFJKXJldHVybiBudWxsO0k9XCIvXCI9PT1JLmNoYXJBdChJLmxlbmd0aC0xKT9JK3dbMF0ucmVsYXRlZFRhYmxlSWQudG9TdHJpbmcoKTpJK1wiL1wiK3dbMF0ucmVsYXRlZFRhYmxlSWQudG9TdHJpbmcoKTtjb25zdCBGPWF3YWl0IGMoSSxoLnNwYXRpYWxSZWZlcmVuY2UsZCxtLGUubHJ1Y2FjaGUsZS5pbnRlcmNlcHRvcik7YXdhaXQgRi5sb2FkKCk7bGV0IEE9Ri5yZWxhdGlvbnNoaXBNZXRhRGF0YSgpO2lmKEE9QS5maWx0ZXIoKGU9PmUuaWQ9PT13WzBdLmlkKSksITE9PT1sLmhhc0ZpZWxkKHdbMF0ua2V5RmllbGQpfHxudWxsPT09bC5maWVsZCh3WzBdLmtleUZpZWxkKSl7Y29uc3QgZT1hd2FpdCBoLmdldEZlYXR1cmVCeU9iamVjdElkKGwuZmllbGQoaC5vYmplY3RJZEZpZWxkKSxbd1swXS5rZXlGaWVsZF0pO2lmKGUpe2NvbnN0IHQ9Qi5jcmVhdGUoQVswXS5rZXlGaWVsZCtcIj0gQGlkXCIsRi5nZXRGaWVsZHNJbmRleCgpKTtyZXR1cm4gdC5wYXJhbWV0ZXJzPXtpZDplLmF0dHJpYnV0ZXNbd1swXS5rZXlGaWVsZF19LEYuZmlsdGVyKHQpfXJldHVybiBuZXcgeih7cGFyZW50ZmVhdHVyZXNldDpGfSl9Y29uc3QgTj1CLmNyZWF0ZShBWzBdLmtleUZpZWxkK1wiPSBAaWRcIixGLmdldEZpZWxkc0luZGV4KCkpO3JldHVybiBOLnBhcmFtZXRlcnM9e2lkOmwuZmllbGQod1swXS5rZXlGaWVsZCl9LEYuZmlsdGVyKE4pfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZlYXR1cmVzZXRieXJlbGF0aW9uc2hpcG5hbWVcIixtaW46MixtYXg6NH0pLF8uZnVuY3Rpb25zLmZlYXR1cmVzZXRieWFzc29jaWF0aW9uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8uc3RhbmRhcmRGdW5jdGlvbkFzeW5jKGUsdCwoYXN5bmMobixyLHMpPT57cChzLDIsMyxlLHQpO2NvbnN0IGw9c1swXSxvPWcoRChzWzFdLFwiXCIpKS50b0xvd2VyQ2FzZSgpLHU9aChzWzJdKT9nKHNbMl0pOm51bGw7aWYobnVsbD09PXNbMF0pcmV0dXJuIG51bGw7aWYoIXgoc1swXSkpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7bGV0IGM9bC5fbGF5ZXI7aWYoYyBpbnN0YW5jZW9mIHEmJihjPWYoYyxlLnNwYXRpYWxSZWZlcmVuY2UsW1wiKlwiXSwhMCxlLmxydWNhY2hlLGUuaW50ZXJjZXB0b3IpKSxudWxsPT09YylyZXR1cm4gbnVsbDtpZighMT09PXkoYykpcmV0dXJuIG51bGw7YXdhaXQgYy5sb2FkKCk7Y29uc3QgbT1jLnNlcnZpY2VVcmwoKSx3PWF3YWl0IGQobSxlLnNwYXRpYWxSZWZlcmVuY2UpO2xldCBJPW51bGwsRj1udWxsLEU9ITE7aWYobnVsbCE9PXUmJlwiXCIhPT11JiZ2b2lkIDAhPT11KXtmb3IoY29uc3QgZSBvZiB3LnRlcm1pbmFscyllLnRlcm1pbmFsTmFtZT09PXUmJihGPWUudGVybWluYWxJZCk7bnVsbD09PUYmJihFPSEwKX1jb25zdCBiPXcuYXNzb2NpYXRpb25zLmdldEZpZWxkc0luZGV4KCksQT1iLmdldChcIlRPR0xPQkFMSURcIikubmFtZSxOPWIuZ2V0KFwiRlJPTUdMT0JBTElEXCIpLm5hbWUsUz1iLmdldChcIlRPVEVSTUlOQUxJRFwiKS5uYW1lLFQ9Yi5nZXQoXCJGUk9NVEVSTUlOQUxJRFwiKS5uYW1lLCQ9Yi5nZXQoXCJGUk9NTkVUV09SS1NPVVJDRUlEXCIpLm5hbWUsTT1iLmdldChcIlRPTkVUV09SS1NPVVJDRUlEXCIpLm5hbWUsTz1iLmdldChcIkFTU09DSUFUSU9OVFlQRVwiKS5uYW1lLGs9Yi5nZXQoXCJJU0NPTlRFTlRWSVNJQkxFXCIpLm5hbWUsej1iLmdldChcIk9CSkVDVElEXCIpLm5hbWU7Zm9yKGNvbnN0IGUgb2YgYy5maWVsZHMpaWYoXCJnbG9iYWwtaWRcIj09PWUudHlwZSl7ST1sLmZpZWxkKGUubmFtZSk7YnJlYWt9bGV0IEg9bnVsbCxaPW5ldyB2KG5ldyBWKHtuYW1lOlwicGVyY2VudGFsb25nXCIsYWxpYXM6XCJwZXJjZW50YWxvbmdcIix0eXBlOlwiZG91YmxlXCJ9KSxCLmNyZWF0ZShcIjBcIix3LmFzc29jaWF0aW9ucy5nZXRGaWVsZHNJbmRleCgpKSksVz1uZXcgdihuZXcgVih7bmFtZTpcInNpZGVcIixhbGlhczpcInNpZGVcIix0eXBlOlwic3RyaW5nXCJ9KSxCLmNyZWF0ZShcIicnXCIsdy5hc3NvY2lhdGlvbnMuZ2V0RmllbGRzSW5kZXgoKSkpO2NvbnN0IF89XCJnbG9iYWxpZFwiLFU9XCJnbG9iYWxJZFwiLFE9e307Zm9yKGNvbnN0IGUgaW4gdy5sa3ApUVtlXT13LmxrcFtlXS5zb3VyY2VJZDtjb25zdCBKPW5ldyBQKG5ldyBWKHtuYW1lOlwiY2xhc3NuYW1lXCIsYWxpYXM6XCJjbGFzc25hbWVcIix0eXBlOlwic3RyaW5nXCJ9KSxudWxsLFEpO2xldCBLPVwiXCI7c3dpdGNoKG8pe2Nhc2VcIm1pZHNwYW5cIjp7Sz1gKCgke0F9PScke0l9JykgT1IgKCAke059PScke0l9JykpIEFORCAoJHtPfSBJTiAoNSkpYCxKLmNvZGVmaWVsZD1CLmNyZWF0ZShgQ0FTRSBXSEVOICgke0F9PScke0l9JykgVEhFTiAkeyR9IEVMU0UgJHtNfSBFTkRgLHcuYXNzb2NpYXRpb25zLmdldEZpZWxkc0luZGV4KCkpO2NvbnN0IGU9RyhqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsTikpO2UubmFtZT1fLGUuYWxpYXM9XyxIPW5ldyB2KGUsQi5jcmVhdGUoYENBU0UgV0hFTiAoJHtOfT0nJHtJfScpIFRIRU4gJHtBfSBFTFNFICR7Tn0gRU5EYCx3LmFzc29jaWF0aW9ucy5nZXRGaWVsZHNJbmRleCgpKSksWj13LnVuVmVyc2lvbj49ND9uZXcgQyhqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsYi5nZXQoXCJQRVJDRU5UQUxPTkdcIikubmFtZSkpOm5ldyB2KG5ldyBWKHtuYW1lOlwicGVyY2VudGFsb25nXCIsYWxpYXM6XCJwZXJjZW50YWxvbmdcIix0eXBlOlwiZG91YmxlXCJ9KSxCLmNyZWF0ZShcIjBcIix3LmFzc29jaWF0aW9ucy5nZXRGaWVsZHNJbmRleCgpKSk7YnJlYWt9Y2FzZVwianVuY3Rpb25lZGdlXCI6e0s9YCgoJHtBfT0nJHtJfScpIE9SICggJHtOfT0nJHtJfScpKSBBTkQgKCR7T30gSU4gKDQsNikpYCxKLmNvZGVmaWVsZD1CLmNyZWF0ZShgQ0FTRSBXSEVOICgke0F9PScke0l9JykgVEhFTiAkeyR9IEVMU0UgJHtNfSBFTkRgLHcuYXNzb2NpYXRpb25zLmdldEZpZWxkc0luZGV4KCkpO2NvbnN0IGU9RyhqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsTikpO2UubmFtZT1fLGUuYWxpYXM9XyxIPW5ldyB2KGUsQi5jcmVhdGUoYENBU0UgV0hFTiAoJHtOfT0nJHtJfScpIFRIRU4gJHtBfSBFTFNFICR7Tn0gRU5EYCx3LmFzc29jaWF0aW9ucy5nZXRGaWVsZHNJbmRleCgpKSksVz1uZXcgdihuZXcgVih7bmFtZTpcInNpZGVcIixhbGlhczpcInNpZGVcIix0eXBlOlwic3RyaW5nXCJ9KSxCLmNyZWF0ZShgQ0FTRSBXSEVOICgke099PTQpIFRIRU4gJ2Zyb20nIEVMU0UgJ3RvJyBFTkRgLHcuYXNzb2NpYXRpb25zLmdldEZpZWxkc0luZGV4KCkpKTticmVha31jYXNlXCJjb25uZWN0ZWRcIjp7bGV0IGU9YCR7QX09J0BUJ2AsdD1gJHtOfT0nQFQnYDtudWxsIT09RiYmKGUrPWAgQU5EICR7U309QEFgLHQrPWAgQU5EICR7VH09QEFgKSxLPVwiKChcIitlK1wiKSBPUiAoXCIrdCtcIikpXCIsSz1MKEssXCJAVFwiLEk/P1wiXCIpLGU9TChlLFwiQFRcIixJPz9cIlwiKSxudWxsIT09RiYmKGU9TChlLFwiQEFcIixGLnRvU3RyaW5nKCkpLEs9TChLLFwiQEFcIixGLnRvU3RyaW5nKCkpKSxKLmNvZGVmaWVsZD1CLmNyZWF0ZShcIkNBU0UgV0hFTiBcIitlK2AgVEhFTiAkeyR9IEVMU0UgJHtNfSBFTkRgLHcuYXNzb2NpYXRpb25zLmdldEZpZWxkc0luZGV4KCkpO2NvbnN0IG49RyhqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsTikpO24ubmFtZT1fLG4uYWxpYXM9XyxIPW5ldyB2KG4sQi5jcmVhdGUoXCJDQVNFIFdIRU4gXCIrZStgIFRIRU4gJHtOfSBFTFNFICR7QX0gRU5EYCx3LmFzc29jaWF0aW9ucy5nZXRGaWVsZHNJbmRleCgpKSk7YnJlYWt9Y2FzZVwiY29udGFpbmVyXCI6Sz1gJHtBfT0nJHtJfScgQU5EICR7T30gPSAyYCxudWxsIT09RiYmKEsrPWAgQU5EICR7U30gPSBgK0YudG9TdHJpbmcoKSksSi5jb2RlZmllbGQ9JCxLPVwiKCBcIitLK1wiIClcIixIPW5ldyBSKGouZmluZEZpZWxkKHcuYXNzb2NpYXRpb25zLmZpZWxkcyxOKSxfLF8pO2JyZWFrO2Nhc2VcImNvbnRlbnRcIjpLPWAoJHtOfT0nJHtJfScgQU5EICR7T30gPSAyKWAsbnVsbCE9PUYmJihLKz1gIEFORCAke1R9ID0gYCtGLnRvU3RyaW5nKCkpLEouY29kZWZpZWxkPU0sSz1cIiggXCIrSytcIiApXCIsSD1uZXcgUihqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsQSksXyxfKTticmVhaztjYXNlXCJzdHJ1Y3R1cmVcIjpLPWAoJHtBfT0nJHtJfScgQU5EICR7T30gPSAzKWAsbnVsbCE9PUYmJihLKz1gIEFORCAke1N9ID0gYCtGLnRvU3RyaW5nKCkpLEouY29kZWZpZWxkPSQsSz1cIiggXCIrSytcIiApXCIsSD1uZXcgUihqLmZpbmRGaWVsZCh3LmFzc29jaWF0aW9ucy5maWVsZHMsTiksXyxVKTticmVhaztjYXNlXCJhdHRhY2hlZFwiOks9YCgke059PScke0l9JyBBTkQgJHtPfSA9IDMpYCxudWxsIT09RiYmKEsrPWAgQU5EICR7VH0gPSBgK0YudG9TdHJpbmcoKSksSi5jb2RlZmllbGQ9TSxLPVwiKCBcIitLK1wiIClcIixIPW5ldyBSKGouZmluZEZpZWxkKHcuYXNzb2NpYXRpb25zLmZpZWxkcyxBKSxfLFUpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCl9RSYmKEs9XCIxIDw+IDFcIik7cmV0dXJuIG5ldyBqKHtwYXJlbnRmZWF0dXJlc2V0OncuYXNzb2NpYXRpb25zLGFkYXB0ZWRGaWVsZHM6W25ldyBDKGouZmluZEZpZWxkKHcuYXNzb2NpYXRpb25zLmZpZWxkcyx6KSksbmV3IEMoai5maW5kRmllbGQody5hc3NvY2lhdGlvbnMuZmllbGRzLGspKSxILFcsSixaXSxleHRyYUZpbHRlcjpLP0IuY3JlYXRlKEssdy5hc3NvY2lhdGlvbnMuZ2V0RmllbGRzSW5kZXgoKSk6bnVsbH0pfSkpfSxfLnNpZ25hdHVyZXMucHVzaCh7bmFtZTpcImZlYXR1cmVzZXRieWFzc29jaWF0aW9uXCIsbWluOjIsbWF4OjZ9KSxfLmZ1bmN0aW9ucy5ncm91cGJ5PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8uc3RhbmRhcmRGdW5jdGlvbkFzeW5jKGUsdCwoYXN5bmMocixzLGwpPT57aWYocChsLDMsMyxlLHQpLCF5KGxbMF0pKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO2NvbnN0IG89YXdhaXQgbFswXS5sb2FkKCksZj1bXSx1PVtdO2xldCBjPSExLGQ9W107aWYoaChsWzFdKSlkLnB1c2gobFsxXSk7ZWxzZSBpZihsWzFdaW5zdGFuY2VvZiBuKWQucHVzaChsWzFdKTtlbHNlIGlmKGIobFsxXSkpZD1sWzFdO2Vsc2V7aWYoIUEobFsxXSkpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7ZD1sWzFdLnRvQXJyYXkoKX1mb3IoY29uc3QgbSBvZiBkKWlmKGgobSkpe2NvbnN0IGU9Qi5jcmVhdGUoZyhtKSxvLmdldEZpZWxkc0luZGV4KCkpLHQ9ITA9PT1XKGUpP2cobSk6XCIlJSUlRklFTEROQU1FXCI7Zi5wdXNoKHtuYW1lOnQsZXhwcmVzc2lvbjplfSksXCIlJSUlRklFTEROQU1FXCI9PT10JiYoYz0hMCl9ZWxzZXtpZighKG0gaW5zdGFuY2VvZiBuKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KTt7Y29uc3Qgbj1tLmhhc0ZpZWxkKFwibmFtZVwiKT9tLmZpZWxkKFwibmFtZVwiKTpcIiUlJSVGSUVMRE5BTUVcIixyPW0uaGFzRmllbGQoXCJleHByZXNzaW9uXCIpP20uZmllbGQoXCJleHByZXNzaW9uXCIpOlwiXCI7aWYoXCIlJSUlRklFTEROQU1FXCI9PT1uJiYoYz0hMCksIW4pdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7Zi5wdXNoKHtuYW1lOm4sZXhwcmVzc2lvbjpCLmNyZWF0ZShyfHxuLG8uZ2V0RmllbGRzSW5kZXgoKSl9KX19aWYoZD1bXSxoKGxbMl0pKWQucHVzaChsWzJdKTtlbHNlIGlmKGIobFsyXSkpZD1sWzJdO2Vsc2UgaWYoQShsWzJdKSlkPWxbMl0udG9BcnJheSgpO2Vsc2V7aWYoIShsWzJdaW5zdGFuY2VvZiBuKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KTtkLnB1c2gobFsyXSl9Zm9yKGNvbnN0IG0gb2YgZCl7aWYoIShtIGluc3RhbmNlb2YgbikpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7e2NvbnN0IG49bS5oYXNGaWVsZChcIm5hbWVcIik/bS5maWVsZChcIm5hbWVcIik6XCJcIixyPW0uaGFzRmllbGQoXCJzdGF0aXN0aWNcIik/bS5maWVsZChcInN0YXRpc3RpY1wiKTpcIlwiLHM9bS5oYXNGaWVsZChcImV4cHJlc3Npb25cIik/bS5maWVsZChcImV4cHJlc3Npb25cIik6XCJcIjtpZighbnx8IXJ8fCFzKXRocm93IG5ldyBpKGUsYS5JbnZhbGlkUGFyYW1ldGVyLHQpO3UucHVzaCh7bmFtZTpuLHN0YXRpc3RpYzpyLnRvTG93ZXJDYXNlKCksZXhwcmVzc2lvbjpCLmNyZWF0ZShzLG8uZ2V0RmllbGRzSW5kZXgoKSl9KX19aWYoYyl7Y29uc3QgZT17fTtmb3IoY29uc3QgbiBvZiBvLmZpZWxkcyllW24ubmFtZS50b0xvd2VyQ2FzZSgpXT0xO2Zvcihjb25zdCBuIG9mIGYpXCIlJSUlRklFTEROQU1FXCIhPT1uLm5hbWUmJihlW24ubmFtZS50b0xvd2VyQ2FzZSgpXT0xKTtmb3IoY29uc3QgbiBvZiB1KVwiJSUlJUZJRUxETkFNRVwiIT09bi5uYW1lJiYoZVtuLm5hbWUudG9Mb3dlckNhc2UoKV09MSk7bGV0IHQ9MDtmb3IoY29uc3QgbiBvZiBmKWlmKFwiJSUlJUZJRUxETkFNRVwiPT09bi5uYW1lKXtmb3IoOzE9PT1lW1wiZmllbGRfXCIrdC50b1N0cmluZygpXTspdCsrO2VbXCJmaWVsZF9cIit0LnRvU3RyaW5nKCldPTEsbi5uYW1lPVwiRklFTERfXCIrdC50b1N0cmluZygpfX1mb3IoY29uc3QgdCBvZiBmKWF3YWl0IEsodC5leHByZXNzaW9uLF8sZSk7Zm9yKGNvbnN0IHQgb2YgdSlhd2FpdCBLKHQuZXhwcmVzc2lvbixfLGUpO3JldHVybiBsWzBdLmdyb3VwYnkoZix1KX0pKX0sXy5zaWduYXR1cmVzLnB1c2goe25hbWU6XCJncm91cGJ5XCIsbWluOjMsbWF4OjN9KSxfLmZ1bmN0aW9ucy5kaXN0aW5jdD1mdW5jdGlvbihlLHQpe3JldHVybiBfLnN0YW5kYXJkRnVuY3Rpb25Bc3luYyhlLHQsKGFzeW5jKHIscyxsKT0+e2lmKHkobFswXSkpe3AobCwyLDIsZSx0KTtjb25zdCByPWF3YWl0IGxbMF0ubG9hZCgpLHM9W107bGV0IG89W107aWYoaChsWzFdKSlvLnB1c2gobFsxXSk7ZWxzZSBpZihsWzFdaW5zdGFuY2VvZiBuKW8ucHVzaChsWzFdKTtlbHNlIGlmKGIobFsxXSkpbz1sWzFdO2Vsc2V7aWYoIUEobFsxXSkpdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7bz1sWzFdLnRvQXJyYXkoKX1sZXQgZj0hMTtmb3IoY29uc3QgbCBvZiBvKWlmKGgobCkpe2NvbnN0IGU9Qi5jcmVhdGUoZyhsKSxyLmdldEZpZWxkc0luZGV4KCkpLHQ9ITA9PT1XKGUpP2cobCk6XCIlJSUlRklFTEROQU1FXCI7cy5wdXNoKHtuYW1lOnQsZXhwcmVzc2lvbjplfSksXCIlJSUlRklFTEROQU1FXCI9PT10JiYoZj0hMCl9ZWxzZXtpZighKGwgaW5zdGFuY2VvZiBuKSl0aHJvdyBuZXcgaShlLGEuSW52YWxpZFBhcmFtZXRlcix0KTt7Y29uc3Qgbj1sLmhhc0ZpZWxkKFwibmFtZVwiKT9sLmZpZWxkKFwibmFtZVwiKTpcIiUlJSVGSUVMRE5BTUVcIixvPWwuaGFzRmllbGQoXCJleHByZXNzaW9uXCIpP2wuZmllbGQoXCJleHByZXNzaW9uXCIpOlwiXCI7aWYoXCIlJSUlRklFTEROQU1FXCI9PT1uJiYoZj0hMCksIW4pdGhyb3cgbmV3IGkoZSxhLkludmFsaWRQYXJhbWV0ZXIsdCk7cy5wdXNoKHtuYW1lOm4sZXhwcmVzc2lvbjpCLmNyZWF0ZShvfHxuLHIuZ2V0RmllbGRzSW5kZXgoKSl9KX19aWYoZil7Y29uc3QgZT17fTtmb3IoY29uc3QgbiBvZiByLmZpZWxkcyllW24ubmFtZS50b0xvd2VyQ2FzZSgpXT0xO2Zvcihjb25zdCBuIG9mIHMpXCIlJSUlRklFTEROQU1FXCIhPT1uLm5hbWUmJihlW24ubmFtZS50b0xvd2VyQ2FzZSgpXT0xKTtsZXQgdD0wO2Zvcihjb25zdCBuIG9mIHMpaWYoXCIlJSUlRklFTEROQU1FXCI9PT1uLm5hbWUpe2Zvcig7MT09PWVbXCJmaWVsZF9cIit0LnRvU3RyaW5nKCldOyl0Kys7ZVtcImZpZWxkX1wiK3QudG9TdHJpbmcoKV09MSxuLm5hbWU9XCJGSUVMRF9cIit0LnRvU3RyaW5nKCl9fWZvcihjb25zdCB0IG9mIHMpYXdhaXQgSyh0LmV4cHJlc3Npb24sXyxlKTtyZXR1cm4gbFswXS5ncm91cGJ5KHMsW10pfXJldHVybiBKKFwiZGlzdGluY3RcIixyLHMsbCl9KSl9KX1leHBvcnR7YWUgYXMgcmVnaXN0ZXJGdW5jdGlvbnN9O1xuIiwiLypcbkFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG5TZWUgaHR0cHM6Ly9qcy5hcmNnaXMuY29tLzQuMjcvZXNyaS9jb3B5cmlnaHQudHh0IGZvciBkZXRhaWxzLlxuKi9cbmltcG9ydHtpZCBhcyByfWZyb21cIi4uL2tlcm5lbC5qc1wiO2ltcG9ydCBlIGZyb21cIi4uL3JlcXVlc3QuanNcIjtpbXBvcnQgbiBmcm9tXCIuLi9wb3J0YWwvUG9ydGFsLmpzXCI7ZnVuY3Rpb24gdChyLGUpe2lmKG51bGw9PT1yKXJldHVybiBlO3JldHVybiBuZXcgbih7dXJsOnIuZmllbGQoXCJ1cmxcIil9KX1hc3luYyBmdW5jdGlvbiBzKG4sdCxzKXtjb25zdCB1PXI/LmZpbmRDcmVkZW50aWFsKG4ucmVzdFVybCk7aWYoIXUpcmV0dXJuIG51bGw7aWYoXCJsb2FkZWRcIj09PW4ubG9hZFN0YXR1cyYmXCJcIj09PXQmJm4udXNlciYmbi51c2VyLnNvdXJjZUpTT04mJiExPT09cylyZXR1cm4gbi51c2VyLnNvdXJjZUpTT047aWYoXCJcIj09PXQpe2NvbnN0IHI9YXdhaXQgZShuLnJlc3RVcmwrXCIvY29tbXVuaXR5L3NlbGZcIix7cmVzcG9uc2VUeXBlOlwianNvblwiLHF1ZXJ5OntmOlwianNvblwiLC4uLiExPT09cz97fTp7cmV0dXJuVXNlckxpY2Vuc2VUeXBlRXh0ZW5zaW9uczohMH19fSk7aWYoci5kYXRhKXtjb25zdCBlPXIuZGF0YTtpZihlJiZlLnVzZXJuYW1lKXJldHVybiBlfXJldHVybiBudWxsfWNvbnN0IG89YXdhaXQgZShuLnJlc3RVcmwrXCIvY29tbXVuaXR5L3VzZXJzL1wiK3Qse3Jlc3BvbnNlVHlwZTpcImpzb25cIixxdWVyeTp7ZjpcImpzb25cIn19KTtpZihvLmRhdGEpe2NvbnN0IHI9by5kYXRhO3JldHVybiByLmVycm9yP251bGw6cn1yZXR1cm4gbnVsbH1leHBvcnR7dCBhcyBnZXRQb3J0YWwscyBhcyBsb29rdXBVc2VyfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==